---
ms.openlocfilehash: 789e7833eb2e6418b23c63db9939bd83f8a8a0d6
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/18/2019
ms.locfileid: "58760190"
---
### <a name="accessibility-improvements-in-windows-forms-controls"></a><span data-ttu-id="f9e37-101">Windows Forms 控制項的協助工具改善</span><span class="sxs-lookup"><span data-stu-id="f9e37-101">Accessibility improvements in Windows Forms controls</span></span>

|   |   |
|---|---|
|<span data-ttu-id="f9e37-102">詳細資料</span><span class="sxs-lookup"><span data-stu-id="f9e37-102">Details</span></span>|<span data-ttu-id="f9e37-103">Windows Forms 正在使用協助工具技術改善其運作方式，以便為 Windows Forms 客戶提供更好的支援。</span><span class="sxs-lookup"><span data-stu-id="f9e37-103">Windows Forms is improving how it works with accessibility technologies to better support Windows Forms customers.</span></span> <span data-ttu-id="f9e37-104">包括自 .NET Framework 4.7.1 開始的下列變更：</span><span class="sxs-lookup"><span data-stu-id="f9e37-104">These include the following changes starting with the .NET Framework 4.7.1:</span></span><ul><li><span data-ttu-id="f9e37-105">改善高對比模式期間之顯示方式的變更。</span><span class="sxs-lookup"><span data-stu-id="f9e37-105">Changes to improve display during High Contrast mode.</span></span></li><li><span data-ttu-id="f9e37-106">改善屬性瀏覽器體驗的變更。</span><span class="sxs-lookup"><span data-stu-id="f9e37-106">Changes to improve the property browser experience.</span></span> <span data-ttu-id="f9e37-107">屬性瀏覽器改善包括：</span><span class="sxs-lookup"><span data-stu-id="f9e37-107">Property browser improvements include:</span></span></li><li><span data-ttu-id="f9e37-108">透過各種下拉式選取視窗進行更佳的鍵盤導覽。</span><span class="sxs-lookup"><span data-stu-id="f9e37-108">Better keyboard navigation through the various drop-down selection windows.</span></span></li><li><span data-ttu-id="f9e37-109">減少不必要的定位停駐點。</span><span class="sxs-lookup"><span data-stu-id="f9e37-109">Reduced unnecessary tab stops.</span></span></li><li><span data-ttu-id="f9e37-110">更適當地報告控制項類型。</span><span class="sxs-lookup"><span data-stu-id="f9e37-110">Better reporting of control types.</span></span></li><li><span data-ttu-id="f9e37-111">改善的朗讀程式行為。</span><span class="sxs-lookup"><span data-stu-id="f9e37-111">Improved narrator behavior.</span></span></li><li><span data-ttu-id="f9e37-112">在控制項中實作遺漏的 UI 協助工具模式的變更。</span><span class="sxs-lookup"><span data-stu-id="f9e37-112">Changes to implement missing UI accessibility patterns in controls.</span></span></li></ul>|
|<span data-ttu-id="f9e37-113">建議</span><span class="sxs-lookup"><span data-stu-id="f9e37-113">Suggestion</span></span>|<span data-ttu-id="f9e37-114"><strong>如何選擇加入或退出這些變更</strong></span><span class="sxs-lookup"><span data-stu-id="f9e37-114"><strong>How to opt in or out of these changes</strong></span></span><br><span data-ttu-id="f9e37-115">為了讓應用程式可受益於這些變更，它必須在 .NET Framework 4.7.1 或更新版本上執行。</span><span class="sxs-lookup"><span data-stu-id="f9e37-115">In order for the application to benefit from these changes, it must run on the .NET Framework 4.7.1 or later.</span></span> <span data-ttu-id="f9e37-116">應用程式可以用下列任一種方式受益於這些變更：</span><span class="sxs-lookup"><span data-stu-id="f9e37-116">The application can benefit from these changes in either of the following ways:</span></span><ul><li><span data-ttu-id="f9e37-117">它已重新編譯為以 .NET Framework 4.7.1 為目標。</span><span class="sxs-lookup"><span data-stu-id="f9e37-117">It is recompiled to target the .NET Framework 4.7.1.</span></span> <span data-ttu-id="f9e37-118">在以 .NET Framework 4.7.1 或更新版本為目標的 Windows Forms 應用程式上，預設會啟用這些協助工具變更。</span><span class="sxs-lookup"><span data-stu-id="f9e37-118">These accessibility changes are enabled by default on Windows Forms applications that target the .NET Framework 4.7.1 or later.</span></span></li><li><span data-ttu-id="f9e37-119">藉由在 app config 檔案的 <code>&lt;runtime&gt;</code> 區段中新增下列 [AppContext 參數](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md)，並將它設定為 <code>false</code>，選擇退出舊版協助工具行為，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="f9e37-119">It opts out of the legacy accessibility behaviors by adding the following [AppContext switch](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) to the <code>&lt;runtime&gt;</code> section of the app.config file and setting it to <code>false</code>, as the following example shows.</span></span></li></ul><pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre><br><span data-ttu-id="f9e37-120">以 .NET Framework 4.7.1 或更新版本為目標，並且想要保留舊版協助工具行為的應用程式，可以藉由明確將此 AppContext 參數設為 <code>true</code>，選擇使用舊版的協助工具功能。</span><span class="sxs-lookup"><span data-stu-id="f9e37-120">Applications that target the .NET Framework 4.7.1 or later and want to preserve the legacy accessibility behavior can opt in to the use of legacy accessibility features by explicitly setting this AppContext switch to <code>true</code>.</span></span></p><span data-ttu-id="f9e37-121">如需 UI 自動化的概觀，請參閱 [UI 自動化概觀](~/docs/framework/ui-automation/ui-automation-overview.md)。&lt;/p/&gt;</span><span class="sxs-lookup"><span data-stu-id="f9e37-121">For an overview of UI automation, see the [UI Automation Overview](~/docs/framework/ui-automation/ui-automation-overview.md).&lt;/p/&gt;</span></span></p><span data-ttu-id="f9e37-122"><strong>為 UI 自動化模式和屬性新增的支援</strong></span><span class="sxs-lookup"><span data-stu-id="f9e37-122"><strong>Added support for UI Automation patterns and properties</strong></span></span><br/><span data-ttu-id="f9e37-123">協助工具用戶端可以使用通用的公開描述叫用模式，利用新的 WinForms 協助工具功能。</span><span class="sxs-lookup"><span data-stu-id="f9e37-123">Accessibility clients can take advantage of new WinForms accessibility functionality by using common, publicly described invocation patterns.</span></span> <span data-ttu-id="f9e37-124">這些不是 WinForms 特有模式。</span><span class="sxs-lookup"><span data-stu-id="f9e37-124">These patterns are not WinForms-specific.</span></span> <span data-ttu-id="f9e37-125">例如，協助工具用戶端可以在 IAccessible 介面 (MAAS) 上呼叫 QueryInterface 方法，以取得 IServiceProvider 介面。</span><span class="sxs-lookup"><span data-stu-id="f9e37-125">For instance, accessibility clients can call the QueryInterface method on the IAccessible interface (MAAS) to obtain an IServiceProvider interface.</span></span> <span data-ttu-id="f9e37-126">如果此介面可供使用，用戶端可以使用其 QueryService 方法來要求 IAccessibleEx 介面。</span><span class="sxs-lookup"><span data-stu-id="f9e37-126">If this interface is available, clients can use its QueryService method to request an IAccessibleEx interface.</span></span> <span data-ttu-id="f9e37-127">如需詳細資訊，請參閱[從用戶端使用 IAccessibleEx](https://docs.microsoft.com/windows/desktop/WinAuto/using-iaccessibleex-from-a-client)。</span><span class="sxs-lookup"><span data-stu-id="f9e37-127">For more information, see [Using IAccessibleEx from a Client](https://docs.microsoft.com/windows/desktop/WinAuto/using-iaccessibleex-from-a-client).</span></span> <span data-ttu-id="f9e37-128">從 .NET Framework 4.7.1 開始，IServiceProvider 和 [IAccessibleEx](https://docs.microsoft.com/windows/desktop/WinAuto/iaccessibleex) (若適用) 可供 WinForms 協助工具物件使用。</span><span class="sxs-lookup"><span data-stu-id="f9e37-128">Starting with the .NET Framework 4.7.1, IServiceProvider and [IAccessibleEx](https://docs.microsoft.com/windows/desktop/WinAuto/iaccessibleex) (where applicable) are available for WinForms accessibility objects.</span></span></p><span data-ttu-id="f9e37-129">.NET Framework 4.7.1 為下列 UI 自動化模式和屬性新增支援：</span><span class="sxs-lookup"><span data-stu-id="f9e37-129">The .NET Framework 4.7.1 adds support for the following UI automation patterns and properties:</span></span><ul><li><span data-ttu-id="f9e37-130"><xref:System.Windows.Forms.ToolStripSplitButton> 和 <xref:System.Windows.Forms.ComboBox> 控制項支援[展開/摺疊模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)。</span><span class="sxs-lookup"><span data-stu-id="f9e37-130">The <xref:System.Windows.Forms.ToolStripSplitButton> and <xref:System.Windows.Forms.ComboBox> controls support the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="f9e37-131"><xref:System.Windows.Forms.ToolStripMenuItem> 控制項有 [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) 屬性值 <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="f9e37-131">The <xref:System.Windows.Forms.ToolStripMenuItem> control has a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="f9e37-132"><xref:System.Windows.Forms.ToolStripItem> 控制項支援 <xref:System.Windows.Automation.AutomationElement.NameProperty> 屬性和[展開/摺疊模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)。</span><span class="sxs-lookup"><span data-stu-id="f9e37-132">The <xref:System.Windows.Forms.ToolStripItem> control supports the <xref:System.Windows.Automation.AutomationElement.NameProperty> property and the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="f9e37-133"><xref:System.Windows.Forms.ToolStripDropDownItem> 控制項支援 <xref:System.Windows.Forms.AccessibleEvents>表示展開或摺疊下拉式清單時的 StateChange 和 NameChange。</span><span class="sxs-lookup"><span data-stu-id="f9e37-133">The <xref:System.Windows.Forms.ToolStripDropDownItem> control supports <xref:System.Windows.Forms.AccessibleEvents> indicating StateChange and NameChange when drop down is expanded or collapsed.</span></span></li><li><span data-ttu-id="f9e37-134"><xref:System.Windows.Forms.ToolStripDropDownButton> 控制項具有 [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) 屬性值 <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="f9e37-134">The <xref:System.Windows.Forms.ToolStripDropDownButton> control has a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value of <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="f9e37-135"><xref:System.Windows.Forms.DataGridViewCheckBoxCell> 控制項支援 <xref:System.Windows.Automation.TogglePattern>。</span><span class="sxs-lookup"><span data-stu-id="f9e37-135">The <xref:System.Windows.Forms.DataGridViewCheckBoxCell> control supports the <xref:System.Windows.Automation.TogglePattern>.</span></span></li><li><span data-ttu-id="f9e37-136"><xref:System.Windows.Forms.NumericUpDown> 和 <xref:System.Windows.Forms.DomainUpDown> 控制項支援 <xref:System.Windows.Automation.AutomationElement.NameProperty> 屬性，而且具有 <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType> 的 [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md)。</span><span class="sxs-lookup"><span data-stu-id="f9e37-136">The <xref:System.Windows.Forms.NumericUpDown> and <xref:System.Windows.Forms.DomainUpDown> controls support the <xref:System.Windows.Automation.AutomationElement.NameProperty> property and have a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) of <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>.</span></span></p></li></ul><span data-ttu-id="f9e37-137"><strong>PropertyGrid 控制項的改善</strong></span><span class="sxs-lookup"><span data-stu-id="f9e37-137"><strong>Improvements to the PropertyGrid control</strong></span></span><br><span data-ttu-id="f9e37-138">.NET Framework 4.7.1 在 PropertyBrowser 控制項中新增下列改善：</span><span class="sxs-lookup"><span data-stu-id="f9e37-138">The .NET Framework 4.7.1 adds the following improvements to the PropertyBrowser control:</span></span><ul><li><span data-ttu-id="f9e37-139">使用者在 <xref:System.Windows.Forms.PropertyGrid> 控制項中輸入不正確的值時所顯示之 [錯誤] 對話方塊中的 [詳細資料] 按鈕，支援[展開/摺疊模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)、狀態與名稱變更通知，以及值為 <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType> 的 [ControlType]~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="f9e37-139">The <strong>Details</strong> button in the error dialog that is displayed when the user enters an incorrect value in the <xref:System.Windows.Forms.PropertyGrid> control supports the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), state and name change notifications, and a [ControlType]~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property with a value of <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="f9e37-140">展開 [錯誤] 對話方塊的 [詳細資料] 按鈕時所顯示的 [訊息] 窗格，現在可透過鍵盤存取，並可讓朗讀程式宣告錯誤訊息的內容。</span><span class="sxs-lookup"><span data-stu-id="f9e37-140">The message pane displayed when the <strong>Details</strong> button of the error dialog is expanded is now keyboard accessible and allows Narrator to announce the content of the error message.</span></span></li><li><span data-ttu-id="f9e37-141"><xref:System.Windows.Forms.PropertyGrid> 控制項中資料列的 <xref:System.Windows.Forms.AccessibleRole> 已從 &quot;Row&quot; 變更為 &quot;Cell&quot;。</span><span class="sxs-lookup"><span data-stu-id="f9e37-141">The <xref:System.Windows.Forms.AccessibleRole> of rows in the <xref:System.Windows.Forms.PropertyGrid> control have changed from &quot;Row&quot; to &quot;Cell&quot;.</span></span> <span data-ttu-id="f9e37-142">此資料格會對應至 UIA ControlType &quot;DataItem&quot;，讓它支援適當的鍵盤快速鍵和朗讀程式宣告。</span><span class="sxs-lookup"><span data-stu-id="f9e37-142">The cell maps to UIA ControlType &quot;DataItem&quot;, which allows it to support appropriate keyboard shortcuts and Narrator announcements.</span></span></li><li><span data-ttu-id="f9e37-143"><xref:System.Windows.Forms.PropertyGrid> 控制項將 <xref:System.Windows.Forms.PropertyGrid.PropertySort> 屬性設定為 <xref:System.Windows.Forms.PropertySort.Categorized?displayProperty=nameWithType> 時代表標頭項目的 <xref:System.Windows.Forms.PropertyGrid> 控制項資料列，具有 [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) 屬性值 <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="f9e37-143">The <xref:System.Windows.Forms.PropertyGrid> control rows that represent header items when the <xref:System.Windows.Forms.PropertyGrid> control has a <xref:System.Windows.Forms.PropertyGrid.PropertySort> property set to <xref:System.Windows.Forms.PropertySort.Categorized?displayProperty=nameWithType> have a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value of <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="f9e37-144"><xref:System.Windows.Forms.PropertyGrid> 控制項將 <xref:System.Windows.Forms.PropertyGrid.PropertySort> 屬性設定為 <xref:System.Windows.Forms.PropertySort.Categorized?displayProperty=nameWithType> 時代表標頭項目的 <xref:System.Windows.Forms.PropertyGrid> 控制項資料列，支援[展開/摺疊模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)。</span><span class="sxs-lookup"><span data-stu-id="f9e37-144">The <xref:System.Windows.Forms.PropertyGrid> control rows that represent header items when the <xref:System.Windows.Forms.PropertyGrid> control has a <xref:System.Windows.Forms.PropertyGrid.PropertySort>  property set to <xref:System.Windows.Forms.PropertySort.Categorized?displayProperty=nameWithType> support the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="f9e37-145">改善了方格與其上工具列之間的鍵盤導覽。</span><span class="sxs-lookup"><span data-stu-id="f9e37-145">Improved keyboard navigation between the grid and the ToolBar above it.</span></span> <span data-ttu-id="f9e37-146">按下 &quot;Shift-Tab&quot; 現在會選取第一個工具列按鈕，而不是整個工具列。</span><span class="sxs-lookup"><span data-stu-id="f9e37-146">Pressing &quot;Shift-Tab&quot; now selects the first ToolBar button, instead of the whole ToolBar.</span></span></li><li><span data-ttu-id="f9e37-147">在高對比模式中顯示的 <xref:System.Windows.Forms.PropertyGrid> 控制項，現在會圍繞對應於目前 <xref:System.Windows.Forms.PropertyGrid.PropertySort> 屬性值的工具列按鈕繪製焦點矩形。</span><span class="sxs-lookup"><span data-stu-id="f9e37-147"><xref:System.Windows.Forms.PropertyGrid> controls displayed in High Contrast mode will now draw a focus rectangle around the ToolBar button which corresponds to the current <xref:System.Windows.Forms.PropertyGrid.PropertySort> property value.</span></span></li><li><span data-ttu-id="f9e37-148">在高對比模式中顯示且 <xref:System.Windows.Forms.PropertyGrid.PropertySort> 屬性設定為 <xref:System.Windows.Forms.PropertySort.Categorized?displayProperty=nameWithType> 的 <xref:System.Windows.Forms.PropertyGrid> 控制項，現在將以高對比的色彩顯示分類標頭的背景。</span><span class="sxs-lookup"><span data-stu-id="f9e37-148"><xref:System.Windows.Forms.PropertyGrid> controls displayed in High Contrast mode and with a <xref:System.Windows.Forms.PropertyGrid.PropertySort> property set to <xref:System.Windows.Forms.PropertySort.Categorized?displayProperty=nameWithType> will now display the background of category headers in a highly contrasting color.</span></span></li><li><span data-ttu-id="f9e37-149"><xref:System.Windows.Forms.PropertyGrid> 控制項可以更好地區別具有焦點的工具列項目與表示 <xref:System.Windows.Forms.PropertyGrid.PropertySort> 屬性目前值的工具列項目。</span><span class="sxs-lookup"><span data-stu-id="f9e37-149"><xref:System.Windows.Forms.PropertyGrid> controls better differentiates between ToolBar items with focus and the ToolBar items which indicate the current value of the <xref:System.Windows.Forms.PropertyGrid.PropertySort> property.</span></span> <span data-ttu-id="f9e37-150">此修正包含高對比變更及非高對比案例的變更。</span><span class="sxs-lookup"><span data-stu-id="f9e37-150">This fix consists of a High Contrast change and a change for non-High Contrast scenarios.</span></span></li><li><span data-ttu-id="f9e37-151">表示 <xref:System.Windows.Forms.PropertyGrid.PropertySort> 屬性目前值的 <xref:System.Windows.Forms.PropertyGrid> 控制項工具列項目支援 <xref:System.Windows.Automation.TogglePattern>。</span><span class="sxs-lookup"><span data-stu-id="f9e37-151"><xref:System.Windows.Forms.PropertyGrid> control ToolBar items which indicates the current value of the <xref:System.Windows.Forms.PropertyGrid.PropertySort> property support the <xref:System.Windows.Automation.TogglePattern>.</span></span></li><li><span data-ttu-id="f9e37-152">改善了朗讀程式對區分對齊選擇器中所選取對齊方式的支援。</span><span class="sxs-lookup"><span data-stu-id="f9e37-152">Improved Narrator support for distinguishing the selected alignment in the Alignment Picker.</span></span></li><li><span data-ttu-id="f9e37-153">在表單上顯示空的 <xref:System.Windows.Forms.PropertyGrid> 控制項時，它現在會接收焦點，而之前並不會。</span><span class="sxs-lookup"><span data-stu-id="f9e37-153">When an empty <xref:System.Windows.Forms.PropertyGrid> control is displayed on a form, it will now receive focus where previously it would not.</span></span></p></li></ul><span data-ttu-id="f9e37-154"><strong>使用高對比佈景主題中作業系統定義的色彩</strong></span><span class="sxs-lookup"><span data-stu-id="f9e37-154"><strong>Use of OS-defined colors in High Contrast themes</strong></span></span><br><ul><li><span data-ttu-id="f9e37-155"><xref:System.Windows.Forms.ButtonBase.FlatStyle> 屬性設定為 <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType> (這是預設樣式) 的 <xref:System.Windows.Forms.Button> 和 <xref:System.Windows.Forms.CheckBox> 控制項，現在使用選取的高對比佈景主題中作業系統定義的色彩。</span><span class="sxs-lookup"><span data-stu-id="f9e37-155">The <xref:System.Windows.Forms.Button> and <xref:System.Windows.Forms.CheckBox> controls with their <xref:System.Windows.Forms.ButtonBase.FlatStyle> property set to <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>, which is the default style, now use OS-defined colors in High Contrast theme when selected.</span></span> <span data-ttu-id="f9e37-156">以往，文字和背景色彩不會呈現對比，因此難以閱讀。</span><span class="sxs-lookup"><span data-stu-id="f9e37-156">Previously, text and background colors were not contrasting and were hard to read.</span></span></li><li><span data-ttu-id="f9e37-157"><xref:System.Windows.Forms.Control.Enabled> 屬性設定為 <strong>false</strong> 的 <xref:System.Windows.Forms.Button>、<xref:System.Windows.Forms.CheckBox>、<xref:System.Windows.Forms.RadioButton>、<xref:System.Windows.Forms.Label>、<xref:System.Windows.Forms.LinkLabel> 和 <xref:System.Windows.Forms.GroupBox> 控制項，使用陰影色彩來呈現高對比佈景主題中的文字，導致與背景的對比過低。</span><span class="sxs-lookup"><span data-stu-id="f9e37-157">The <xref:System.Windows.Forms.Button>, <xref:System.Windows.Forms.CheckBox>, <xref:System.Windows.Forms.RadioButton>, <xref:System.Windows.Forms.Label>, <xref:System.Windows.Forms.LinkLabel> and <xref:System.Windows.Forms.GroupBox> controls with their <xref:System.Windows.Forms.Control.Enabled> property set to <strong>false</strong> used a shaded color to render text in High Contrast themes, resulting in low contrast against the background.</span></span> <span data-ttu-id="f9e37-158">現在，這些控制項使用作業系統所定義的「已停用文字」色彩。</span><span class="sxs-lookup"><span data-stu-id="f9e37-158">Now these controls use the &quot;Disabled Text&quot; color defined by the OS.</span></span> <span data-ttu-id="f9e37-159">此修正套用至 <code>FlatStyle</code> 屬性設定為非 <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType> 值的控制項。</span><span class="sxs-lookup"><span data-stu-id="f9e37-159">This fix applies to controls with their <code>FlatStyle</code> property set to a value other than <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>.</span></span> <span data-ttu-id="f9e37-160">後者的控制項是由作業系統呈現。</span><span class="sxs-lookup"><span data-stu-id="f9e37-160">The latter controls are rendered by the OS.</span></span></li><li><span data-ttu-id="f9e37-161"><xref:System.Windows.Forms.DataGridView> 現在會於目前焦點所在的儲存格內容周圍呈現可見的矩形。</span><span class="sxs-lookup"><span data-stu-id="f9e37-161"><xref:System.Windows.Forms.DataGridView> now renders a visible rectangle around the content of the cell which has the current focus.</span></span> <span data-ttu-id="f9e37-162">之前，這不會顯示在特定的高對比佈景主題中。</span><span class="sxs-lookup"><span data-stu-id="f9e37-162">Previously, this was not visible in certain High Contrast themes.</span></span></li><li><span data-ttu-id="f9e37-163"><xref:System.Windows.Forms.ToolStripMenuItem.Enabled> 屬性設定為 <strong>false</strong> 的 <xref:System.Windows.Forms.ToolStripMenuItem> 控制項，現在使用作業系統所定義的「已停用文字」色彩。</span><span class="sxs-lookup"><span data-stu-id="f9e37-163"><xref:System.Windows.Forms.ToolStripMenuItem> controls with their <xref:System.Windows.Forms.ToolStripMenuItem.Enabled> property set to <strong>false</strong> now use the &quot;Disabled Text&quot; color defined by the OS.</span></span></li><li><span data-ttu-id="f9e37-164"><xref:System.Windows.Forms.ToolStripMenuItem.Checked> 屬性設定為 <strong>true</strong> 的 <xref:System.Windows.Forms.ToolStripMenuItem> 控制項，現在以對比的系統色彩呈現相關聯的核取記號。</span><span class="sxs-lookup"><span data-stu-id="f9e37-164"><xref:System.Windows.Forms.ToolStripMenuItem> controls with their <xref:System.Windows.Forms.ToolStripMenuItem.Checked> property set to <strong>true</strong> now render the associated check mark in a contrasting system color.</span></span>  <span data-ttu-id="f9e37-165">先前的核取記號色彩對比不足，無法在高對比佈景主題中顯示。</span><span class="sxs-lookup"><span data-stu-id="f9e37-165">Previously the check mark color was not contrasting enough and not visible in High Contrast themes.</span></span></li></ul><span data-ttu-id="f9e37-166">注意：Windows 10 已變更某些高對比系統色彩的值。</span><span class="sxs-lookup"><span data-stu-id="f9e37-166">NOTE: Windows 10 has changed values for some high contrast system colors.</span></span> <span data-ttu-id="f9e37-167">Windows Forms 架構是以 Win32 架構為基礎。</span><span class="sxs-lookup"><span data-stu-id="f9e37-167">Windows Forms Framework is based on the Win32 framework.</span></span> <span data-ttu-id="f9e37-168">為獲得最佳體驗、在最新版的 Windows 上執行，以及新增最新作業系統變更，請在測試應用程式中新增 app.manifest 檔案，並取消註解下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="f9e37-168">For the best experience, run on the latest version of Windows and opt in to the latest OS changes by adding an app.manifest file in a test application and uncommenting the following code:</span></span><pre><code class="lang-xml">&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><br><span data-ttu-id="f9e37-169"><strong>改善的鍵盤導覽</strong></span><span class="sxs-lookup"><span data-stu-id="f9e37-169"><strong>Improved keyboard navigation</strong></span></span><ul><li><span data-ttu-id="f9e37-170">當 <xref:System.Windows.Forms.ComboBox> 控制項將其 <xref:System.Windows.Forms.ComboBox.DropDownStyle> 屬性設定為 <xref:System.Windows.Forms.ComboBoxStyle.DropDownList?displayProperty=nameWithType>，且它是表單中定位順序的第一個控制項時，如果使用鍵盤來開啟父表單，它現在會顯示焦點矩形。</span><span class="sxs-lookup"><span data-stu-id="f9e37-170">When a <xref:System.Windows.Forms.ComboBox> control has its <xref:System.Windows.Forms.ComboBox.DropDownStyle> property set to <xref:System.Windows.Forms.ComboBoxStyle.DropDownList?displayProperty=nameWithType> and is the first control in the tab order on the form, it now displays a focus rectangle when the parent form is opened using the keyboard.</span></span> <span data-ttu-id="f9e37-171">在這項變更之前，鍵盤焦點是在這個控制項上，但不會呈現焦點指標。</span><span class="sxs-lookup"><span data-stu-id="f9e37-171">Before this change, keyboard focus was on this control, but a focus indicator was not rendered.</span></span></li></ul><span data-ttu-id="f9e37-172"><strong>改善的朗讀程式支援</strong></span><span class="sxs-lookup"><span data-stu-id="f9e37-172"><strong>Improved Narrator support</strong></span></span><ul><li><span data-ttu-id="f9e37-173"><xref:System.Windows.Forms.MonthCalendar> 控制項已針對輔助技術新增存取控制項的支援，包括讓朗讀程式可以讀取先前無法讀取的控制項值。</span><span class="sxs-lookup"><span data-stu-id="f9e37-173">The <xref:System.Windows.Forms.MonthCalendar> control has added support for assistive technologies to access the control, including the ability for Narrator to read the value of the control when previously it could not.</span></span></li><li><span data-ttu-id="f9e37-174"><xref:System.Windows.Forms.CheckedListBox> 控制項現在會於 <xref:System.Windows.Forms.CheckBox.CheckState?displayProperty=nameWithType> 屬性已變更時通知朗讀程式。</span><span class="sxs-lookup"><span data-stu-id="f9e37-174">The <xref:System.Windows.Forms.CheckedListBox> control now notifies Narrator when a <xref:System.Windows.Forms.CheckBox.CheckState?displayProperty=nameWithType> property has been changed.</span></span> <span data-ttu-id="f9e37-175">之前，朗讀程式不會收到通知，因此使用者不會被告知 <xref:System.Windows.Forms.CheckBox.CheckState> 屬性已更新。</span><span class="sxs-lookup"><span data-stu-id="f9e37-175">Previously, Narrator did not receive notification and as a result users would not be informed that the <xref:System.Windows.Forms.CheckBox.CheckState> property had been updated.</span></span></li><li><span data-ttu-id="f9e37-176"><xref:System.Windows.Forms.LinkLabel> 控制項已變更其告知朗讀程式有關控制項文字的方式。</span><span class="sxs-lookup"><span data-stu-id="f9e37-176">The <xref:System.Windows.Forms.LinkLabel> control has changed the way it notifies Narrator of the text of in the control.</span></span> <span data-ttu-id="f9e37-177">之前，朗讀程式會宣告這段文字兩次，並將 &quot;&amp;&quot; 符號讀取為實際文字，即使使用者看不到這些文字也一樣。</span><span class="sxs-lookup"><span data-stu-id="f9e37-177">Previously, Narrator announced this text twice and read &quot;&amp;&quot; symbols as real text even though they are not visible to a user.</span></span> <span data-ttu-id="f9e37-178">已從朗讀程式宣告中移除重複的文字，以及不必要的 &quot;&amp;&quot; 符號。</span><span class="sxs-lookup"><span data-stu-id="f9e37-178">The duplicated text was removed from the Narrator announcements, as well as unnecessary &quot;&amp;&quot; symbols.</span></span></li><li><span data-ttu-id="f9e37-179"><xref:System.Windows.Forms.DataGridViewCell> 控制項類型現在會正確地向朗讀程式和其他輔助技術報告唯讀狀態。</span><span class="sxs-lookup"><span data-stu-id="f9e37-179">The <xref:System.Windows.Forms.DataGridViewCell> control types now correctly report the read-only status to Narrator and other assistive technologies.</span></span></li><li><span data-ttu-id="f9e37-180">朗讀程式現在可以讀取 [Multiple-Document Interface]~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) 應用程式中的子視窗系統功能表。</span><span class="sxs-lookup"><span data-stu-id="f9e37-180">Narrator is now able to read the System Menu of child windows in [Multiple-Document Interface]~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) applications.</span></span></li><li><span data-ttu-id="f9e37-181">朗讀程式現在可以讀取 <xref:System.Windows.Forms.ToolStripItem.Enabled?displayProperty=nameWithType> 屬性設定為 <strong>false</strong> 的 <xref:System.Windows.Forms.ToolStripMenuItem> 控制項。</span><span class="sxs-lookup"><span data-stu-id="f9e37-181">Narrator is now able to read <xref:System.Windows.Forms.ToolStripMenuItem> controls with a <xref:System.Windows.Forms.ToolStripItem.Enabled?displayProperty=nameWithType> property set to <strong>false</strong>.</span></span> <span data-ttu-id="f9e37-182">之前，朗讀程式無法將焦點放在已停用的功能表項目來讀取內容。</span><span class="sxs-lookup"><span data-stu-id="f9e37-182">Previously, Narrator was unable to focus on disabled menu items to read the content.</span></span></li></ul>|
|<span data-ttu-id="f9e37-183">範圍</span><span class="sxs-lookup"><span data-stu-id="f9e37-183">Scope</span></span>|<span data-ttu-id="f9e37-184">主要</span><span class="sxs-lookup"><span data-stu-id="f9e37-184">Major</span></span>|
|<span data-ttu-id="f9e37-185">版本</span><span class="sxs-lookup"><span data-stu-id="f9e37-185">Version</span></span>|<span data-ttu-id="f9e37-186">4.7.1</span><span class="sxs-lookup"><span data-stu-id="f9e37-186">4.7.1</span></span>|
|<span data-ttu-id="f9e37-187">類型</span><span class="sxs-lookup"><span data-stu-id="f9e37-187">Type</span></span>|<span data-ttu-id="f9e37-188">正在重定目標</span><span class="sxs-lookup"><span data-stu-id="f9e37-188">Retargeting</span></span>|
|<span data-ttu-id="f9e37-189">受影響的 API</span><span class="sxs-lookup"><span data-stu-id="f9e37-189">Affected APIs</span></span>|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[<span data-ttu-id="f9e37-190">MonthCalendar.AccessibilityObject</span><span class="sxs-lookup"><span data-stu-id="f9e37-190">MonthCalendar.AccessibilityObject</span></span>](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|
