---
title: 在 Visual Studio 中使用 Roslyn 語法視覺化檢視瀏覽程式碼
description: 語法視覺化檢視提供了視覺化工具來瀏覽 .NET 編譯器平台 SDK 為程式碼產生的模型。
author: billwagner
ms.author: wiwagn
ms.date: 03/07/2018
ms.topic: conceptual
ms.prod: .net
ms.devlang: devlang-csharp
ms.custom: mvc
ms.openlocfilehash: ec9d9fcdcaf2c018762542f6dc403e2a4f89376b
ms.sourcegitcommit: 935d5267c44f9bce801468ef95f44572f1417e8c
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/28/2018
---
# <a name="explore-code-with-the-roslyn-syntax-visualizer-in-visual-studio"></a><span data-ttu-id="00c73-103">在 Visual Studio 中使用 Roslyn 語法視覺化檢視瀏覽程式碼</span><span class="sxs-lookup"><span data-stu-id="00c73-103">Explore code with the Roslyn syntax visualizer in Visual Studio</span></span>

<span data-ttu-id="00c73-104">本文章提供隨附於 .NET 編譯器平台 ("Roslyn") SDK 的語法視覺化檢視工具概觀。</span><span class="sxs-lookup"><span data-stu-id="00c73-104">This article provides an overview of the Syntax Visualizer tool that ships as part of the .NET Compiler Platform ("Roslyn") SDK.</span></span> <span data-ttu-id="00c73-105">語法視覺化檢視是一個工具視窗，可協助您檢查和瀏覽語法樹狀目錄。</span><span class="sxs-lookup"><span data-stu-id="00c73-105">The Syntax Visualizer is a tool window that helps you inspect and explore syntax trees.</span></span> <span data-ttu-id="00c73-106">它是了解想要分析的程式碼模型時不可或缺的工具。</span><span class="sxs-lookup"><span data-stu-id="00c73-106">It's an essential tool to understand the models for code you want to analyze.</span></span> <span data-ttu-id="00c73-107">當您使用 .NET 編譯器平台 ("Roslyn") SDK 自行開發應用程式時，它也是一項偵錯輔助工具。</span><span class="sxs-lookup"><span data-stu-id="00c73-107">It's also a debugging aid when you develop your own applications using the .NET Compiler Platform (“Roslyn”) SDK.</span></span> <span data-ttu-id="00c73-108">當您建立第一個分析器時，請開啟此工具。</span><span class="sxs-lookup"><span data-stu-id="00c73-108">Open this tool as you create your first analyzers.</span></span> <span data-ttu-id="00c73-109">視覺化檢視可協助您了解 API 所使用的模型。</span><span class="sxs-lookup"><span data-stu-id="00c73-109">The visualizer helps you understand the models used by the APIs.</span></span> <span data-ttu-id="00c73-110">您也可以使用像是 [SharpLab](https://sharplab.io) 或 [LINQPad](https://www.linqpad.net/) 等工具來檢查程式碼，並了解語法樹狀目錄。</span><span class="sxs-lookup"><span data-stu-id="00c73-110">You can also use tools like [SharpLab](https://sharplab.io) or [LINQPad](https://www.linqpad.net/) to inspect code and understand syntax trees.</span></span>

[!INCLUDE[interactive-note](~/includes/roslyn-installation.md)]

<span data-ttu-id="00c73-111">藉由閱讀[概觀](compiler-api-model.md)文章，熟悉 .NET 編譯器平台 SDK 中使用的概念。</span><span class="sxs-lookup"><span data-stu-id="00c73-111">Familiarize yourself with the concepts used in the .NET Compiler Platform SDK by reading the [overview](compiler-api-model.md) article.</span></span> <span data-ttu-id="00c73-112">它提供語法樹狀目錄、節點、語彙基元和邏輯的簡介。</span><span class="sxs-lookup"><span data-stu-id="00c73-112">It provides an introduction to syntax trees, nodes, tokens, and trivia.</span></span>

## <a name="syntax-visualizer"></a><span data-ttu-id="00c73-113">語法視覺化檢視</span><span class="sxs-lookup"><span data-stu-id="00c73-113">Syntax Visualizer</span></span>

<span data-ttu-id="00c73-114">**語法視覺化檢視**可讓您在 Visual Studio IDE 內的目前使用中編輯器視窗裡，檢查 C# 或 VB 程式碼檔案的語法樹狀目錄。</span><span class="sxs-lookup"><span data-stu-id="00c73-114">The **Syntax Visualizer** enables inspection of the syntax tree for the C# or VB code file in the current active editor window inside the Visual Studio IDE.</span></span> <span data-ttu-id="00c73-115">按一下 檢視 > 其他視窗 > 語法視覺化檢視，可以啟動視覺化檢視。</span><span class="sxs-lookup"><span data-stu-id="00c73-115">The visualizer can be launched by clicking on **View** > **Other Windows** > **Syntax Visualizer**.</span></span>  <span data-ttu-id="00c73-116">您也可以使用右上角的 [快速啟動] 工具列。</span><span class="sxs-lookup"><span data-stu-id="00c73-116">You can also use the **Quick Launch** toolbar in the upper right corner.</span></span> <span data-ttu-id="00c73-117">輸入 "syntax"，開啟語法視覺化檢視的命令應該會出現。</span><span class="sxs-lookup"><span data-stu-id="00c73-117">Type "syntax", and the command to open the **Syntax Visualizer** should appear.</span></span>

<span data-ttu-id="00c73-118">此命令會將語法視覺化檢視開啟為浮動的工具視窗。</span><span class="sxs-lookup"><span data-stu-id="00c73-118">This command opens the Syntax Visualizer as a floating tool window.</span></span> <span data-ttu-id="00c73-119">如果您還沒有開啟的程式碼編輯器視窗，顯示將為空白，如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="00c73-119">If you don't have a code editor window open, the display is blank, as shown in the following figure.</span></span> 

![語法視覺化檢視工具視窗](media/syntax-visualizer.png)

<span data-ttu-id="00c73-121">將此工具視窗停駐在 Visual Studio 內方便的位置，例如左側。</span><span class="sxs-lookup"><span data-stu-id="00c73-121">Dock this tool window at a convenient location inside Visual Studio, such as the left side.</span></span> <span data-ttu-id="00c73-122">視覺化檢視會顯示目前程式碼檔案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="00c73-122">The Visualizer shows information about the current code file.</span></span>

<span data-ttu-id="00c73-123">使用 [檔案] > [新增專案] 命令建立新專案。</span><span class="sxs-lookup"><span data-stu-id="00c73-123">Create a new project using the **File** > **New Project** command.</span></span> <span data-ttu-id="00c73-124">您可以建立 VB 或 C# 專案。</span><span class="sxs-lookup"><span data-stu-id="00c73-124">You can create either a VB or C# project.</span></span> <span data-ttu-id="00c73-125">當 Visual Studio 開啟這個專案的主要程式碼檔案時，視覺化檢視會顯示其語法樹狀目錄。</span><span class="sxs-lookup"><span data-stu-id="00c73-125">When Visual Studio opens the main code file for this project, the visualizer displays the syntax tree for it.</span></span> <span data-ttu-id="00c73-126">您可以在這個 Visual Studio 執行個體中開啟任何現有的 C# / VB 檔案，而視覺化檢視會顯示該檔案的語法樹狀目錄。</span><span class="sxs-lookup"><span data-stu-id="00c73-126">You can open any existing C# / VB file in this Visual Studio instance, and the visualizer displays that file's syntax tree.</span></span> <span data-ttu-id="00c73-127">如果您在 Visual Studio 內開啟了多個程式碼檔案，視覺化檢視會顯示目前使用中程式碼檔案 (具有鍵盤焦點的程式碼檔案) 的語法樹狀目錄。</span><span class="sxs-lookup"><span data-stu-id="00c73-127">If you have multiple code files open inside Visual Studio, the visualizer displays the syntax tree for the currently active code file, (the code file that has keyboard focus.)</span></span>

# <a name="ctabcsharp"></a>[<span data-ttu-id="00c73-128">C#</span><span class="sxs-lookup"><span data-stu-id="00c73-128">C#</span></span>](#tab/csharp)
![視覺化 C# 語法樹狀目錄](media/visualize-csharp.png)
# <a name="visual-basictabvisual-basic"></a>[<span data-ttu-id="00c73-130">Visual Basic</span><span class="sxs-lookup"><span data-stu-id="00c73-130">Visual Basic</span></span>](#tab/visual-basic)
<a name="visualizing-a-vb-syntax-treemediavisualize-visual-basicpng"></a>![視覺化 VB 語法樹狀目錄](media/visualize-visual-basic.png)
---

<span data-ttu-id="00c73-132">如上述影像所示，視覺化檢視工具視窗會在頂端顯示語法樹狀目錄，並在底部顯示屬性方格。</span><span class="sxs-lookup"><span data-stu-id="00c73-132">As shown in the preceding images, the visualizer tool window displays the syntax tree at the top and a property grid at the bottom.</span></span> <span data-ttu-id="00c73-133">屬性方格顯示目前樹狀目錄中選取項目的屬性，包括項目的 .NET *Type* 和 *Kind* (SyntaxKind)。</span><span class="sxs-lookup"><span data-stu-id="00c73-133">The property grid displays the properties of the item that is currently selected in the tree, including the .NET *Type* and the *Kind* (SyntaxKind) of the item.</span></span>

<span data-ttu-id="00c73-134">語法樹狀目錄包含三種型別的項目 – 「節點」、「語彙基元」，和「邏輯」。</span><span class="sxs-lookup"><span data-stu-id="00c73-134">Syntax trees comprise three types of items – *nodes*, *tokens*, and *trivia*.</span></span> <span data-ttu-id="00c73-135">您可以在[使用語法](work-with-syntax.md)文章中閱讀更多有關這些型別的內容。</span><span class="sxs-lookup"><span data-stu-id="00c73-135">You can read more about these types in the [Work with syntax](work-with-syntax.md) article.</span></span> <span data-ttu-id="00c73-136">每個型別的項目會使用不同的色彩來表示。</span><span class="sxs-lookup"><span data-stu-id="00c73-136">Items of each type are represented using a different color.</span></span> <span data-ttu-id="00c73-137">按一下 [圖例] 按鈕以取得所使用之色彩的概觀。</span><span class="sxs-lookup"><span data-stu-id="00c73-137">Click on the ‘Legend’ button for an overview of the colors used.</span></span>

<span data-ttu-id="00c73-138">樹狀目錄中的每個項目也會顯示自己的「範圍」。</span><span class="sxs-lookup"><span data-stu-id="00c73-138">Each item in the tree also displays its own **span**.</span></span> <span data-ttu-id="00c73-139">**範圍**是文字檔案中該節點的索引 (起始和結束位置)。</span><span class="sxs-lookup"><span data-stu-id="00c73-139">The **span** is the indices (the starting and ending position) of that node in the text file.</span></span>  <span data-ttu-id="00c73-140">在上述 C# 範例中，選取的 "UsingKeyword [0..5)" 語彙基元具有五個字元寬 [0..5) 的「範圍」。</span><span class="sxs-lookup"><span data-stu-id="00c73-140">In the preceding C# example, the selected “UsingKeyword [0..5)” token has a **Span** that is five characters wide, [0..5).</span></span> <span data-ttu-id="00c73-141">"[..)" 標記法表示起始索引是範圍的一部分，但結束索引不是。</span><span class="sxs-lookup"><span data-stu-id="00c73-141">The "[..)" notation means that the starting index is part of the span, but the ending index is not.</span></span>

<span data-ttu-id="00c73-142">有兩種方式可瀏覽樹狀結構：</span><span class="sxs-lookup"><span data-stu-id="00c73-142">There are two ways to navigate the tree:</span></span>
* <span data-ttu-id="00c73-143">展開，或按一下樹狀結構中的項目。</span><span class="sxs-lookup"><span data-stu-id="00c73-143">Expand or click on items in the tree.</span></span> <span data-ttu-id="00c73-144">視覺化檢視會在程式碼編輯器中自動選取對應至此項目範圍的文字。</span><span class="sxs-lookup"><span data-stu-id="00c73-144">The visualizer automatically selects the text corresponding to this item’s span in the code editor.</span></span>
* <span data-ttu-id="00c73-145">在程式碼編輯器中，按一下或選取文字。</span><span class="sxs-lookup"><span data-stu-id="00c73-145">Click or select text in the code editor.</span></span> <span data-ttu-id="00c73-146">在上述 VB 範例中，如果您在程式碼編輯器中選取包含 "Module Module1" 的行，視覺化檢視會自動瀏覽至樹狀結構中的對應 ModuleStatement 節點。</span><span class="sxs-lookup"><span data-stu-id="00c73-146">In the preceding VB example, if you select the line containing "Module Module1" in the code editor, the visualizer automatically navigates to the corresponding ModuleStatement node in the tree.</span></span> 

<span data-ttu-id="00c73-147">視覺化檢視會反白顯示樹狀結構中，範圍最符合文字編輯器中所選取文字之範圍的項目。</span><span class="sxs-lookup"><span data-stu-id="00c73-147">The visualizer highlights the item in the tree whose span best matches the span of the text selected in the editor.</span></span>

<span data-ttu-id="00c73-148">視覺化檢視會重新整理樹狀結構，使其符合使用中程式碼檔案中的修改。</span><span class="sxs-lookup"><span data-stu-id="00c73-148">The visualizer refreshes the tree to match modifications in the active code file.</span></span> <span data-ttu-id="00c73-149">在 `Main()` 內新增 `Console.WriteLine()` 的呼叫。</span><span class="sxs-lookup"><span data-stu-id="00c73-149">Add a call to `Console.WriteLine()` inside `Main()`.</span></span> <span data-ttu-id="00c73-150">當您輸入時，視覺化檢視會重新整理樹狀結構。</span><span class="sxs-lookup"><span data-stu-id="00c73-150">As you type, the visualizer refreshes the tree.</span></span>

<span data-ttu-id="00c73-151">輸入 `Console.` 之後暫停輸入。</span><span class="sxs-lookup"><span data-stu-id="00c73-151">Pause typing once you have typed `Console.`.</span></span> <span data-ttu-id="00c73-152">樹狀結構有些項目會著上粉紅色。</span><span class="sxs-lookup"><span data-stu-id="00c73-152">The tree has some items colored in pink.</span></span> <span data-ttu-id="00c73-153">此時，輸入的程式碼中有錯誤 (也稱為「診斷」)。</span><span class="sxs-lookup"><span data-stu-id="00c73-153">At this point, there are errors (also referred to as ‘Diagnostics’) in the typed code.</span></span> <span data-ttu-id="00c73-154">這些錯誤會附加至語法樹狀結構中的節點、語彙基元和邏輯。</span><span class="sxs-lookup"><span data-stu-id="00c73-154">These errors are attached to nodes, tokens, and trivia in the syntax tree.</span></span> <span data-ttu-id="00c73-155">視覺化檢視會顯示哪些項目附加了錯誤，並將背景反白顯示為粉紅色。</span><span class="sxs-lookup"><span data-stu-id="00c73-155">The visualizer shows you which items have errors attached to them highlighting the background in pink.</span></span> <span data-ttu-id="00c73-156">您可以將滑鼠游標停留在任何粉紅色的項目上，檢查錯誤。</span><span class="sxs-lookup"><span data-stu-id="00c73-156">You can inspect the errors on any item colored pink by hovering over the item.</span></span> <span data-ttu-id="00c73-157">視覺化檢視只會顯示語法錯誤 (與輸入程式碼的語法相關的錯誤)。它不會顯示任何語意錯誤。</span><span class="sxs-lookup"><span data-stu-id="00c73-157">The visualizer only displays syntactic errors (those errors related to the syntax of the typed code); it doesn't display any semantic errors.</span></span>
 
## <a name="syntax-graphs"></a><span data-ttu-id="00c73-158">語法圖</span><span class="sxs-lookup"><span data-stu-id="00c73-158">Syntax Graphs</span></span>

<span data-ttu-id="00c73-159">在樹狀結構中的任何項目上按一下滑鼠右鍵，然後按一下 [檢視導向語法圖]。</span><span class="sxs-lookup"><span data-stu-id="00c73-159">Right click on any item in the tree and click on **View Directed Syntax Graph**.</span></span> 

<span data-ttu-id="00c73-160">視覺化檢視會顯示子樹狀結構的圖形表示法，其根目錄位在選取的項目。</span><span class="sxs-lookup"><span data-stu-id="00c73-160">The visualizer displays a graphical representation of the subtree rooted at the selected item.</span></span> <span data-ttu-id="00c73-161">針對在 C# 範例中對應至 `Main()`方法的 **ethodDeclaration** 節點，嘗試這些步驟。</span><span class="sxs-lookup"><span data-stu-id="00c73-161">Try these steps for the **MethodDeclaration** node corresponding to the `Main()` method in the C# example.</span></span> <span data-ttu-id="00c73-162">視覺化檢視會顯示看似如下的語法圖：</span><span class="sxs-lookup"><span data-stu-id="00c73-162">The visualizer displays a syntax graph that looks as follows:</span></span>

![檢視 C# 語法圖](media/csharp-syntax-graph.png)

<span data-ttu-id="00c73-164">針對上述 VB 範例中，對應至 `Main()` 方法的 **SubBlock** 節點，嘗試相同步驟。</span><span class="sxs-lookup"><span data-stu-id="00c73-164">Try the same for the **SubBlock** node corresponding to the `Main()` method in the preceding VB example.</span></span> <span data-ttu-id="00c73-165">視覺化檢視會顯示看似如下的語法圖：</span><span class="sxs-lookup"><span data-stu-id="00c73-165">The visualizer displays a syntax graph that looks as follows:</span></span>

![檢視 VB 語法圖](media/visual-basic-syntax-graph.png)

<span data-ttu-id="00c73-167">語法圖表檢視器有顯示圖例色彩配置的選項。</span><span class="sxs-lookup"><span data-stu-id="00c73-167">The syntax graph viewer has an option to display a legend its coloring scheme.</span></span> <span data-ttu-id="00c73-168">您也可以將滑鼠停留在語法圖中的個別項目，檢視對應至該項目的屬性。</span><span class="sxs-lookup"><span data-stu-id="00c73-168">You can also hover over individual items in the syntax graph with the mouse to view the properties corresponding to that item.</span></span>

<span data-ttu-id="00c73-169">您可以重複在樹狀結構中檢視不同項目的語法圖，圖形一律會顯示在 Visual Studio 內的同一個視窗。</span><span class="sxs-lookup"><span data-stu-id="00c73-169">You can view syntax graphs for different items in the tree repeatedly and the graphs will always be displayed in the same window inside Visual Studio.</span></span> <span data-ttu-id="00c73-170">您可以將這個視窗停駐在 Visual Studio 內方便的位置，如此便不需要切換索引標籤來檢視新的語法圖。</span><span class="sxs-lookup"><span data-stu-id="00c73-170">You can dock this window at a convenient location inside Visual Studio so that you don’t have to switch between tabs to view a new syntax graph.</span></span> <span data-ttu-id="00c73-171">底端 (在程式碼編輯器視窗下) 通常很方便。</span><span class="sxs-lookup"><span data-stu-id="00c73-171">The bottom, below code editor windows, is often convenient.</span></span>

<span data-ttu-id="00c73-172">以下是要搭配視覺化檢視工具視窗與語法圖視窗使用的停駐配置：</span><span class="sxs-lookup"><span data-stu-id="00c73-172">Here is the docking layout to use with the visualizer tool window and the syntax graph window:</span></span>

![視覺化檢視和語法圖視窗使用一種停駐配置](media/docking-layout.png)

<span data-ttu-id="00c73-174">另一個選項是將語法圖視窗放在雙重監視器設定的第二個監視器。</span><span class="sxs-lookup"><span data-stu-id="00c73-174">Another option is to put the syntax graph window on a second monitor, in a dual monitor setup.</span></span>

# <a name="inspecting-semantics"></a><span data-ttu-id="00c73-175">檢查語意</span><span class="sxs-lookup"><span data-stu-id="00c73-175">Inspecting semantics</span></span>

<span data-ttu-id="00c73-176">語法視覺化檢視可以進行符號和語意資訊的基本檢查。</span><span class="sxs-lookup"><span data-stu-id="00c73-176">The Syntax Visualizer enables rudimentary inspection of symbols and semantic information.</span></span> <span data-ttu-id="00c73-177">在 C# 範例中的 Main() 內輸入 `double x = 1 + 1;`。</span><span class="sxs-lookup"><span data-stu-id="00c73-177">Type `double x = 1 + 1;` inside Main() in the C# example.</span></span> <span data-ttu-id="00c73-178">然後，在程式碼編輯器視窗中選取運算式 `1 + 1`。</span><span class="sxs-lookup"><span data-stu-id="00c73-178">Then, select the expression `1 + 1` in the code editor window.</span></span> <span data-ttu-id="00c73-179">視覺化檢視會在視覺化檢視中反白顯示 **AddExpression** 節點。</span><span class="sxs-lookup"><span data-stu-id="00c73-179">The visualizer highlights the **AddExpression** node in the visualizer.</span></span> <span data-ttu-id="00c73-180">以滑鼠右鍵按一下此 **AddExpression**，然後按一下 [檢視符號 (如果有的話)]。</span><span class="sxs-lookup"><span data-stu-id="00c73-180">Right click on this **AddExpression** and click on **View Symbol (if any)**.</span></span> <span data-ttu-id="00c73-181">請注意，大部分的功能表項目都有「如果有的話」這個限定詞。</span><span class="sxs-lookup"><span data-stu-id="00c73-181">Notice that most of the menu items have the "if any" qualifier.</span></span> <span data-ttu-id="00c73-182">語法視覺化檢視會檢查節點的屬性，包括可能不針對所有節點都存在的屬性。</span><span class="sxs-lookup"><span data-stu-id="00c73-182">The Syntax Visualizer inspects properties of a Node, including properties that may not be present for all nodes.</span></span> 

<span data-ttu-id="00c73-183">視覺化檢視中的屬性方格會如下圖所示地更新：運算式的符號是 **SynthesizedIntrinsicOperatorSymbol**，且 **Kind = Method**。</span><span class="sxs-lookup"><span data-stu-id="00c73-183">The property grid in the visualizer updates as shown in the following figure: The symbol for the expression is a **SynthesizedIntrinsicOperatorSymbol** with **Kind = Method**.</span></span>

![Symbol 屬性](media/symbol-properties.png)

<span data-ttu-id="00c73-185">對相同的 **AddExpression** 節點嘗試 [檢視 TypeSymbol (如果有的話)]。</span><span class="sxs-lookup"><span data-stu-id="00c73-185">Try **View TypeSymbol (if any)** for the same **AddExpression** node.</span></span> <span data-ttu-id="00c73-186">視覺化檢視中的屬性方格會如下圖所示地更新，指出所選取之運算式的型別是 `Int32`。</span><span class="sxs-lookup"><span data-stu-id="00c73-186">The property grid in the visualizer updates as shown in the following figure, indicating that the type of the selected expression is `Int32`.</span></span>

![TypeSymbol 屬性](media/type-symbol-properties.png)

<span data-ttu-id="00c73-188">對相同的 **AddExpression** 節點嘗試 [檢視已轉換 TypeSymbol (如果有的話)]。</span><span class="sxs-lookup"><span data-stu-id="00c73-188">Try **View Converted TypeSymbol (if any)** for the same **AddExpression** node.</span></span> <span data-ttu-id="00c73-189">屬性方格會更新，指出雖然運算式的型別是 `Int32`，但運算式的轉換後型別是 `Double`，如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="00c73-189">The property grid updates indicating that although the type of the expression is `Int32`, the converted type of the expression is `Double` as shown in the following figure.</span></span> <span data-ttu-id="00c73-190">這個節點包含已轉換的型別符號資訊，因為 `Int32` 運算式發生的內容中，它必須轉換成 `Double`。</span><span class="sxs-lookup"><span data-stu-id="00c73-190">This node includes converted type symbol information because the `Int32` expression occurs in a context where it must be converted to a `Double`.</span></span> <span data-ttu-id="00c73-191">這項轉換滿足了為指派運算子左側的變數 `x` 指定的 `Double` 型別。</span><span class="sxs-lookup"><span data-stu-id="00c73-191">This conversion satisfies the `Double` type specified for the variable `x` on the left-hand side of the assignment operator.</span></span>

![已轉換的 TypeSymbol 屬性](media/converted-type-symbol-properties.png)

<span data-ttu-id="00c73-193">最後，對相同的 **AddExpression** 節點嘗試 [檢視常數值 (如果有的話)]。</span><span class="sxs-lookup"><span data-stu-id="00c73-193">Finally, try **View Constant Value (if any)** for the same **AddExpression** node.</span></span> <span data-ttu-id="00c73-194">屬性方格顯示運算式的值是一個值為 `2` 的編譯時間常數。</span><span class="sxs-lookup"><span data-stu-id="00c73-194">The property grid shows that the value of the expression is a compile time constant with value `2`.</span></span>

![常數值](media/constant-value.png)

<span data-ttu-id="00c73-196">上述範例也可以用 VB 複寫。</span><span class="sxs-lookup"><span data-stu-id="00c73-196">The preceding example can also be replicated in VB.</span></span> <span data-ttu-id="00c73-197">在 VB 檔案中輸入 `Dim x As Double = 1 + 1`。</span><span class="sxs-lookup"><span data-stu-id="00c73-197">Type `Dim x As Double = 1 + 1` in a VB file.</span></span> <span data-ttu-id="00c73-198">在程式碼編輯器視窗中選取運算式 `1 + 1`。</span><span class="sxs-lookup"><span data-stu-id="00c73-198">Select the expression `1 + 1` in the code editor window.</span></span> <span data-ttu-id="00c73-199">視覺化檢視會在視覺化檢視中反白顯示對應的 **AddExpression** 節點。</span><span class="sxs-lookup"><span data-stu-id="00c73-199">The visualizer highlights the corresponding **AddExpression** node in the visualizer.</span></span> <span data-ttu-id="00c73-200">對這個 **AddExpression** 重複上述步驟，您應該會看到相同的結果。</span><span class="sxs-lookup"><span data-stu-id="00c73-200">Repeat the preceding steps for this **AddExpression** and you should see identical results.</span></span>

<span data-ttu-id="00c73-201">在 VB 中檢查更多程式碼。</span><span class="sxs-lookup"><span data-stu-id="00c73-201">Examine more code in VB.</span></span> <span data-ttu-id="00c73-202">用下列程式碼更新您的主要 VB 檔案：</span><span class="sxs-lookup"><span data-stu-id="00c73-202">Update your main VB file with the following code:</span></span>

```vb
Imports C = System.Console

Module Program
    Sub Main(args As String())
        C.WriteLine()
    End Sub
End Module
```

<span data-ttu-id="00c73-203">此程式碼導入了名為 `C` 的別名，它對應至檔案頂端的型別 `System.Console`，並在 `Main()` 使用此別名。</span><span class="sxs-lookup"><span data-stu-id="00c73-203">This code introduces an alias named `C` that maps to the type `System.Console` at the top of the file and uses this alias inside `Main()`.</span></span> <span data-ttu-id="00c73-204">在 `Main()` 方法內選取使用此別名，`C.WriteLine()` 中的 `C`。</span><span class="sxs-lookup"><span data-stu-id="00c73-204">Select the use of this alias, the `C` in `C.WriteLine()`, inside the `Main()` method.</span></span> <span data-ttu-id="00c73-205">視覺化檢視會選取視覺化檢視對應的 **IdentifierName** 節點。</span><span class="sxs-lookup"><span data-stu-id="00c73-205">The visualizer selects the corresponding **IdentifierName** node in the visualizer.</span></span> <span data-ttu-id="00c73-206">在此節點上按一下滑鼠右鍵，然後按一下 [檢視符號 (如果有的話)]。</span><span class="sxs-lookup"><span data-stu-id="00c73-206">Right-click this node and click on **View Symbol (if any)**.</span></span> <span data-ttu-id="00c73-207">屬性方格指出，此識別碼已繫結至型別 `System.Console`，如下圖所示：</span><span class="sxs-lookup"><span data-stu-id="00c73-207">The property grid indicates that this identifier is bound to the type `System.Console` as shown in the following figure:</span></span>

![Symbol 屬性](media/symbol-visual-basic.png)

<span data-ttu-id="00c73-209">對相同的 **IdentifierName** 節點嘗試 [檢視 AliasSymbol (如果有的話)]。</span><span class="sxs-lookup"><span data-stu-id="00c73-209">Try **View AliasSymbol (if any)** for the same **IdentifierName** node.</span></span> <span data-ttu-id="00c73-210">屬性方格指出，識別碼是名為 `C` 的別名，且已繫結至 `System.Console` 目標。</span><span class="sxs-lookup"><span data-stu-id="00c73-210">The property grid indicates the identifier is an alias with name `C` that is bound to the `System.Console` target.</span></span> <span data-ttu-id="00c73-211">換句話說，屬性方格提供關於 對應至識別碼 `C` 的 **AliasSymbol** 的資訊。</span><span class="sxs-lookup"><span data-stu-id="00c73-211">In other words, the property grid provides information regarding the **AliasSymbol** corresponding to the identifier `C`.</span></span>

![AliasSymbol 屬性](media/alias-symbol.png)

<span data-ttu-id="00c73-213">檢查對應至任何宣告之型別、方法、屬性的符號。</span><span class="sxs-lookup"><span data-stu-id="00c73-213">Inspect the symbol corresponding to any declared type, method, property.</span></span> <span data-ttu-id="00c73-214">在視覺化檢視中選取對應的節點，然後按一下 [檢視符號 (如果有的話)]。</span><span class="sxs-lookup"><span data-stu-id="00c73-214">Select the corresponding node in the visualizer and click on **View Symbol (if any)**.</span></span> <span data-ttu-id="00c73-215">選取方法 `Sub Main()`，包括方法的主體。</span><span class="sxs-lookup"><span data-stu-id="00c73-215">Select the method `Sub Main()`, including the body of the method.</span></span> <span data-ttu-id="00c73-216">在視覺化檢視中，針對對應的 **SubBlock** 節點按一下 [檢視符號 (如果有的話)]。</span><span class="sxs-lookup"><span data-stu-id="00c73-216">Click on **View Symbol (if any)** for the corresponding **SubBlock** node in the visualizer.</span></span> <span data-ttu-id="00c73-217">屬性方格顯示此 **SubBlock** 的 **MethodSymbol** 具有名稱 `Main`，以及傳回型別 `Void`。</span><span class="sxs-lookup"><span data-stu-id="00c73-217">The property grid shows the **MethodSymbol** for this **SubBlock** has name `Main` with return type `Void`.</span></span>

![檢視方法宣告的符號](media/method-symbol.png)

<span data-ttu-id="00c73-219">上述 VB 範例可以輕鬆地用 C# 複寫。</span><span class="sxs-lookup"><span data-stu-id="00c73-219">The above VB examples can be easily replicated in C#.</span></span> <span data-ttu-id="00c73-220">輸入 `using C = System.Console;` 取代 `Imports C = System.Console`作為別名。</span><span class="sxs-lookup"><span data-stu-id="00c73-220">Type `using C = System.Console;` in place of `Imports C = System.Console` for the alias.</span></span> <span data-ttu-id="00c73-221">C# 的上述步驟會在視覺化檢視視窗中產生相同的結果。</span><span class="sxs-lookup"><span data-stu-id="00c73-221">The preceding steps in C# yield identical results in the visualizer window.</span></span>

<span data-ttu-id="00c73-222">只能在節點上使用語意檢查作業。</span><span class="sxs-lookup"><span data-stu-id="00c73-222">Semantic inspection operations are only available on nodes.</span></span> <span data-ttu-id="00c73-223">它們不適用於語彙基元或邏輯。</span><span class="sxs-lookup"><span data-stu-id="00c73-223">They are not available on tokens or trivia.</span></span> <span data-ttu-id="00c73-224">並非所有節點都有有趣的語意資訊可以檢查。</span><span class="sxs-lookup"><span data-stu-id="00c73-224">Not all nodes have interesting semantic information to inspect.</span></span> <span data-ttu-id="00c73-225">當節點沒有有趣的語意資訊時，按一下 [檢視 \* 符號 (如果有的話)] 會顯示空白的屬性方格。</span><span class="sxs-lookup"><span data-stu-id="00c73-225">When a node doesn't have interesting semantic information, clicking on **View \* Symbol (if any)** shows a blank property grid.</span></span>

<span data-ttu-id="00c73-226">您可以在[使用語意](work-with-semantics.md)概觀文件閱讀更多執行語意分析的 API 內容。</span><span class="sxs-lookup"><span data-stu-id="00c73-226">You can read more about APIs for performing semantic analysis in the [Work with semantics](work-with-semantics.md) overview document.</span></span>

## <a name="closing-the-syntax-visualizer"></a><span data-ttu-id="00c73-227">關閉語法視覺化檢視</span><span class="sxs-lookup"><span data-stu-id="00c73-227">Closing the syntax visualizer</span></span>

<span data-ttu-id="00c73-228">當您不使用視覺化檢視視窗來檢查原始碼時，可以將它關閉。</span><span class="sxs-lookup"><span data-stu-id="00c73-228">You can close the visualizer window when you are not using it to examine source code.</span></span> <span data-ttu-id="00c73-229">當您巡覽程式碼中，編輯並變更原始碼時，語法視覺化檢視會更新它的顯示畫面。</span><span class="sxs-lookup"><span data-stu-id="00c73-229">The syntax visualizer updates its display as you navigate through code, editing and changing source.</span></span> <span data-ttu-id="00c73-230">您不使用它時，它可能會令人分心。</span><span class="sxs-lookup"><span data-stu-id="00c73-230">It can get distracting when you are not using it.</span></span> 
