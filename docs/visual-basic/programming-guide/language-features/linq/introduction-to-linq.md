---
title: Visual Basic 中的 LINQ 簡介
ms.date: 08/28/2018
helpviewer_keywords:
- queries [LINQ in Visual Basic], about LINQ in Visual Basic queries
- query execution [LINQ in Visual Basic]
- range variables [Visual Basic]
- LINQ [Visual Basic]
- LINQ [Visual Basic], about LINQ in Visual Basic
- query expressions [LINQ in Visual Basic]
- LINQ
- deferred execution
- iteration variables [Visual Basic]
ms.assetid: 3047d86e-0d49-40e2-928b-dc02e46c7984
ms.openlocfilehash: c9a8149ecf4f2a1c76ba00b0f80bc703114e11ca
ms.sourcegitcommit: cdf67135a98a5a51913dacddb58e004a3c867802
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2019
ms.locfileid: "69660778"
---
# <a name="introduction-to-linq-in-visual-basic"></a><span data-ttu-id="ef2a3-102">Visual Basic 中的 LINQ 簡介</span><span class="sxs-lookup"><span data-stu-id="ef2a3-102">Introduction to LINQ in Visual Basic</span></span>
<span data-ttu-id="ef2a3-103">語言整合式查詢 (LINQ) 會將查詢功能加入至 Visual Basic, 並在您處理所有類型的資料時提供簡單且功能強大的功能。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-103">Language-Integrated Query (LINQ) adds query capabilities to Visual Basic and provides simple and powerful capabilities when you work with all kinds of data.</span></span> <span data-ttu-id="ef2a3-104">LINQ 並不會將查詢傳送至要處理的資料庫, 或針對您要搜尋的每個資料類型使用不同的查詢語法, 而是將查詢引進為 Visual Basic 語言的一部分。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-104">Rather than sending a query to a database to be processed, or working with different query syntax for each type of data that you are searching, LINQ introduces queries as part of the Visual Basic language.</span></span> <span data-ttu-id="ef2a3-105">它使用統一的語法，不論資料類型為何。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-105">It uses a unified syntax regardless of the type of data.</span></span>  
  
 <span data-ttu-id="ef2a3-106">LINQ 可讓您從 SQL Server 資料庫、XML、記憶體內部的陣列和集合、ADO.NET 資料集, 或任何支援 LINQ 的其他遠端或本機資料來源查詢資料。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-106">LINQ enables you to query data from a SQL Server database, XML, in-memory arrays and collections, ADO.NET datasets, or any other remote or local data source that supports LINQ.</span></span> <span data-ttu-id="ef2a3-107">您可以使用通用 Visual Basic 語言專案來執行所有動作。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-107">You can do all this with common Visual Basic language elements.</span></span> <span data-ttu-id="ef2a3-108">因為您的查詢是以 Visual Basic 語言撰寫, 所以您的查詢結果會以強型別物件的形式傳回。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-108">Because your queries are written in the Visual Basic language, your query results are returned as strongly-typed objects.</span></span> <span data-ttu-id="ef2a3-109">這些物件支援 IntelliSense，讓您加快撰寫程式碼的速度，並在編譯階段即捕捉查詢中的錯誤，而不是在執行階段。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-109">These objects support IntelliSense, which enables you to write code faster and catch errors in your queries at compile time instead of at run time.</span></span> <span data-ttu-id="ef2a3-110">LINQ 查詢可用做其他查詢來源，以精簡結果。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-110">LINQ queries can be used as the source of additional queries to refine results.</span></span> <span data-ttu-id="ef2a3-111">它們也可以繫結至控制項，讓使用者輕鬆地檢視和修改查詢結果。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-111">They can also be bound to controls so that users can easily view and modify your query results.</span></span>  
  
 <span data-ttu-id="ef2a3-112">例如，下列程式碼範例顯示的 LINQ 查詢，會從集合中傳回一份客戶清單，並根據位置分組。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-112">For example, the following code example shows a LINQ query that returns a list of customers from a collection and groups them based on their location.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#1)]  
  
## <a name="running-the-examples"></a><span data-ttu-id="ef2a3-113">執行範例</span><span class="sxs-lookup"><span data-stu-id="ef2a3-113">Running the examples</span></span>  
 <span data-ttu-id="ef2a3-114">若要執行 [簡介] 和 [ [LINQ 查詢的結構](#structure-of-a-linq-query)] 區段中的範例, 請加入下列程式碼, 這會傳回客戶和訂單的清單。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-114">To run the examples in the introduction and in the [Structure of a LINQ Query](#structure-of-a-linq-query) section, include the following code, which returns lists of customers and orders.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#31](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#31)]  
  
## <a name="linq-providers"></a><span data-ttu-id="ef2a3-115">LINQ 提供者</span><span class="sxs-lookup"><span data-stu-id="ef2a3-115">LINQ providers</span></span>  
 <span data-ttu-id="ef2a3-116">*Linq 提供者*會將您的 Visual Basic linq 查詢對應至所查詢的資料來源。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-116">A *LINQ provider* maps your Visual Basic LINQ queries to the data source being queried.</span></span> <span data-ttu-id="ef2a3-117">當您撰寫 LINQ 查詢時，提供者會接受該查詢，並將它轉譯成資料來源能夠執行的命令。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-117">When you write a LINQ query, the provider takes that query and translates it into commands that the data source will be able to execute.</span></span> <span data-ttu-id="ef2a3-118">提供者也會將資料從來源轉換成組成查詢結果的物件。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-118">The provider also converts data from the source to the objects that make up your query result.</span></span> <span data-ttu-id="ef2a3-119">最後，當您將更新傳送至資料來源時，它會將物件轉換成資料。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-119">Finally, it converts objects to data when you send updates to the data source.</span></span>  
  
 <span data-ttu-id="ef2a3-120">Visual Basic 包括下列的 LINQ 提供者。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-120">Visual Basic includes the following LINQ providers.</span></span>  
  
|<span data-ttu-id="ef2a3-121">提供者</span><span class="sxs-lookup"><span data-stu-id="ef2a3-121">Provider</span></span>|<span data-ttu-id="ef2a3-122">描述</span><span class="sxs-lookup"><span data-stu-id="ef2a3-122">Description</span></span>|  
|---|---|  
|<span data-ttu-id="ef2a3-123">LINQ to Objects</span><span class="sxs-lookup"><span data-stu-id="ef2a3-123">LINQ to Objects</span></span>|<span data-ttu-id="ef2a3-124">LINQ to Objects 提供者讓您查詢記憶體內部的集合和陣列。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-124">The LINQ to Objects provider enables you to query in-memory collections and arrays.</span></span> <span data-ttu-id="ef2a3-125">如果物件支援 <xref:System.Collections.IEnumerable> 或 <xref:System.Collections.Generic.IEnumerable%601> 介面，LINQ to Objects 提供者就會讓您查詢。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-125">If an object supports either the <xref:System.Collections.IEnumerable> or <xref:System.Collections.Generic.IEnumerable%601> interface, the LINQ to Objects provider enables you to query it.</span></span><br /><br /> <span data-ttu-id="ef2a3-126">您可以匯入<xref:System.Linq>命名空間 (預設會針對所有 Visual Basic 專案匯入) 來啟用 LINQ to Objects 提供者。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-126">You can enable the LINQ to Objects provider by importing the <xref:System.Linq> namespace, which is imported by default for all Visual Basic projects.</span></span><br /><br /> <span data-ttu-id="ef2a3-127">如需有關 LINQ to Objects 提供者的詳細資訊, 請參閱[LINQ to Objects](../../concepts/linq/linq-to-objects.md)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-127">For more information about the LINQ to Objects provider, see [LINQ to Objects](../../concepts/linq/linq-to-objects.md).</span></span>|  
|<span data-ttu-id="ef2a3-128">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="ef2a3-128">LINQ to SQL</span></span>|<span data-ttu-id="ef2a3-129">LINQ to SQL 提供者可讓您查詢及修改 SQL Server 資料庫中的資料。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-129">The LINQ to SQL provider enables you to query and modify data in a SQL Server database.</span></span> <span data-ttu-id="ef2a3-130">這可讓您輕鬆對應應用程式的物件模型與資料庫的資料表和物件。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-130">This makes it easy to map the object model for an application to the tables and objects in a database.</span></span><br /><br /> <span data-ttu-id="ef2a3-131">Visual Basic 藉由包含物件關聯式設計工具 (O/R 設計工具), 讓您更輕鬆地使用 LINQ to SQL。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-131">Visual Basic makes it easier to work with LINQ to SQL by including the Object Relational Designer (O/R Designer).</span></span> <span data-ttu-id="ef2a3-132">這個設計工具是用於在對應至資料庫物件的應用程式中建立物件模型。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-132">This designer is used to create an object model in an application that maps to objects in a database.</span></span> <span data-ttu-id="ef2a3-133">O/R 設計工具也提供將預存程式和函式對應至<xref:System.Data.Linq.DataContext>物件的功能, 它會管理與資料庫的通訊, 並儲存開放式平行存取檢查的狀態。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-133">The O/R Designer also provides functionality to map stored procedures and functions to the <xref:System.Data.Linq.DataContext> object, which manages communication with the database and stores state for optimistic concurrency checks.</span></span><br /><br /> <span data-ttu-id="ef2a3-134">如需有關 LINQ to SQL 提供者的詳細資訊, 請參閱[LINQ to SQL](../../../../framework/data/adonet/sql/linq/index.md)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-134">For more information about the LINQ to SQL provider, see [LINQ to SQL](../../../../framework/data/adonet/sql/linq/index.md).</span></span> <span data-ttu-id="ef2a3-135">如需物件關聯式設計工具的詳細資訊, 請參閱[Visual Studio 中的 LINQ to SQL 工具](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-135">For more information about the Object Relational Designer, see [LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2).</span></span>|  
|<span data-ttu-id="ef2a3-136">LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="ef2a3-136">LINQ to XML</span></span>|<span data-ttu-id="ef2a3-137">LINQ to XML 提供者可讓您查詢及修改 XML。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-137">The LINQ to XML provider enables you to query and modify XML.</span></span> <span data-ttu-id="ef2a3-138">您可以修改記憶體內部的 XML，也可以從檔案載入 XML 並將 XML 儲存到檔案。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-138">You can modify in-memory XML, or you can load XML from and save XML to a file.</span></span><br /><br /> <span data-ttu-id="ef2a3-139">此外, LINQ to XML 提供者會啟用 XML 常值和 XML 軸屬性, 讓您可以直接在您的 Visual Basic 程式碼中撰寫 XML。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-139">Additionally, the LINQ to XML provider enables XML literals and XML axis properties that enable you to write XML directly in your Visual Basic code.</span></span> <span data-ttu-id="ef2a3-140">如需詳細資訊, 請參閱[XML](../../../../visual-basic/programming-guide/language-features/xml/index.md)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-140">For more information, see [XML](../../../../visual-basic/programming-guide/language-features/xml/index.md).</span></span>|  
|<span data-ttu-id="ef2a3-141">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="ef2a3-141">LINQ to DataSet</span></span>|<span data-ttu-id="ef2a3-142">LINQ to DataSet 提供者可讓您查詢和更新 ADO.NET 資料集中的資料。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-142">The LINQ to DataSet provider enables you to query and update data in an ADO.NET dataset.</span></span> <span data-ttu-id="ef2a3-143">您可以將 LINQ 的強大功能加入使用資料集的應用程式，以簡化並擴充查詢、彙總及更新資料集資料的能力。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-143">You can add the power of LINQ to applications that use datasets in order to simplify and extend your capabilities for querying, aggregating, and updating the data in your dataset.</span></span><br /><br /> <span data-ttu-id="ef2a3-144">如需詳細資訊，請參閱 [LINQ to DataSet](../../../../framework/data/adonet/linq-to-dataset.md)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-144">For more information, see [LINQ to DataSet](../../../../framework/data/adonet/linq-to-dataset.md).</span></span>|  
  
## <a name="structure-of-a-linq-query"></a><span data-ttu-id="ef2a3-145">LINQ 查詢的結構</span><span class="sxs-lookup"><span data-stu-id="ef2a3-145">Structure of a LINQ query</span></span>  
 <span data-ttu-id="ef2a3-146">LINQ 查詢, 通常稱為*查詢運算式*, 由查詢子句的組合所組成, 用以識別查詢的資料來源和反復專案變數。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-146">A LINQ query, often referred to as a *query expression*, consists of a combination of query clauses that identify the data sources and iteration variables for the query.</span></span> <span data-ttu-id="ef2a3-147">查詢運算式也可以包含排序、篩選、群組和聯結的指示，或套用至來源資料的計算。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-147">A query expression can also include instructions for sorting, filtering, grouping, and joining, or calculations to apply to the source data.</span></span> <span data-ttu-id="ef2a3-148">查詢運算式語法類似於 SQL 語法，所以您會覺得大部分的語法很熟悉。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-148">Query expression syntax resembles the syntax of SQL; therefore, you may find much of the syntax familiar.</span></span>  
  
 <span data-ttu-id="ef2a3-149">查詢運算式以 `From` 子句開頭。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-149">A query expression starts with a `From` clause.</span></span> <span data-ttu-id="ef2a3-150">這個子句會識別查詢和變數的來源資料，這些變數用於分別參考來源資料的每個項目。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-150">This clause identifies the source data for a query and the variables that are used to refer to each element of the source data individually.</span></span> <span data-ttu-id="ef2a3-151">這些變數稱為*範圍變數*或*反復專案變數*。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-151">These variables are named *range variables* or *iteration variables*.</span></span> <span data-ttu-id="ef2a3-152">查詢一定要有 `From` 子句，`Aggregate` 查詢除外，因為 `From` 子句對這類查詢為選擇性項目。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-152">The `From` clause is required for a query, except for `Aggregate` queries, where the `From` clause is optional.</span></span> <span data-ttu-id="ef2a3-153">識別出 `From` 或 `Aggregate` 子句中的查詢範圍和來源之後，您可以包含任何查詢子句組合以精簡查詢。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-153">After the scope and source of the query are identified in the `From` or `Aggregate` clauses, you can include any combination of query clauses to refine the query.</span></span> <span data-ttu-id="ef2a3-154">如需查詢子句的詳細資訊, 請參閱本主題稍後的 Visual Basic LINQ 查詢運算子。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-154">For details about query clauses, see Visual Basic LINQ Query Operators later in this topic.</span></span> <span data-ttu-id="ef2a3-155">例如，下列查詢會將客戶資料的來源集合識別為 `customers` 變數，而反覆運算變數則稱之為 `cust`。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-155">For example, the following query identifies a source collection of customer data as the `customers` variable, and an iteration variable named `cust`.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#2)]  
  
 <span data-ttu-id="ef2a3-156">這個範例本身就是個有效的查詢；但是當您加入更多的查詢子句來精簡結果時，查詢就會變得更強大。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-156">This example is a valid query by itself; however, the query becomes far more powerful when you add more query clauses to refine the result.</span></span> <span data-ttu-id="ef2a3-157">例如，您可以加入 `Where` 子句，根據一或多個值來篩選結果。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-157">For example, you can add a `Where` clause to filter the result by one or more values.</span></span> <span data-ttu-id="ef2a3-158">查詢運算式是單行程式碼，您只可以將其他查詢子句附加至查詢結尾。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-158">Query expressions are a single line of code; you can just append additional query clauses to the end of the query.</span></span> <span data-ttu-id="ef2a3-159">您可以使用底線 (\_) 行接續字元, 將查詢分解成多行文字, 以改善可讀性。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-159">You can break up a query across multiple lines of text to improve readability by using the underscore (\_) line-continuation character.</span></span> <span data-ttu-id="ef2a3-160">下列程式碼範例顯示的查詢範例，包含 `Where` 子句。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-160">The following code example shows an example of a query that includes a `Where` clause.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#3)]  
  
 <span data-ttu-id="ef2a3-161">另一個功能強大的查詢子句是 `Select` 子句，可讓您只傳回從資料來源選取的欄位。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-161">Another powerful query clause is the `Select` clause, which enables you to return only selected fields from the data source.</span></span> <span data-ttu-id="ef2a3-162">LINQ 查詢會傳回可列舉的強類型物件集合。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-162">LINQ queries return enumerable collections of strongly typed objects.</span></span> <span data-ttu-id="ef2a3-163">查詢可以傳回匿名類型或具名類型的集合。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-163">A query can return a collection of anonymous types or named types.</span></span> <span data-ttu-id="ef2a3-164">您可以使用 `Select` 子句，只傳回資料來源的單一欄位。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-164">You can use the `Select` clause to return only a single field from the data source.</span></span> <span data-ttu-id="ef2a3-165">當您這麼做時，傳回的集合類型就是該單一欄位的類型。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-165">When you do this, the type of the collection returned is the type of that single field.</span></span> <span data-ttu-id="ef2a3-166">您也可以使用 `Select` 子句，傳回資料來源的多個欄位。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-166">You can also use the `Select` clause to return multiple fields from the data source.</span></span> <span data-ttu-id="ef2a3-167">當您這麼做時，傳回的集合類型就是新的匿名類型。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-167">When you do this, the type of the collection returned is a new anonymous type.</span></span> <span data-ttu-id="ef2a3-168">您也可以比對查詢傳回的欄位和指定的具名類型欄位。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-168">You can also match the fields returned by the query to the fields of a specified named type.</span></span> <span data-ttu-id="ef2a3-169">下列程式碼範例顯示傳回匿名類型集合的查詢運算式，該類型具有填入來自資料來源之選取欄位資料的成員。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-169">The following code example shows a query expression that returns a collection of anonymous types that have members populated with data from the selected fields from the data source.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#4)]  
  
 <span data-ttu-id="ef2a3-170">LINQ 查詢也可以用來結合多個資料來源，並傳回單一結果。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-170">LINQ queries can also be used to combine multiple sources of data and return a single result.</span></span> <span data-ttu-id="ef2a3-171">使用一或多個 `From` 子句，或使用 `Join` 或 `Group Join` 查詢子句，即可完成。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-171">This can be done with one or more `From` clauses, or by using the `Join` or `Group Join` query clauses.</span></span> <span data-ttu-id="ef2a3-172">下列程式碼範例顯示的查詢運算式，結合了客戶和訂單資料，並傳回包含客戶和訂單資料的匿名類型集合。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-172">The following code example shows a query expression that combines customer and order data and returns a collection of anonymous types containing customer and order data.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#5)]  
  
 <span data-ttu-id="ef2a3-173">您可以使用 `Group Join` 子句建立階層式的查詢結果，其包含客戶物件的集合。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-173">You can use the `Group Join` clause to create a hierarchical query result that contains a collection of customer objects.</span></span> <span data-ttu-id="ef2a3-174">每個客戶物件都有一個屬性，包含該客戶所有訂單的集合。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-174">Each customer object has a property that contains a collection of all orders for that customer.</span></span> <span data-ttu-id="ef2a3-175">下列程式碼範例顯示的查詢運算式，結合了階層式結果的客戶和訂單資料，並傳回匿名類型的集合。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-175">The following code example shows a query expression that combines customer and order data as a hierarchical result and returns a collection of anonymous types.</span></span> <span data-ttu-id="ef2a3-176">查詢傳回的類型包含 `CustomerOrders` 屬性，內含客戶訂單資料的集合。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-176">The query returns a type that includes a `CustomerOrders` property that contains a collection of order data for the customer.</span></span> <span data-ttu-id="ef2a3-177">它也包含 `OrderTotal` 屬性，內含該客戶所有訂單小計的總和。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-177">It also includes an `OrderTotal` property that contains the sum of the totals for all the orders for that customer.</span></span> <span data-ttu-id="ef2a3-178">(這個查詢相當於 LEFT OUTER JOIN)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-178">(This query is equivalent to a LEFT OUTER JOIN.)</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#6)]  
  
 <span data-ttu-id="ef2a3-179">另有幾個 LINQ 查詢運算子，可讓您建立功能強大的查詢運算式。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-179">There are several additional LINQ query operators that you can use to create powerful query expressions.</span></span> <span data-ttu-id="ef2a3-180">本主題的下一節，將討論查詢運算式中可包含的各種查詢子句。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-180">The next section of this topic discusses the various query clauses that you can include in a query expression.</span></span> <span data-ttu-id="ef2a3-181">如需 Visual Basic 查詢子句的詳細資訊, 請參閱[查詢](../../../../visual-basic/language-reference/queries/index.md)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-181">For details about Visual Basic query clauses, see [Queries](../../../../visual-basic/language-reference/queries/index.md).</span></span>  
  
## <a name="visual-basic-linq-query-operators"></a><span data-ttu-id="ef2a3-182">Visual Basic LINQ 查詢運算子</span><span class="sxs-lookup"><span data-stu-id="ef2a3-182">Visual Basic LINQ query operators</span></span>  

<span data-ttu-id="ef2a3-183"><xref:System.Linq> 命名空間和其他支援 LINQ 查詢的命名空間中的類別，包含了依應用程式需求建立並精簡查詢的呼叫方法。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-183">The classes in the <xref:System.Linq> namespace and the other namespaces that support LINQ queries include methods that you can call to create and refine queries based on the needs of your application.</span></span> <span data-ttu-id="ef2a3-184">Visual Basic 包含下列常用查詢子句的關鍵字。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-184">Visual Basic includes keywords for the following common query clauses.</span></span> <span data-ttu-id="ef2a3-185">如需 Visual Basic 查詢子句的詳細資訊, 請參閱[查詢](../../../language-reference/queries/index.md)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-185">For details about Visual Basic query clauses, see [Queries](../../../language-reference/queries/index.md).</span></span>

### <a name="from-clause"></a><span data-ttu-id="ef2a3-186">From 子句</span><span class="sxs-lookup"><span data-stu-id="ef2a3-186">From clause</span></span>

<span data-ttu-id="ef2a3-187">必須[ `From` ](../../../../visual-basic/language-reference/queries/from-clause.md) 有`Aggregate`子句或子句, 才能開始查詢。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-187">Either a [`From` clause](../../../../visual-basic/language-reference/queries/from-clause.md) or an `Aggregate` clause is required to begin a query.</span></span> <span data-ttu-id="ef2a3-188">`From` 子句會指定查詢的來源集合和反覆運算變數。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-188">A `From` clause specifies a source collection and an iteration variable for a query.</span></span> <span data-ttu-id="ef2a3-189">例如：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-189">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#7)]

### <a name="select-clause"></a><span data-ttu-id="ef2a3-190">Select 子句</span><span class="sxs-lookup"><span data-stu-id="ef2a3-190">Select clause</span></span>

<span data-ttu-id="ef2a3-191">選擇性。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-191">Optional.</span></span> <span data-ttu-id="ef2a3-192">子句會宣告一組查詢的反復專案變數。 [ `Select` ](../../../../visual-basic/language-reference/queries/select-clause.md)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-192">A [`Select` clause](../../../../visual-basic/language-reference/queries/select-clause.md) declares a set of iteration variables for a query.</span></span> <span data-ttu-id="ef2a3-193">例如：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-193">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#8)]

<span data-ttu-id="ef2a3-194">如果不指定 `Select` 子句，則查詢的反覆運算變數即由 `From` 或 `Aggregate` 子句指定的反覆運算變數組成。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-194">If a `Select` clause is not specified, the iteration variables for the query consist of the iteration variables specified by the `From` or `Aggregate` clause.</span></span>

### <a name="where-clause"></a><span data-ttu-id="ef2a3-195">Where 子句</span><span class="sxs-lookup"><span data-stu-id="ef2a3-195">Where clause</span></span>

<span data-ttu-id="ef2a3-196">選擇性。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-196">Optional.</span></span> <span data-ttu-id="ef2a3-197">子句會指定查詢的篩選準則。 [ `Where` ](../../../../visual-basic/language-reference/queries/where-clause.md)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-197">A [`Where` clause](../../../../visual-basic/language-reference/queries/where-clause.md) specifies a filtering condition for a query.</span></span> <span data-ttu-id="ef2a3-198">例如：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-198">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#9)]

### <a name="order-by-clause"></a><span data-ttu-id="ef2a3-199">Order By 子句]</span><span class="sxs-lookup"><span data-stu-id="ef2a3-199">Order By clause]</span></span>

<span data-ttu-id="ef2a3-200">|選擇性.</span><span class="sxs-lookup"><span data-stu-id="ef2a3-200">|Optional.</span></span> <span data-ttu-id="ef2a3-201">子句會指定查詢中資料行的排序次序。 [ `Order By` ](../../../../visual-basic/language-reference/queries/order-by-clause.md)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-201">An [`Order By` clause](../../../../visual-basic/language-reference/queries/order-by-clause.md) specifies the sort order for columns in a query.</span></span> <span data-ttu-id="ef2a3-202">例如：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-202">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#10)]

### <a name="join-clause"></a><span data-ttu-id="ef2a3-203">Join 子句</span><span class="sxs-lookup"><span data-stu-id="ef2a3-203">Join clause</span></span>

<span data-ttu-id="ef2a3-204">選擇性。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-204">Optional.</span></span> <span data-ttu-id="ef2a3-205">[ `Join`子句](../../../../visual-basic/language-reference/queries/join-clause.md)會將兩個集合合併成單一集合。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-205">A [`Join` clause](../../../../visual-basic/language-reference/queries/join-clause.md) combines two collections into a single collection.</span></span> <span data-ttu-id="ef2a3-206">例如：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-206">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#11](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#11)]

### <a name="group-by-clause"></a><span data-ttu-id="ef2a3-207">Group By 子句</span><span class="sxs-lookup"><span data-stu-id="ef2a3-207">Group By clause</span></span>

<span data-ttu-id="ef2a3-208">選擇性。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-208">Optional.</span></span> <span data-ttu-id="ef2a3-209">子句會將查詢結果的元素群組在一起。 [ `Group By` ](../../../../visual-basic/language-reference/queries/group-by-clause.md)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-209">A [`Group By` clause](../../../../visual-basic/language-reference/queries/group-by-clause.md) groups the elements of a query result.</span></span> <span data-ttu-id="ef2a3-210">它可以用來將彙總函式套用至每個群組。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-210">It can be used to apply aggregate functions to each group.</span></span> <span data-ttu-id="ef2a3-211">例如：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-211">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#12](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#12)]

### <a name="group-join-clause"></a><span data-ttu-id="ef2a3-212">Group Join 子句</span><span class="sxs-lookup"><span data-stu-id="ef2a3-212">Group Join clause</span></span>

<span data-ttu-id="ef2a3-213">選擇性。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-213">Optional.</span></span> <span data-ttu-id="ef2a3-214">[ `Group Join`子句](../../../../visual-basic/language-reference/queries/group-join-clause.md)會將兩個集合合併成一個階層式集合。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-214">A [`Group Join` clause](../../../../visual-basic/language-reference/queries/group-join-clause.md) combines two collections into a single hierarchical collection.</span></span> <span data-ttu-id="ef2a3-215">例如：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-215">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#13)]

### <a name="aggregate-clause"></a><span data-ttu-id="ef2a3-216">Aggregate 子句</span><span class="sxs-lookup"><span data-stu-id="ef2a3-216">Aggregate clause</span></span>

<span data-ttu-id="ef2a3-217">必須有`From`子句或子句, 才能開始查詢。 [ `Aggregate` ](../../../../visual-basic/language-reference/queries/aggregate-clause.md)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-217">Either an [`Aggregate` clause](../../../../visual-basic/language-reference/queries/aggregate-clause.md) or a `From` clause is required to begin a query.</span></span> <span data-ttu-id="ef2a3-218">`Aggregate` 子句會將一或多個彙總函式套用至集合。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-218">An `Aggregate` clause applies one or more aggregate functions to a collection.</span></span> <span data-ttu-id="ef2a3-219">例如, 您可以使用`Aggregate`子句來計算查詢所傳回之所有元素的總和, 如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-219">For example, you can use the `Aggregate` clause to calculate a sum for all the elements returned by a query, as the following example does.</span></span>

 [!code-vb[VbVbalrIntroToLINQ#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#14)]

<span data-ttu-id="ef2a3-220">也可以使用 `Aggregate` 子句修改查詢。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-220">You can also use the `Aggregate` clause to modify a query.</span></span> <span data-ttu-id="ef2a3-221">例如，您可以使用 `Aggregate` 子句執行相關查詢集合的計算。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-221">For example, you can use the `Aggregate` clause to perform a calculation on a related query collection.</span></span> <span data-ttu-id="ef2a3-222">例如：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-222">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#15)]

### <a name="let-clause"></a><span data-ttu-id="ef2a3-223">Let 子句</span><span class="sxs-lookup"><span data-stu-id="ef2a3-223">Let clause</span></span>

<span data-ttu-id="ef2a3-224">選擇性。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-224">Optional.</span></span> <span data-ttu-id="ef2a3-225">子句會計算值, 並將它指派給查詢中的新變數。 [ `Let` ](../../../../visual-basic/language-reference/queries/let-clause.md)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-225">A [`Let` clause](../../../../visual-basic/language-reference/queries/let-clause.md) computes a value and assigns it to a new variable in the query.</span></span> <span data-ttu-id="ef2a3-226">例如：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-226">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#16)]

### <a name="distinct-clause"></a><span data-ttu-id="ef2a3-227">Distinct 子句</span><span class="sxs-lookup"><span data-stu-id="ef2a3-227">Distinct clause</span></span>

<span data-ttu-id="ef2a3-228">選擇性。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-228">Optional.</span></span> <span data-ttu-id="ef2a3-229">`Distinct`子句會限制目前反覆運算變數的值, 以排除查詢結果中重複的值。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-229">A `Distinct` clause restricts the values of the current iteration variable to eliminate duplicate values in query results.</span></span> <span data-ttu-id="ef2a3-230">例如：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-230">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#17](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#17)]

### <a name="skip-clause"></a><span data-ttu-id="ef2a3-231">Skip 子句</span><span class="sxs-lookup"><span data-stu-id="ef2a3-231">Skip clause</span></span>

<span data-ttu-id="ef2a3-232">選擇性。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-232">Optional.</span></span> <span data-ttu-id="ef2a3-233">子句會略過集合中指定數目的元素, 然後傳回其餘的專案。 [ `Skip` ](../../../../visual-basic/language-reference/queries/skip-clause.md)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-233">A [`Skip` clause](../../../../visual-basic/language-reference/queries/skip-clause.md) bypasses a specified number of elements in a collection and then returns the remaining elements.</span></span> <span data-ttu-id="ef2a3-234">例如：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-234">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#18)]

### <a name="skip-while-clause"></a><span data-ttu-id="ef2a3-235">Skip While 子句</span><span class="sxs-lookup"><span data-stu-id="ef2a3-235">Skip While clause</span></span>

<span data-ttu-id="ef2a3-236">選擇性。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-236">Optional.</span></span> <span data-ttu-id="ef2a3-237">只要指定的條件為, `true` [子句就會略過集合中的專案,然後傳回其餘的元素。`Skip While` ](../../../../visual-basic/language-reference/queries/skip-while-clause.md)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-237">A [`Skip While` clause](../../../../visual-basic/language-reference/queries/skip-while-clause.md) bypasses elements in a collection as long as a specified condition is `true` and then returns the remaining elements.</span></span> <span data-ttu-id="ef2a3-238">例如：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-238">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#19](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#19)]

### <a name="take-clause"></a><span data-ttu-id="ef2a3-239">Take 子句</span><span class="sxs-lookup"><span data-stu-id="ef2a3-239">Take clause</span></span>

<span data-ttu-id="ef2a3-240">選擇性。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-240">Optional.</span></span> <span data-ttu-id="ef2a3-241">子句會從集合開頭傳回指定數目的連續元素。 [ `Take` ](../../../../visual-basic/language-reference/queries/take-clause.md)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-241">A [`Take` clause](../../../../visual-basic/language-reference/queries/take-clause.md) returns a specified number of contiguous elements from the start of a collection.</span></span> <span data-ttu-id="ef2a3-242">例如：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-242">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#20](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#20)]

### <a name="take-while-clause"></a><span data-ttu-id="ef2a3-243">Take While 子句</span><span class="sxs-lookup"><span data-stu-id="ef2a3-243">Take While clause</span></span>

<span data-ttu-id="ef2a3-244">選擇性。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-244">Optional.</span></span> <span data-ttu-id="ef2a3-245">只要指定的條件為, `true` [子句就會包含集合中的元素,並略過其餘的專案。`Take While` ](../../../../visual-basic/language-reference/queries/take-while-clause.md)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-245">A [`Take While` clause](../../../../visual-basic/language-reference/queries/take-while-clause.md) includes elements in a collection as long as a specified condition is `true` and bypasses the remaining elements.</span></span> <span data-ttu-id="ef2a3-246">例如：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-246">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#21)]
  
## <a name="use-additional-linq-query-features"></a><span data-ttu-id="ef2a3-247">使用其他 LINQ 查詢功能</span><span class="sxs-lookup"><span data-stu-id="ef2a3-247">Use additional LINQ query features</span></span>  
  
<span data-ttu-id="ef2a3-248">透過呼叫 LINQ 提供的可列舉和可查詢類型的成員，您可以使用其他的 LINQ 查詢功能。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-248">You can use additional LINQ query features by calling members of the enumerable and queryable types provided by LINQ.</span></span> <span data-ttu-id="ef2a3-249">透過呼叫查詢運算式結果上的特定查詢運算子，您可以使用這些額外的功能。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-249">You can use these additional capabilities by calling a particular query operator on the result of a query expression.</span></span> <span data-ttu-id="ef2a3-250">例如, 下列範例會使用<xref:System.Linq.Enumerable.Union%2A?displayProperty=nameWithType>方法, 將兩個查詢的結果結合成一個查詢結果。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-250">For example, the following example uses the <xref:System.Linq.Enumerable.Union%2A?displayProperty=nameWithType> method to combine the results of two queries into one query result.</span></span> <span data-ttu-id="ef2a3-251">它使用 <xref:System.Linq.Enumerable.ToList%2A?displayProperty=nameWithType> 方法傳回泛型清單的查詢結果。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-251">It uses the <xref:System.Linq.Enumerable.ToList%2A?displayProperty=nameWithType> method to return the query result as a generic list.</span></span>
  
 [!code-vb[VbVbalrIntroToLINQ#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#22)]  
  
 <span data-ttu-id="ef2a3-252">如需其他 LINQ 功能的詳細資訊, 請參閱[標準查詢運算子總覽](../../concepts/linq/standard-query-operators-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-252">For details about additional LINQ capabilities, see [Standard Query Operators Overview](../../concepts/linq/standard-query-operators-overview.md).</span></span>  
  
## <a name="connect-to-a-database-by-using-linq-to-sql"></a><span data-ttu-id="ef2a3-253">使用 LINQ to SQL 連接到資料庫</span><span class="sxs-lookup"><span data-stu-id="ef2a3-253">Connect to a database by using LINQ to SQL</span></span>  
 <span data-ttu-id="ef2a3-254">在 Visual Basic 中, 您可以使用 LINQ to SQL 檔案來識別您想要存取的 SQL Server 資料庫物件, 例如資料表、視圖和預存程式。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-254">In Visual Basic, you identify the SQL Server database objects, such as tables, views, and stored procedures, that you want to access by using a LINQ to SQL file.</span></span> <span data-ttu-id="ef2a3-255">LINQ to SQL 檔案的副檔名為 .dbml。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-255">A LINQ to SQL file has an extension of .dbml.</span></span>  
  
 <span data-ttu-id="ef2a3-256">當您有 SQL Server 資料庫的有效連接時, 可以將**LINQ to SQL 類別**專案範本新增至您的專案。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-256">When you have a valid connection to a SQL Server database, you can add a **LINQ to SQL Classes** item template to your project.</span></span> <span data-ttu-id="ef2a3-257">這會顯示物件關聯式設計工具 (O/R 設計工具)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-257">This will display the Object Relational Designer (O/R designer).</span></span> <span data-ttu-id="ef2a3-258">O/R 設計工具可讓您將想要在程式碼中存取的專案從**伺服器總管**/**資料庫總管**拖曳到設計工具介面上。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-258">The O/R Designer enables you to drag the items that you want to access in your code from the **Server Explorer**/**Database Explorer** onto the designer surface.</span></span> <span data-ttu-id="ef2a3-259">LINQ to SQL 檔案將 <xref:System.Data.Linq.DataContext> 物件加入專案。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-259">The LINQ to SQL file adds a <xref:System.Data.Linq.DataContext> object to your project.</span></span> <span data-ttu-id="ef2a3-260">此物件包含您想要存取的資料表和檢視的屬性和集合，以及您想要呼叫的預存程序方法。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-260">This object includes properties and collections for the tables and views that you want access to, and methods for the stored procedures that you want to call.</span></span> <span data-ttu-id="ef2a3-261">將變更儲存至 LINQ to SQL (.dbml) 檔案之後，參考 O/R 設計工具所定義的 <xref:System.Data.Linq.DataContext> 物件，您就可以存取程式碼中的這些物件。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-261">After you have saved your changes to the LINQ to SQL (.dbml) file, you can access these objects in your code by referencing the <xref:System.Data.Linq.DataContext> object that is defined by the O/R Designer.</span></span> <span data-ttu-id="ef2a3-262">專案的 <xref:System.Data.Linq.DataContext> 物件依據您的 LINQ to SQL 檔案名稱來命名。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-262">The <xref:System.Data.Linq.DataContext> object for your project is named based on the name of your LINQ to SQL file.</span></span> <span data-ttu-id="ef2a3-263">例如，名為 Northwind.dbml 的 LINQ to SQL 檔案，會建立名為 `NorthwindDataContext` 的 <xref:System.Data.Linq.DataContext> 物件。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-263">For example, a LINQ to SQL file that is named Northwind.dbml will create a <xref:System.Data.Linq.DataContext> object named `NorthwindDataContext`.</span></span>  
  
 <span data-ttu-id="ef2a3-264">如需有關逐步指示的範例, 請參閱[如何:查詢資料庫](how-to-query-a-database-by-using-linq.md)和[如何:呼叫預存](how-to-call-a-stored-procedure-by-using-linq.md)程式。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-264">For examples with step-by-step instructions, see [How to: Query a Database](how-to-query-a-database-by-using-linq.md) and [How to: Call a Stored Procedure](how-to-call-a-stored-procedure-by-using-linq.md).</span></span>  
  
## <a name="visual-basic-features-that-support-linq"></a><span data-ttu-id="ef2a3-265">支援 LINQ 的 Visual Basic 功能</span><span class="sxs-lookup"><span data-stu-id="ef2a3-265">Visual Basic features that support LINQ</span></span>  
 <span data-ttu-id="ef2a3-266">Visual Basic 包含其他顯著的功能, 可讓您使用 LINQ simple, 並減少您必須撰寫來執行 LINQ 查詢的程式碼數量。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-266">Visual Basic includes other notable features that make the use of LINQ simple and reduce the amount of code that you must write to perform LINQ queries.</span></span> <span data-ttu-id="ef2a3-267">這些需求包括下列各項：</span><span class="sxs-lookup"><span data-stu-id="ef2a3-267">These include the following:</span></span>  
  
- <span data-ttu-id="ef2a3-268">**匿名型別**, 可讓您根據查詢結果建立新的類型。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-268">**Anonymous types**, which enable you to create a new type based on a query result.</span></span>  
  
- <span data-ttu-id="ef2a3-269">**隱含類型變數**, 可讓您延後指定類型, 並讓編譯器根據查詢結果推斷類型。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-269">**Implicitly typed variables**, which enable you to defer specifying a type and let the compiler infer the type based on the query result.</span></span>  
  
- <span data-ttu-id="ef2a3-270">**擴充方法**, 可讓您使用自己的方法擴充現有的類型, 而不需要修改類型本身。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-270">**Extension methods**, which enable you to extend an existing type with your own methods without modifying the type itself.</span></span>  
  
 <span data-ttu-id="ef2a3-271">如需詳細資訊, 請參閱[支援 LINQ 的 Visual Basic 功能](../../concepts/linq/features-that-support-linq.md)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-271">For details, see [Visual Basic Features That Support LINQ](../../concepts/linq/features-that-support-linq.md).</span></span>  
  
## <a name="deferred-and-immediate-query-execution"></a><span data-ttu-id="ef2a3-272">延後和立即執行查詢</span><span class="sxs-lookup"><span data-stu-id="ef2a3-272">Deferred and immediate query execution</span></span>

 <span data-ttu-id="ef2a3-273">查詢執行會與建立查詢分開。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-273">Query execution is separate from creating a query.</span></span> <span data-ttu-id="ef2a3-274">查詢建立之後，會另有機制觸發執行。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-274">After a query is created, its execution is triggered by a separate mechanism.</span></span> <span data-ttu-id="ef2a3-275">查詢可以在定義 (*立即執行*) 時立即執行, 或可以儲存定義, 而且稍後可以執行查詢 (*延後執行*)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-275">A query can be executed as soon as it is defined (*immediate execution*), or the definition can be stored and the query can be executed later (*deferred execution*).</span></span>  
  
 <span data-ttu-id="ef2a3-276">當您建立查詢時，查詢本身預設不會立即執行。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-276">By default, when you create a query, the query itself does not execute immediately.</span></span> <span data-ttu-id="ef2a3-277">反而會將查詢定義儲存在變數中，用以參考查詢結果。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-277">Instead, the query definition is stored in the variable that is used to reference the query result.</span></span> <span data-ttu-id="ef2a3-278">稍後存取程式碼中的查詢結果變數時，例如在 `For…Next` 迴圈中，就會執行查詢。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-278">When the query result variable is accessed later in code, such as in a `For…Next` loop, the query is executed.</span></span> <span data-ttu-id="ef2a3-279">此程式稱為*延後執行*。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-279">This process is referred to as *deferred execution*.</span></span>  
  
 <span data-ttu-id="ef2a3-280">查詢也可以在定義時執行, 這稱為「*立即執行*」。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-280">Queries can also be executed when they are defined, which is referred to as *immediate execution*.</span></span> <span data-ttu-id="ef2a3-281">套用要求存取查詢結果個別項目的方法，可觸發立即執行。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-281">You can trigger immediate execution by applying a method that requires access to individual elements of the query result.</span></span> <span data-ttu-id="ef2a3-282">這個結果可能會包括彙總函式，例如 `Count`、`Sum`、`Average`、`Min` 或 `Max`。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-282">This can be the result of including an aggregate function, such as `Count`, `Sum`, `Average`, `Min`, or `Max`.</span></span> <span data-ttu-id="ef2a3-283">如需彙總函式的詳細資訊, 請參閱[Aggregate 子句](../../../language-reference/queries/aggregate-clause.md)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-283">For more information about aggregate functions, see [Aggregate Clause](../../../language-reference/queries/aggregate-clause.md).</span></span>  
  
 <span data-ttu-id="ef2a3-284">使用 `ToList` 或 `ToArray` 方法也會強制立即執行。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-284">Using the `ToList` or `ToArray` methods will also force immediate execution.</span></span> <span data-ttu-id="ef2a3-285">當您想要立即執行查詢並快取結果時，這方法非常好用。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-285">This can be useful when you want to execute the query immediately and cache the results.</span></span> <span data-ttu-id="ef2a3-286">如需這些方法的詳細資訊, 請參閱[轉換資料類型](../../concepts/linq/converting-data-types.md)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-286">For more information about these methods, see [Converting Data Types](../../concepts/linq/converting-data-types.md).</span></span>  
  
 <span data-ttu-id="ef2a3-287">如需查詢執行的詳細資訊, 請參閱[撰寫您的第一個 LINQ 查詢](../../concepts/linq/writing-your-first-linq-query.md)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-287">For more information about query execution, see [Writing Your First LINQ Query](../../concepts/linq/writing-your-first-linq-query.md).</span></span>  
  
## <a name="xml-in-visual-basic"></a><span data-ttu-id="ef2a3-288">Visual Basic 中的 XML</span><span class="sxs-lookup"><span data-stu-id="ef2a3-288">XML in Visual Basic</span></span>  
 <span data-ttu-id="ef2a3-289">Visual Basic 中的 XML 功能包括 XML 常值和 XML 軸屬性, 可讓您輕鬆地在程式碼中建立、存取、查詢及修改 XML。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-289">The XML features in Visual Basic include XML literals and XML axis properties, which enable you easily to create, access, query, and modify XML in your code.</span></span> <span data-ttu-id="ef2a3-290">XML 常值可讓您直接在程式碼中撰寫 XML。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-290">XML literals enable you to write XML directly in your code.</span></span> <span data-ttu-id="ef2a3-291">Visual Basic 編譯器將 XML 視為第一級的資料物件。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-291">The Visual Basic compiler treats the XML as a first-class data object.</span></span>  
  
 <span data-ttu-id="ef2a3-292">下列程式碼範例示範如何建立 XML 項目、存取其子項目和屬性，以及使用 LINQ 查詢項目內容。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-292">The following code example shows how to create an XML element, access its sub-elements and attributes, and query the contents of the element by using LINQ.</span></span>  
  
 [!code-vb[VbXmlSamples#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbXMLSamples/VB/XMLSamples3.vb#8)]  
  
 <span data-ttu-id="ef2a3-293">如需詳細資訊, 請參閱[XML](../xml/index.md)。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-293">For more information, see [XML](../xml/index.md).</span></span>  
  
## <a name="related-resources"></a><span data-ttu-id="ef2a3-294">相關資源</span><span class="sxs-lookup"><span data-stu-id="ef2a3-294">Related resources</span></span>  
  
|<span data-ttu-id="ef2a3-295">主題</span><span class="sxs-lookup"><span data-stu-id="ef2a3-295">Topic</span></span>|<span data-ttu-id="ef2a3-296">描述</span><span class="sxs-lookup"><span data-stu-id="ef2a3-296">Description</span></span>|  
|---|---|  
|[<span data-ttu-id="ef2a3-297">XML</span><span class="sxs-lookup"><span data-stu-id="ef2a3-297">XML</span></span>](../../language-features/xml/index.md)|<span data-ttu-id="ef2a3-298">描述 Visual Basic 中可查詢的 XML 功能, 並可讓您在 Visual Basic 程式碼中將 XML 當做第一級資料物件包含。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-298">Describes the XML features in Visual Basic that can be queried and that enable you to include XML as first-class data objects in your Visual Basic code.</span></span>|  
|[<span data-ttu-id="ef2a3-299">查詢</span><span class="sxs-lookup"><span data-stu-id="ef2a3-299">Queries</span></span>](../../../language-reference/queries/index.md)|<span data-ttu-id="ef2a3-300">提供 Visual Basic 中可用之查詢子句的相關參考資訊。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-300">Provides reference information about the query clauses that are available in Visual Basic.</span></span>|  
|[<span data-ttu-id="ef2a3-301">LINQ (Language-Integrated Query)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-301">LINQ (Language-Integrated Query)</span></span>](../../concepts/linq/index.md)|<span data-ttu-id="ef2a3-302">包含 LINQ 的一般資訊、程式設計指南和範例。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-302">Includes general information, programming guidance, and samples for LINQ.</span></span>|  
|[<span data-ttu-id="ef2a3-303">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="ef2a3-303">LINQ to SQL</span></span>](../../../../framework/data/adonet/sql/linq/index.md)|<span data-ttu-id="ef2a3-304">包含 LINQ to SQL 的一般資訊、程式設計指南和範例。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-304">Includes general information, programming guidance, and samples for LINQ to SQL.</span></span>|  
|[<span data-ttu-id="ef2a3-305">LINQ to Objects</span><span class="sxs-lookup"><span data-stu-id="ef2a3-305">LINQ to Objects</span></span>](../../concepts/linq/linq-to-objects.md)|<span data-ttu-id="ef2a3-306">包含 LINQ to Objects 的一般資訊、程式設計指南和範例。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-306">Includes general information, programming guidance, and samples for LINQ to Objects.</span></span>|  
|[<span data-ttu-id="ef2a3-307">LINQ to ADO.NET (入口網站頁面)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-307">LINQ to ADO.NET (Portal Page)</span></span>](../../concepts/linq/linq-to-adonet-portal-page.md)|<span data-ttu-id="ef2a3-308">包含 LINQ to ADO.NET 的一般資訊、程式設計指南和範例的連結。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-308">Includes links to general information, programming guidance, and samples for LINQ to ADO.NET.</span></span>|  
|[<span data-ttu-id="ef2a3-309">LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="ef2a3-309">LINQ to XML</span></span>](../../concepts/linq/linq-to-xml.md)|<span data-ttu-id="ef2a3-310">包含 LINQ to XML 的一般資訊、程式設計指南和範例。</span><span class="sxs-lookup"><span data-stu-id="ef2a3-310">Includes general information, programming guidance, and samples for LINQ to XML.</span></span>|  
  
## <a name="how-to-and-walkthrough-topics"></a><span data-ttu-id="ef2a3-311">How to 和逐步解說主題</span><span class="sxs-lookup"><span data-stu-id="ef2a3-311">How to and walkthrough topics</span></span>
 [<span data-ttu-id="ef2a3-312">如何：查詢資料庫</span><span class="sxs-lookup"><span data-stu-id="ef2a3-312">How to: Query a Database</span></span>](how-to-query-a-database-by-using-linq.md)  
  
 [<span data-ttu-id="ef2a3-313">如何：呼叫預存程式</span><span class="sxs-lookup"><span data-stu-id="ef2a3-313">How to: Call a Stored Procedure</span></span>](how-to-call-a-stored-procedure-by-using-linq.md)  
  
 [<span data-ttu-id="ef2a3-314">如何：修改資料庫中的資料</span><span class="sxs-lookup"><span data-stu-id="ef2a3-314">How to: Modify Data in a Database</span></span>](how-to-modify-data-in-a-database-by-using-linq.md)  
  
 [<span data-ttu-id="ef2a3-315">如何：結合資料與聯結</span><span class="sxs-lookup"><span data-stu-id="ef2a3-315">How to: Combine Data with Joins</span></span>](how-to-combine-data-with-linq-by-using-joins.md)  
  
 [<span data-ttu-id="ef2a3-316">如何：排序查詢結果</span><span class="sxs-lookup"><span data-stu-id="ef2a3-316">How to: Sort Query Results</span></span>](how-to-sort-query-results-by-using-linq.md)  
  
 [<span data-ttu-id="ef2a3-317">如何：篩選查詢結果</span><span class="sxs-lookup"><span data-stu-id="ef2a3-317">How to: Filter Query Results</span></span>](how-to-filter-query-results-by-using-linq.md)  
  
 [<span data-ttu-id="ef2a3-318">如何：計數、加總或平均資料</span><span class="sxs-lookup"><span data-stu-id="ef2a3-318">How to: Count, Sum, or Average Data</span></span>](how-to-count-sum-or-average-data-by-using-linq.md)  
  
 [<span data-ttu-id="ef2a3-319">如何：尋找查詢結果中的最小或最大值</span><span class="sxs-lookup"><span data-stu-id="ef2a3-319">How to: Find the Minimum or Maximum Value in a Query Result</span></span>](how-to-find-the-minimum-or-maximum-value-in-a-query-result.md)  
  
 [<span data-ttu-id="ef2a3-320">如何：指派用來執行更新、插入和刪除的預存程序 (O/R 設計工具)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-320">How to: Assign stored procedures to perform updates, inserts, and deletes (O/R Designer)</span></span>](/visualstudio/data-tools/how-to-assign-stored-procedures-to-perform-updates-inserts-and-deletes-o-r-designer)  
  
## <a name="featured-book-chapters"></a><span data-ttu-id="ef2a3-321">精選書籍章節</span><span class="sxs-lookup"><span data-stu-id="ef2a3-321">Featured book chapters</span></span>  
 <span data-ttu-id="ef2a3-322">[第17章:程式](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ff652502(v=orm.10))設計中的 LINQ [Visual Basic 2008](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ff652504(v=orm.10))</span><span class="sxs-lookup"><span data-stu-id="ef2a3-322">[Chapter 17: LINQ](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ff652502(v=orm.10)) in [Programming Visual Basic 2008](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ff652504(v=orm.10))</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ef2a3-323">另請參閱</span><span class="sxs-lookup"><span data-stu-id="ef2a3-323">See also</span></span>

- [<span data-ttu-id="ef2a3-324">LINQ (Language-Integrated Query)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-324">LINQ (Language-Integrated Query)</span></span>](../../concepts/linq/index.md)
- [<span data-ttu-id="ef2a3-325">Visual Basic 中的 LINQ to XML 概觀</span><span class="sxs-lookup"><span data-stu-id="ef2a3-325">Overview of LINQ to XML in Visual Basic</span></span>](../../language-features/xml/overview-of-linq-to-xml.md)
- [<span data-ttu-id="ef2a3-326">LINQ to DataSet 概觀</span><span class="sxs-lookup"><span data-stu-id="ef2a3-326">LINQ to DataSet Overview</span></span>](../../../../framework/data/adonet/linq-to-dataset-overview.md)
- [<span data-ttu-id="ef2a3-327">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="ef2a3-327">LINQ to SQL</span></span>](../../../../framework/data/adonet/sql/linq/index.md)
- <span data-ttu-id="ef2a3-328">[LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2) (Visual Studio 中的 LINQ to SQL 工具)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-328">[LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2)</span></span>
- [<span data-ttu-id="ef2a3-329">DataContext 方法 (O/R 設計工具)</span><span class="sxs-lookup"><span data-stu-id="ef2a3-329">DataContext Methods (O/R Designer)</span></span>](/visualstudio/data-tools/datacontext-methods-o-r-designer)
