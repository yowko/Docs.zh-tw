---
title: Event 陳述式 (Visual Basic)
ms.date: 05/12/2018
f1_keywords:
- vb.Event
- vb.Custom
helpviewer_keywords:
- Event statement [Visual Basic]
- declaring events [Visual Basic], syntax
- Public keyword [Visual Basic], Event statements
- Custom keyword [Visual Basic]
- declarations [Visual Basic], events
- event keyword [Visual Basic]
- WithEvents keyword [Visual Basic], Event statements
- events [Visual Basic], declaring
- ByVal keyword [Visual Basic], Event statements
- events [Visual Basic], custom
- ByRef keyword [Visual Basic], Event statements
- declaring user-defined events
ms.assetid: 306ff8ed-74dd-4b6a-bd2f-e91b17474042
ms.openlocfilehash: 5ae25cbca73f7c8e767cad0ac332d77c306724a1
ms.sourcegitcommit: a885cc8c3e444ca6471348893d5373c6e9e49a47
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/06/2018
ms.locfileid: "43883918"
---
# <a name="event-statement"></a><span data-ttu-id="5dc54-102">Event 陳述式</span><span class="sxs-lookup"><span data-stu-id="5dc54-102">Event Statement</span></span>
<span data-ttu-id="5dc54-103">宣告使用者定義的事件。</span><span class="sxs-lookup"><span data-stu-id="5dc54-103">Declares a user-defined event.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="5dc54-104">語法</span><span class="sxs-lookup"><span data-stu-id="5dc54-104">Syntax</span></span>  
  
```  
[ <attrlist> ] [ accessmodifier ] _  
[ Shared ] [ Shadows ] Event eventname[(parameterlist)] _  
[ Implements implementslist ]  
' -or-  
[ <attrlist> ] [ accessmodifier ] _  
[ Shared ] [ Shadows ] Event eventname As delegatename _  
[ Implements implementslist ]  
' -or-  
 [ <attrlist> ] [ accessmodifier ] _  
[ Shared ] [ Shadows ] Custom Event eventname As delegatename _  
[ Implements implementslist ]  
   [ <attrlist> ] AddHandler(ByVal value As delegatename)  
      [ statements ]  
   End AddHandler  
   [ <attrlist> ] RemoveHandler(ByVal value As delegatename)  
      [ statements ]  
   End RemoveHandler  
   [ <attrlist> ] RaiseEvent(delegatesignature)  
      [ statements ]  
   End RaiseEvent  
End Event  
```  
  
## <a name="parts"></a><span data-ttu-id="5dc54-105">組件</span><span class="sxs-lookup"><span data-stu-id="5dc54-105">Parts</span></span>  
  
|<span data-ttu-id="5dc54-106">組件</span><span class="sxs-lookup"><span data-stu-id="5dc54-106">Part</span></span>|<span data-ttu-id="5dc54-107">描述</span><span class="sxs-lookup"><span data-stu-id="5dc54-107">Description</span></span>|  
|---|---|  
|`attrlist`|<span data-ttu-id="5dc54-108">選擇性。</span><span class="sxs-lookup"><span data-stu-id="5dc54-108">Optional.</span></span> <span data-ttu-id="5dc54-109">套用至此事件的屬性清單。</span><span class="sxs-lookup"><span data-stu-id="5dc54-109">List of attributes that apply to this event.</span></span> <span data-ttu-id="5dc54-110">以逗號分隔多個屬性。</span><span class="sxs-lookup"><span data-stu-id="5dc54-110">Multiple attributes are separated by commas.</span></span> <span data-ttu-id="5dc54-111">您必須將括[屬性清單](../../../visual-basic/language-reference/statements/attribute-list.md)角括弧 ("`<`"和"`>`")。</span><span class="sxs-lookup"><span data-stu-id="5dc54-111">You must enclose the [Attribute List](../../../visual-basic/language-reference/statements/attribute-list.md) in angle brackets ("`<`" and "`>`").</span></span>|  
|`accessmodifier`|<span data-ttu-id="5dc54-112">選擇性。</span><span class="sxs-lookup"><span data-stu-id="5dc54-112">Optional.</span></span> <span data-ttu-id="5dc54-113">指定哪些程式碼可以存取此事件。</span><span class="sxs-lookup"><span data-stu-id="5dc54-113">Specifies what code can access the event.</span></span> <span data-ttu-id="5dc54-114">可以是下列其中一項：</span><span class="sxs-lookup"><span data-stu-id="5dc54-114">Can be one of the following:</span></span><br /><br /> <span data-ttu-id="5dc54-115">-   [公用](../../../visual-basic/language-reference/modifiers/public.md)— 任何可以存取宣告它的項目程式碼可以存取它。</span><span class="sxs-lookup"><span data-stu-id="5dc54-115">-   [Public](../../../visual-basic/language-reference/modifiers/public.md)—any code that can access the element that declares it can access it.</span></span><br /><span data-ttu-id="5dc54-116">-   [受保護的](../../../visual-basic/language-reference/modifiers/protected.md)— 只有在其類別或衍生的類別中的程式碼可以存取它。</span><span class="sxs-lookup"><span data-stu-id="5dc54-116">-   [Protected](../../../visual-basic/language-reference/modifiers/protected.md)—only code within its class or a derived class can access it.</span></span><br /><span data-ttu-id="5dc54-117">-   [Friend](../../../visual-basic/language-reference/modifiers/friend.md)— 只有在相同的組件中的程式碼可以存取它。</span><span class="sxs-lookup"><span data-stu-id="5dc54-117">-   [Friend](../../../visual-basic/language-reference/modifiers/friend.md)—only code in the same assembly can access it.</span></span><br /><span data-ttu-id="5dc54-118">-   [私用](../../../visual-basic/language-reference/modifiers/private.md)— 只有在宣告它的項目中的程式碼可以存取它。</span><span class="sxs-lookup"><span data-stu-id="5dc54-118">-   [Private](../../../visual-basic/language-reference/modifiers/private.md)—only code in the element that declares it can access it.</span></span><br /> <span data-ttu-id="5dc54-119">-   [Protected Friend](../../language-reference/modifiers/protected-friend.md)-只有事件的類別、 衍生的類別或相同組件中的程式碼可以存取它。</span><span class="sxs-lookup"><span data-stu-id="5dc54-119">-   [Protected Friend](../../language-reference/modifiers/protected-friend.md)-only code in the event's class, a derived class, or the same assembly can access it.</span></span> <br /><span data-ttu-id="5dc54-120">- [私用受保護](../../language-reference/modifiers/private-protected.md)-只有在事件的類別或相同組件中的衍生的類別中的程式碼可以存取它。</span><span class="sxs-lookup"><span data-stu-id="5dc54-120">- [Private Protected](../../language-reference/modifiers/private-protected.md)-only code in the event's class or a derived class in the same assembly can access it.</span></span>|  
|`Shared`|<span data-ttu-id="5dc54-121">選擇性。</span><span class="sxs-lookup"><span data-stu-id="5dc54-121">Optional.</span></span> <span data-ttu-id="5dc54-122">指定此事件與類別或結構的特定執行個體不相關。</span><span class="sxs-lookup"><span data-stu-id="5dc54-122">Specifies that this event is not associated with a specific instance of a class or structure.</span></span>|  
|`Shadows`|<span data-ttu-id="5dc54-123">選擇性。</span><span class="sxs-lookup"><span data-stu-id="5dc54-123">Optional.</span></span> <span data-ttu-id="5dc54-124">指出這個事件會在基底類別中重新宣告並隱藏相同名稱的程式設計項目，或一組多載項目。</span><span class="sxs-lookup"><span data-stu-id="5dc54-124">Indicates that this event redeclares and hides an identically named programming element, or set of overloaded elements, in a base class.</span></span> <span data-ttu-id="5dc54-125">您可以使用任何其他類型遮蔽任何一種已宣告的項目。</span><span class="sxs-lookup"><span data-stu-id="5dc54-125">You can shadow any kind of declared element with any other kind.</span></span><br /><br /> <span data-ttu-id="5dc54-126">無法從遮蔽項目的衍生類別內使用遮蔽的項目，除了從無法存取遮蔽項目的位置以外。</span><span class="sxs-lookup"><span data-stu-id="5dc54-126">A shadowed element is unavailable from within the derived class that shadows it, except from where the shadowing element is inaccessible.</span></span> <span data-ttu-id="5dc54-127">例如，如果 `Private` 項目會遮蔽基底類別項目，沒有 `Private` 項目存取權限的程式碼會改為存取基底類別項目。</span><span class="sxs-lookup"><span data-stu-id="5dc54-127">For example, if a `Private` element shadows a base-class element, code that does not have permission to access the `Private` element accesses the base-class element instead.</span></span>|  
|`eventname`|<span data-ttu-id="5dc54-128">必要。</span><span class="sxs-lookup"><span data-stu-id="5dc54-128">Required.</span></span> <span data-ttu-id="5dc54-129">事件的名稱；依照標準變數命名慣例。</span><span class="sxs-lookup"><span data-stu-id="5dc54-129">Name of the event; follows standard variable naming conventions.</span></span>|  
|`parameterlist`|<span data-ttu-id="5dc54-130">選擇性。</span><span class="sxs-lookup"><span data-stu-id="5dc54-130">Optional.</span></span> <span data-ttu-id="5dc54-131">本機變數清單，表示此事件的參數。</span><span class="sxs-lookup"><span data-stu-id="5dc54-131">List of local variables that represent the parameters of this event.</span></span> <span data-ttu-id="5dc54-132">您必須將括[參數清單](../../../visual-basic/language-reference/statements/parameter-list.md)括號括住。</span><span class="sxs-lookup"><span data-stu-id="5dc54-132">You must enclose the [Parameter List](../../../visual-basic/language-reference/statements/parameter-list.md) in parentheses.</span></span>|  
|`Implements`|<span data-ttu-id="5dc54-133">選擇性。</span><span class="sxs-lookup"><span data-stu-id="5dc54-133">Optional.</span></span> <span data-ttu-id="5dc54-134">指出此事件會實作介面的事件。</span><span class="sxs-lookup"><span data-stu-id="5dc54-134">Indicates that this event implements an event of an interface.</span></span>|  
|`implementslist`|<span data-ttu-id="5dc54-135">如果使用 `Implements`，則為必要項。</span><span class="sxs-lookup"><span data-stu-id="5dc54-135">Required if `Implements` is supplied.</span></span> <span data-ttu-id="5dc54-136">實作之 `Sub` 程序的清單。</span><span class="sxs-lookup"><span data-stu-id="5dc54-136">List of `Sub` procedures being implemented.</span></span> <span data-ttu-id="5dc54-137">以逗號分隔多個程序：</span><span class="sxs-lookup"><span data-stu-id="5dc54-137">Multiple procedures are separated by commas:</span></span><br /><br /> <span data-ttu-id="5dc54-138">*implementedprocedure* [， *implementedprocedure* ...]</span><span class="sxs-lookup"><span data-stu-id="5dc54-138">*implementedprocedure* [ , *implementedprocedure* ... ]</span></span><br /><br /> <span data-ttu-id="5dc54-139">每個 `implementedprocedure` 都具有下列語法和組件：</span><span class="sxs-lookup"><span data-stu-id="5dc54-139">Each `implementedprocedure` has the following syntax and parts:</span></span><br /><br /> <span data-ttu-id="5dc54-140">`interface`.`definedname`</span><span class="sxs-lookup"><span data-stu-id="5dc54-140">`interface`.`definedname`</span></span><br /><br /> <span data-ttu-id="5dc54-141">-   `interface` 必要。</span><span class="sxs-lookup"><span data-stu-id="5dc54-141">-   `interface` - Required.</span></span> <span data-ttu-id="5dc54-142">介面名稱，該介面實作包含類別或結構的此程序。</span><span class="sxs-lookup"><span data-stu-id="5dc54-142">Name of an interface that this procedure's containing class or structure is implementing.</span></span><br /><span data-ttu-id="5dc54-143">-   `Definedname` 必要。</span><span class="sxs-lookup"><span data-stu-id="5dc54-143">-   `Definedname` - Required.</span></span> <span data-ttu-id="5dc54-144">名稱，據以在 `interface` 中定義程序。</span><span class="sxs-lookup"><span data-stu-id="5dc54-144">Name by which the procedure is defined in `interface`.</span></span> <span data-ttu-id="5dc54-145">不一定要與 `name` 相同，這是此程序用來實作已定義程序的名稱。</span><span class="sxs-lookup"><span data-stu-id="5dc54-145">This does not have to be the same as `name`, the name that this procedure is using to implement the defined procedure.</span></span>|  
|`Custom`|<span data-ttu-id="5dc54-146">必要。</span><span class="sxs-lookup"><span data-stu-id="5dc54-146">Required.</span></span> <span data-ttu-id="5dc54-147">事件宣告為 `Custom` 必須定義自訂 `AddHandler`、`RemoveHandler` 和 `RaiseEvent` 存取子。</span><span class="sxs-lookup"><span data-stu-id="5dc54-147">Events declared as `Custom` must define custom `AddHandler`, `RemoveHandler`, and `RaiseEvent` accessors.</span></span>|  
|`delegatename`|<span data-ttu-id="5dc54-148">選擇性。</span><span class="sxs-lookup"><span data-stu-id="5dc54-148">Optional.</span></span> <span data-ttu-id="5dc54-149">委派的名稱，指定事件處理常式簽章。</span><span class="sxs-lookup"><span data-stu-id="5dc54-149">The name of a delegate that specifies the event-handler signature.</span></span>|  
|`AddHandler`|<span data-ttu-id="5dc54-150">必要。</span><span class="sxs-lookup"><span data-stu-id="5dc54-150">Required.</span></span> <span data-ttu-id="5dc54-151">宣告 `AddHandler` 存取子，指定加入事件處理常式時要執行的陳述式，可以明確地使用 `AddHandler` 陳述式或隱含地使用 `Handles` 子句。</span><span class="sxs-lookup"><span data-stu-id="5dc54-151">Declares an `AddHandler` accessor, which specifies the statements to execute when an event handler is added, either explicitly by using the `AddHandler` statement or implicitly by using the `Handles` clause.</span></span>|  
|`End AddHandler`|<span data-ttu-id="5dc54-152">必要。</span><span class="sxs-lookup"><span data-stu-id="5dc54-152">Required.</span></span> <span data-ttu-id="5dc54-153">終止 `AddHandler` 區塊。</span><span class="sxs-lookup"><span data-stu-id="5dc54-153">Terminates the `AddHandler` block.</span></span>|  
|`value`|<span data-ttu-id="5dc54-154">必要。</span><span class="sxs-lookup"><span data-stu-id="5dc54-154">Required.</span></span> <span data-ttu-id="5dc54-155">參數名稱。</span><span class="sxs-lookup"><span data-stu-id="5dc54-155">Parameter name.</span></span>|  
|`RemoveHandler`|<span data-ttu-id="5dc54-156">必要。</span><span class="sxs-lookup"><span data-stu-id="5dc54-156">Required.</span></span> <span data-ttu-id="5dc54-157">宣告 `RemoveHandler` 存取子，指定使用 `RemoveHandler` 陳述式移除事件處理常式時要執行的陳述式。</span><span class="sxs-lookup"><span data-stu-id="5dc54-157">Declares a `RemoveHandler` accessor, which specifies the statements to execute when an event handler is removed using the `RemoveHandler` statement.</span></span>|  
|`End RemoveHandler`|<span data-ttu-id="5dc54-158">必要。</span><span class="sxs-lookup"><span data-stu-id="5dc54-158">Required.</span></span> <span data-ttu-id="5dc54-159">終止 `RemoveHandler` 區塊。</span><span class="sxs-lookup"><span data-stu-id="5dc54-159">Terminates the `RemoveHandler` block.</span></span>|  
|`RaiseEvent`|<span data-ttu-id="5dc54-160">必要。</span><span class="sxs-lookup"><span data-stu-id="5dc54-160">Required.</span></span> <span data-ttu-id="5dc54-161">宣告 `RaiseEvent` 存取子，指定使用 `RaiseEvent` 陳述式引發事件處理常式時要執行的陳述式。</span><span class="sxs-lookup"><span data-stu-id="5dc54-161">Declares a `RaiseEvent` accessor, which specifies the statements to execute when the event is raised using the `RaiseEvent` statement.</span></span> <span data-ttu-id="5dc54-162">一般而言，這樣會叫用 `AddHandler` 和 `RemoveHandler` 存取子所維護的委派。</span><span class="sxs-lookup"><span data-stu-id="5dc54-162">Typically, this invokes a list of delegates maintained by the `AddHandler` and `RemoveHandler` accessors.</span></span>|  
|`End RaiseEvent`|<span data-ttu-id="5dc54-163">必要。</span><span class="sxs-lookup"><span data-stu-id="5dc54-163">Required.</span></span> <span data-ttu-id="5dc54-164">終止 `RaiseEvent` 區塊。</span><span class="sxs-lookup"><span data-stu-id="5dc54-164">Terminates the `RaiseEvent` block.</span></span>|  
|`delegatesignature`|<span data-ttu-id="5dc54-165">必要。</span><span class="sxs-lookup"><span data-stu-id="5dc54-165">Required.</span></span> <span data-ttu-id="5dc54-166">參數的清單，符合 `delegatename` 委派所需的參數。</span><span class="sxs-lookup"><span data-stu-id="5dc54-166">List of parameters that matches the parameters required by the `delegatename` delegate.</span></span> <span data-ttu-id="5dc54-167">您必須將括[參數清單](../../../visual-basic/language-reference/statements/parameter-list.md)括號括住。</span><span class="sxs-lookup"><span data-stu-id="5dc54-167">You must enclose the [Parameter List](../../../visual-basic/language-reference/statements/parameter-list.md) in parentheses.</span></span>|  
|`statements`|<span data-ttu-id="5dc54-168">選擇性。</span><span class="sxs-lookup"><span data-stu-id="5dc54-168">Optional.</span></span> <span data-ttu-id="5dc54-169">陳述式，包含 `AddHandler`、`RemoveHandler` 和 `RaiseEvent` 方法的內文。</span><span class="sxs-lookup"><span data-stu-id="5dc54-169">Statements that contain the bodies of the `AddHandler`, `RemoveHandler`, and `RaiseEvent` methods.</span></span>|  
|`End Event`|<span data-ttu-id="5dc54-170">必要。</span><span class="sxs-lookup"><span data-stu-id="5dc54-170">Required.</span></span> <span data-ttu-id="5dc54-171">終止 `Event` 區塊。</span><span class="sxs-lookup"><span data-stu-id="5dc54-171">Terminates the `Event` block.</span></span>|  
  
## <a name="remarks"></a><span data-ttu-id="5dc54-172">備註</span><span class="sxs-lookup"><span data-stu-id="5dc54-172">Remarks</span></span>  
 <span data-ttu-id="5dc54-173">一旦已經宣告事件，使用 `RaiseEvent` 陳述式來引發事件。</span><span class="sxs-lookup"><span data-stu-id="5dc54-173">Once the event has been declared, use the `RaiseEvent` statement to raise the event.</span></span> <span data-ttu-id="5dc54-174">一般事件可能會如下列片段所示宣告和引發：</span><span class="sxs-lookup"><span data-stu-id="5dc54-174">A typical event might be declared and raised as shown in the following fragments:</span></span>  
  
 [!code-vb[VbVbalrEvents#13](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/event-statement_1.vb)]  
  
> [!NOTE]
>  <span data-ttu-id="5dc54-175">您可以宣告事件引數，就像宣告程序的引數一樣，但下列情況除外：事件不可擁有具名引數、`ParamArray` 引數或 `Optional` 引數。</span><span class="sxs-lookup"><span data-stu-id="5dc54-175">You can declare event arguments just as you do arguments of procedures, with the following exceptions: events cannot have named arguments, `ParamArray` arguments, or `Optional` arguments.</span></span> <span data-ttu-id="5dc54-176">事件沒有傳回值。</span><span class="sxs-lookup"><span data-stu-id="5dc54-176">Events do not have return values.</span></span>  
  
 <span data-ttu-id="5dc54-177">若要處理事件，您必須使用 `Handles` 或 `AddHandler` 陳述式，建立它與事件處理常式副程式的關聯。</span><span class="sxs-lookup"><span data-stu-id="5dc54-177">To handle an event, you must associate it with an event handler subroutine using either the `Handles` or `AddHandler` statement.</span></span> <span data-ttu-id="5dc54-178">副程式與事件的簽章必須相符。</span><span class="sxs-lookup"><span data-stu-id="5dc54-178">The signatures of the subroutine and the event must match.</span></span> <span data-ttu-id="5dc54-179">若要處理共用的事件，您必須使用 `AddHandler` 陳述式。</span><span class="sxs-lookup"><span data-stu-id="5dc54-179">To handle a shared event, you must use the `AddHandler` statement.</span></span>  
  
 <span data-ttu-id="5dc54-180">您只能在模組層級使用 `Event`。</span><span class="sxs-lookup"><span data-stu-id="5dc54-180">You can use `Event` only at module level.</span></span> <span data-ttu-id="5dc54-181">這表示*宣告內容*事件必須是類別、 結構、 模組或介面，而且不能是原始程式檔、 命名空間、 程序或區塊。</span><span class="sxs-lookup"><span data-stu-id="5dc54-181">This means the *declaration context* for an event must be a class, structure, module, or interface, and cannot be a source file, namespace, procedure, or block.</span></span> <span data-ttu-id="5dc54-182">如需詳細資訊，請參閱[宣告內容和預設存取層級](../../../visual-basic/language-reference/statements/declaration-contexts-and-default-access-levels.md)。</span><span class="sxs-lookup"><span data-stu-id="5dc54-182">For more information, see [Declaration Contexts and Default Access Levels](../../../visual-basic/language-reference/statements/declaration-contexts-and-default-access-levels.md).</span></span>  
  
 <span data-ttu-id="5dc54-183">在大部分情況下，您可以使用本主題「語法」一節中的第一個語法來宣告事件。</span><span class="sxs-lookup"><span data-stu-id="5dc54-183">In most circumstances, you can use the first syntax in the Syntax section of this topic for declaring events.</span></span> <span data-ttu-id="5dc54-184">不過，某些情況下需要您對詳細事件行為有更多掌控。</span><span class="sxs-lookup"><span data-stu-id="5dc54-184">However, some scenarios require that you have more control over the detailed behavior of the event.</span></span> <span data-ttu-id="5dc54-185">本主題中「語法」一節中的最後一個語法使用 `Custom` 關鍵字，藉由讓您定義自訂事件以提供控制權。</span><span class="sxs-lookup"><span data-stu-id="5dc54-185">The last syntax in the Syntax section of this topic, which uses the `Custom` keyword, provides that control by enabling you to define custom events.</span></span> <span data-ttu-id="5dc54-186">在自訂事件中，您完整指定當程式碼於事件中加入或移除事件處理常式，或是當程式碼引發事件時，會發生什麼情況。</span><span class="sxs-lookup"><span data-stu-id="5dc54-186">In a custom event, you specify exactly what occurs when code adds or removes an event handler to or from the event, or when code raises the event.</span></span> <span data-ttu-id="5dc54-187">如需範例，請參閱[如何： 宣告自訂事件以節省記憶體](../../../visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-conserve-memory.md)並[如何： 宣告自訂事件以避免封鎖](../../../visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-avoid-blocking.md)。</span><span class="sxs-lookup"><span data-stu-id="5dc54-187">For examples, see [How to: Declare Custom Events To Conserve Memory](../../../visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-conserve-memory.md) and [How to: Declare Custom Events To Avoid Blocking](../../../visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-avoid-blocking.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="5dc54-188">範例</span><span class="sxs-lookup"><span data-stu-id="5dc54-188">Example</span></span>  
 <span data-ttu-id="5dc54-189">下列範例會使用事件以從 10 秒到 0 秒倒數計時。</span><span class="sxs-lookup"><span data-stu-id="5dc54-189">The following example uses events to count down seconds from 10 to 0.</span></span> <span data-ttu-id="5dc54-190">程式碼會說明數個事件相關的方法、屬性和陳述式。</span><span class="sxs-lookup"><span data-stu-id="5dc54-190">The code illustrates several of the event-related methods, properties, and statements.</span></span> <span data-ttu-id="5dc54-191">包括 `RaiseEvent` 陳述式。</span><span class="sxs-lookup"><span data-stu-id="5dc54-191">This includes the `RaiseEvent` statement.</span></span>  
  
 <span data-ttu-id="5dc54-192">引發事件的類別是事件來源，處理事件的方法為事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="5dc54-192">The class that raises an event is the event source, and the methods that process the event are the event handlers.</span></span> <span data-ttu-id="5dc54-193">事件來源對於它所產生的事件可以有多個處理常式。</span><span class="sxs-lookup"><span data-stu-id="5dc54-193">An event source can have multiple handlers for the events it generates.</span></span> <span data-ttu-id="5dc54-194">當類別引發事件時，該事件是在每個類別 (已被選擇來處理該物件執行個體的事件) 上引發。</span><span class="sxs-lookup"><span data-stu-id="5dc54-194">When the class raises the event, that event is raised on every class that has elected to handle events for that instance of the object.</span></span>  
  
 <span data-ttu-id="5dc54-195">此範例也會使用表單 (`Form1`) 與按鈕 (`Button1`) 和文字方塊 (`TextBox1`)。</span><span class="sxs-lookup"><span data-stu-id="5dc54-195">The example also uses a form (`Form1`) with a button (`Button1`) and a text box (`TextBox1`).</span></span> <span data-ttu-id="5dc54-196">當您按一下按鈕時時，第一個文字方塊會顯示從 10 秒到 0 秒的倒數計時。</span><span class="sxs-lookup"><span data-stu-id="5dc54-196">When you click the button, the first text box displays a countdown from 10 to 0 seconds.</span></span> <span data-ttu-id="5dc54-197">在經過完整時間 (10 秒) 之後，第一個文字方塊會顯示 [完成]。</span><span class="sxs-lookup"><span data-stu-id="5dc54-197">When the full time (10 seconds) has elapsed, the first text box displays "Done".</span></span>  
  
 <span data-ttu-id="5dc54-198">`Form1` 的程式碼會指定表單的初始和終止狀態。</span><span class="sxs-lookup"><span data-stu-id="5dc54-198">The code for `Form1` specifies the initial and terminal states of the form.</span></span> <span data-ttu-id="5dc54-199">它也包含引發事件時執行的程式碼。</span><span class="sxs-lookup"><span data-stu-id="5dc54-199">It also contains the code executed when events are raised.</span></span>  
  
 <span data-ttu-id="5dc54-200">若要使用此範例，請建立新的 Windows Form 專案。</span><span class="sxs-lookup"><span data-stu-id="5dc54-200">To use this example, open a new Windows Forms project.</span></span> <span data-ttu-id="5dc54-201">然後新增一個名為 `Button1` 的按鈕，和名為 `TextBox1` 的文字方塊到名為 `Form1` 的主表單中。</span><span class="sxs-lookup"><span data-stu-id="5dc54-201">Then add a button named `Button1` and a text box named `TextBox1` to the main form, named `Form1`.</span></span> <span data-ttu-id="5dc54-202">然後以滑鼠右鍵按一下表單，並按一下**檢視程式碼**程式碼編輯器開啟。</span><span class="sxs-lookup"><span data-stu-id="5dc54-202">Then right-click the form and click **View Code** to open the code editor.</span></span>  
  
 <span data-ttu-id="5dc54-203">將 `WithEvents` 變數加入至 `Form1` 類別的宣告區段：</span><span class="sxs-lookup"><span data-stu-id="5dc54-203">Add a `WithEvents` variable to the declarations section of the `Form1` class:</span></span>  
  
 [!code-vb[VbVbalrEvents#14](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/event-statement_2.vb)]  
  
 <span data-ttu-id="5dc54-204">將下列程式碼加入至 `Form1` 的程式碼。</span><span class="sxs-lookup"><span data-stu-id="5dc54-204">Add the following code to the code for `Form1`.</span></span> <span data-ttu-id="5dc54-205">取代可能存在的任何重複程序，例如 `Form_Load` 或 `Button_Click`。</span><span class="sxs-lookup"><span data-stu-id="5dc54-205">Replace any duplicate procedures that may exist, such as `Form_Load` or `Button_Click`.</span></span>  
  
 [!code-vb[VbVbalrEvents#15](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/event-statement_3.vb)]  
  
 <span data-ttu-id="5dc54-206">按 F5 以執行上述範例中，並按一下 [] 按鈕**啟動**。</span><span class="sxs-lookup"><span data-stu-id="5dc54-206">Press F5 to run the previous example, and click the button labeled **Start**.</span></span> <span data-ttu-id="5dc54-207">第一個文字方塊會開始倒數計時。</span><span class="sxs-lookup"><span data-stu-id="5dc54-207">The first text box starts to count down the seconds.</span></span> <span data-ttu-id="5dc54-208">在經過完整時間 (10 秒) 之後，第一個文字方塊會顯示 [完成]。</span><span class="sxs-lookup"><span data-stu-id="5dc54-208">When the full time (10 seconds) has elapsed, the first text box displays "Done".</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5dc54-209">`My.Application.DoEvents` 方法不會以與表單相同的方式處理事件。</span><span class="sxs-lookup"><span data-stu-id="5dc54-209">The `My.Application.DoEvents` method does not process events in the same way the form does.</span></span> <span data-ttu-id="5dc54-210">若要啟用表單以直接處理事件，您可以使用多執行緒。</span><span class="sxs-lookup"><span data-stu-id="5dc54-210">To enable the form to handle the events directly, you can use multithreading.</span></span> <span data-ttu-id="5dc54-211">如需詳細資訊，請參閱 <<c0> [ 執行緒](../../programming-guide/concepts/threading/index.md)。</span><span class="sxs-lookup"><span data-stu-id="5dc54-211">For more information, see [Threading](../../programming-guide/concepts/threading/index.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5dc54-212">另請參閱</span><span class="sxs-lookup"><span data-stu-id="5dc54-212">See Also</span></span>  
 [<span data-ttu-id="5dc54-213">RaiseEvent 陳述式</span><span class="sxs-lookup"><span data-stu-id="5dc54-213">RaiseEvent Statement</span></span>](../../../visual-basic/language-reference/statements/raiseevent-statement.md)  
 [<span data-ttu-id="5dc54-214">Implements 陳述式</span><span class="sxs-lookup"><span data-stu-id="5dc54-214">Implements Statement</span></span>](../../../visual-basic/language-reference/statements/implements-statement.md)  
 [<span data-ttu-id="5dc54-215">事件</span><span class="sxs-lookup"><span data-stu-id="5dc54-215">Events</span></span>](../../../visual-basic/programming-guide/language-features/events/index.md)  
 [<span data-ttu-id="5dc54-216">AddHandler 陳述式</span><span class="sxs-lookup"><span data-stu-id="5dc54-216">AddHandler Statement</span></span>](../../../visual-basic/language-reference/statements/addhandler-statement.md)  
 [<span data-ttu-id="5dc54-217">RemoveHandler 陳述式</span><span class="sxs-lookup"><span data-stu-id="5dc54-217">RemoveHandler Statement</span></span>](../../../visual-basic/language-reference/statements/removehandler-statement.md)  
 [<span data-ttu-id="5dc54-218">Handles</span><span class="sxs-lookup"><span data-stu-id="5dc54-218">Handles</span></span>](../../../visual-basic/language-reference/statements/handles-clause.md)  
 [<span data-ttu-id="5dc54-219">Delegate 陳述式</span><span class="sxs-lookup"><span data-stu-id="5dc54-219">Delegate Statement</span></span>](../../../visual-basic/language-reference/statements/delegate-statement.md)  
 [<span data-ttu-id="5dc54-220">如何：宣告自訂事件以節省記憶體</span><span class="sxs-lookup"><span data-stu-id="5dc54-220">How to: Declare Custom Events To Conserve Memory</span></span>](../../../visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-conserve-memory.md)  
 [<span data-ttu-id="5dc54-221">如何：宣告自訂事件以避免封鎖</span><span class="sxs-lookup"><span data-stu-id="5dc54-221">How to: Declare Custom Events To Avoid Blocking</span></span>](../../../visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-avoid-blocking.md)  
 [<span data-ttu-id="5dc54-222">Shared</span><span class="sxs-lookup"><span data-stu-id="5dc54-222">Shared</span></span>](../../../visual-basic/language-reference/modifiers/shared.md)  
 [<span data-ttu-id="5dc54-223">Shadows</span><span class="sxs-lookup"><span data-stu-id="5dc54-223">Shadows</span></span>](../../../visual-basic/language-reference/modifiers/shadows.md)
