---
title: 使用 WorkflowInvoker 與 WorkflowApplication
ms.date: 03/30/2017
ms.assetid: cd0e583c-a3f9-4fa2-b247-c7b3368c48a7
ms.openlocfilehash: cc315013ce50539eb4b72d26848a99164bb6b2d0
ms.sourcegitcommit: fd8d4587cc26e53f0e27e230d6e27d828ef4306b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/16/2018
ms.locfileid: "49347977"
---
# <a name="using-workflowinvoker-and-workflowapplication"></a><span data-ttu-id="c9d5c-102">使用 WorkflowInvoker 與 WorkflowApplication</span><span class="sxs-lookup"><span data-stu-id="c9d5c-102">Using WorkflowInvoker and WorkflowApplication</span></span>
<span data-ttu-id="c9d5c-103">Windows Workflow Foundation (WF) 提供幾個方法來裝載工作流程。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-103">Windows Workflow Foundation (WF) provides several methods of hosting workflows.</span></span> <span data-ttu-id="c9d5c-104"><xref:System.Activities.WorkflowInvoker> 提供一種簡單方法來叫用工作流程，如同方法呼叫一般，但只能用於不使用持續性的工作流程。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-104"><xref:System.Activities.WorkflowInvoker> provides a simple way for invoking a workflow as if it were a method call and can be used only for workflows that do not use persistence.</span></span> <span data-ttu-id="c9d5c-105"><xref:System.Activities.WorkflowApplication> 提供更豐富的模型，可執行包含生命週期事件通知、執行控制、書籤繼續以及持續性的工作流程。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-105"><xref:System.Activities.WorkflowApplication> provides a richer model for executing workflows that includes notification of lifecycle events, execution control, bookmark resumption, and persistence.</span></span> <span data-ttu-id="c9d5c-106"><xref:System.ServiceModel.Activities.WorkflowServiceHost> 支援傳訊活動，主要搭配工作流程服務使用。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-106"><xref:System.ServiceModel.Activities.WorkflowServiceHost> provides support for messaging activities and is primarily used with workflow services.</span></span> <span data-ttu-id="c9d5c-107">本主題會向您介紹如何使用 <xref:System.Activities.WorkflowInvoker> 和 <xref:System.Activities.WorkflowApplication> 進行工作流程裝載。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-107">This topic introduces you to workflow hosting with <xref:System.Activities.WorkflowInvoker> and <xref:System.Activities.WorkflowApplication>.</span></span> <span data-ttu-id="c9d5c-108">如需有關裝載的工作流程<xref:System.ServiceModel.Activities.WorkflowServiceHost>，請參閱 <<c2> [ 工作流程服務](../../../docs/framework/wcf/feature-details/workflow-services.md)並[裝載工作流程服務概觀](../../../docs/framework/wcf/feature-details/hosting-workflow-services-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-108">For more information about hosting workflows with <xref:System.ServiceModel.Activities.WorkflowServiceHost>, see [Workflow Services](../../../docs/framework/wcf/feature-details/workflow-services.md) and [Hosting Workflow Services Overview](../../../docs/framework/wcf/feature-details/hosting-workflow-services-overview.md).</span></span>  
  
## <a name="using-workflowinvoker"></a><span data-ttu-id="c9d5c-109">使用 WorkflowInvoker</span><span class="sxs-lookup"><span data-stu-id="c9d5c-109">Using WorkflowInvoker</span></span>  
 <span data-ttu-id="c9d5c-110"><xref:System.Activities.WorkflowInvoker>如同方法叫用般，提供執行工作流程的模型。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-110"><xref:System.Activities.WorkflowInvoker> provides a model for executing a workflow as if it were a method call.</span></span> <span data-ttu-id="c9d5c-111">若要使用 <xref:System.Activities.WorkflowInvoker> 叫用工作流程，請呼叫 <xref:System.Activities.WorkflowInvoker.Invoke%2A> 方法，並傳入要叫用之工作流程的工作流程定義。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-111">To invoke a workflow using <xref:System.Activities.WorkflowInvoker>, call the <xref:System.Activities.WorkflowInvoker.Invoke%2A> method and pass in the workflow definition of the workflow to invoke.</span></span> <span data-ttu-id="c9d5c-112">在此範例中，會使用 <xref:System.Activities.Statements.WriteLine> 叫用 <xref:System.Activities.WorkflowInvoker> 活動。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-112">In this example, a <xref:System.Activities.Statements.WriteLine> activity is invoked using <xref:System.Activities.WorkflowInvoker>.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#1](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#1)]  
  
 <span data-ttu-id="c9d5c-113">使用 <xref:System.Activities.WorkflowInvoker> 叫用工作流程時，工作流程會在呼叫執行緒上執行，且 <xref:System.Activities.WorkflowInvoker.Invoke%2A> 方法會封鎖至工作流程完成為止，並包含任何閒置時間。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-113">When a workflow is invoked using <xref:System.Activities.WorkflowInvoker>, the workflow executes on the calling thread and the <xref:System.Activities.WorkflowInvoker.Invoke%2A> method blocks until the workflow is complete, including any idle time.</span></span> <span data-ttu-id="c9d5c-114">若要設定工作流程必須完成的逾時間隔，請使用接受 <xref:System.Activities.WorkflowInvoker.Invoke%2A> 的其中一個 <xref:System.TimeSpan> 多載。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-114">To configure a time-out interval in which the workflow must complete, use one of the <xref:System.Activities.WorkflowInvoker.Invoke%2A> overloads that takes a <xref:System.TimeSpan> parameter.</span></span> <span data-ttu-id="c9d5c-115">在此範例中，會以兩個不同的逾時間隔叫用工作流程兩次。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-115">In this example, a workflow is invoked twice with two different time-out intervals.</span></span> <span data-ttu-id="c9d5c-116">第一個工作流程會完成，但是第二個則不會。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-116">The first workflow complets, but the second does not.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#50](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#50)]  
  
> [!NOTE]
>  <span data-ttu-id="c9d5c-117">只有在超過逾時間隔及工作流程在執行期間變成閒置狀態時，才會擲回 <xref:System.TimeoutException>。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-117">The <xref:System.TimeoutException> is only thrown if the time-out interval elapses and the workflow becomes idle during execution.</span></span> <span data-ttu-id="c9d5c-118">需要比指定的逾時間隔還長的時間才能完成的工作流程，會在工作流程沒有變成閒置狀態時成功完成。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-118">A workflow that takes longer than the specified time-out interval to complete completes successfully if the workflow does not become idle.</span></span>  
  
 <span data-ttu-id="c9d5c-119"><xref:System.Activities.WorkflowInvoker> 也提供叫用方法的非同步版本。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-119"><xref:System.Activities.WorkflowInvoker> also provides asynchronous versions of the invoke method.</span></span> <span data-ttu-id="c9d5c-120">如需詳細資訊，請參閱 <xref:System.Activities.WorkflowInvoker.InvokeAsync%2A> 與 <xref:System.Activities.WorkflowInvoker.BeginInvoke%2A>。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-120">For more information, see <xref:System.Activities.WorkflowInvoker.InvokeAsync%2A> and <xref:System.Activities.WorkflowInvoker.BeginInvoke%2A>.</span></span>  
  
### <a name="setting-input-arguments-of-a-workflow"></a><span data-ttu-id="c9d5c-121">設定工作流程的輸入引數</span><span class="sxs-lookup"><span data-stu-id="c9d5c-121">Setting Input Arguments of a Workflow</span></span>  
 <span data-ttu-id="c9d5c-122">若要將資料傳入工作流程，可以使用以引數名稱做為索引鍵，且對應工作流程輸入引數之輸入參數的字典。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-122">Data can be passed into a workflow using a dictionary of input parameters, keyed by argument name, that map to the input arguments of the workflow.</span></span> <span data-ttu-id="c9d5c-123">在此範例中，會叫用 <xref:System.Activities.Statements.WriteLine> 並使用輸入參數的字典指定其 <xref:System.Activities.Statements.WriteLine.Text%2A> 引數的值。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-123">In this example, a <xref:System.Activities.Statements.WriteLine> is invoked and the value for its <xref:System.Activities.Statements.WriteLine.Text%2A> argument is specified using the dictionary of input parameters.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#3](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#3)]  
  
### <a name="retrieving-output-arguments-of-a-workflow"></a><span data-ttu-id="c9d5c-124">擷取工作流程的輸出引數</span><span class="sxs-lookup"><span data-stu-id="c9d5c-124">Retrieving Output Arguments of a Workflow</span></span>  
 <span data-ttu-id="c9d5c-125">工作流程的輸出引數可以使用從 <xref:System.Activities.WorkflowInvoker.Invoke%2A> 呼叫傳回的輸出字典來取得。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-125">The output parameters of a workflow can be obtained using the outputs dictionary that is returned from the call to <xref:System.Activities.WorkflowInvoker.Invoke%2A>.</span></span> <span data-ttu-id="c9d5c-126">下列範例會叫用由具有兩個輸入引數和兩個輸出引數之單一 `Divide` 活動組成的工作流程。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-126">The following example invokes a workflow consisting of a single `Divide` activity that has two input arguments and two output arguments.</span></span> <span data-ttu-id="c9d5c-127">叫用此工作流程時，系統會傳遞包含每個輸入引數之值 (以引數名稱做為索引鍵) 的 `arguments` 字典。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-127">When the workflow is invoked, the `arguments` dictionary is passed which contains the values for each input argument, keyed by argument name.</span></span> <span data-ttu-id="c9d5c-128">當傳回 `Invoke` 的呼叫時，每個輸出引數都會傳入 `outputs` 字典 (也以引數名稱做為索引鍵)。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-128">When the call to `Invoke` returns, each output argument is returned in the `outputs` dictionary, also keyed by argument name.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#120](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#120)]  
  
 [!code-csharp[CFX_WorkflowInvokerExample#20](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#20)]  
  
 <span data-ttu-id="c9d5c-129">如果此工作流程衍生自 <xref:System.Activities.ActivityWithResult> (例如 `CodeActivity<TResult>` 或 `Activity<TResult>`)，而且除了定義完善的 <xref:System.Activities.Activity%601.Result%2A> 輸出引數以外，還有其他輸出引數，您就必須使用 `Invoke` 的非泛型多載，才能擷取其他引數。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-129">If the workflow derives from <xref:System.Activities.ActivityWithResult>, such as `CodeActivity<TResult>` or `Activity<TResult>`, and there are output arguments in addition to the well-defined <xref:System.Activities.Activity%601.Result%2A> output argument, a non-generic overload of `Invoke` must be used in order to retrieve the additional arguments.</span></span> <span data-ttu-id="c9d5c-130">若要這樣做，傳遞給 `Invoke` 的工作流程定義必須屬於 <xref:System.Activities.Activity> 型別。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-130">To do this, the workflow definition passed into `Invoke` must be of type <xref:System.Activities.Activity>.</span></span> <span data-ttu-id="c9d5c-131">在此範例中，`Divide` 活動會衍生自 `CodeActivity<int>` 但宣告為 <xref:System.Activities.Activity>，以便使用 `Invoke` 的非泛型多載 (傳回引數的字典而非單一傳回值)。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-131">In this example the `Divide` activity derives from `CodeActivity<int>`, but is declared as <xref:System.Activities.Activity> so that a non-generic overload of `Invoke` is used which returns a dictionary of arguments instead of a single return value.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#121](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#121)]  
  
 [!code-csharp[CFX_WorkflowInvokerExample#21](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#21)]  
  
## <a name="using-workflowapplication"></a><span data-ttu-id="c9d5c-132">使用 WorkflowApplication</span><span class="sxs-lookup"><span data-stu-id="c9d5c-132">Using WorkflowApplication</span></span>  
 <span data-ttu-id="c9d5c-133"><xref:System.Activities.WorkflowApplication> 提供一組豐富的工作流程執行個體管理功能。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-133"><xref:System.Activities.WorkflowApplication> provides a rich set of features for workflow instance management.</span></span> <span data-ttu-id="c9d5c-134"><xref:System.Activities.WorkflowApplication> 可做為實際 <xref:System.Activities.Hosting.WorkflowInstance> 的執行緒安全 Proxy (可封裝執行階段)，並提供建立及載入工作流程執行個體、暫停與繼續、終止，以及生命週期事件通知的方法。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-134"><xref:System.Activities.WorkflowApplication> acts as a thread safe proxy to the actual  <xref:System.Activities.Hosting.WorkflowInstance>, which encapsulates the runtime, and provides methods for creating and loading workflow instances, pausing and resuming, terminating, and notification of lifecycle events.</span></span> <span data-ttu-id="c9d5c-135">若要使用 <xref:System.Activities.WorkflowApplication> 執行工作流程，您要建立<xref:System.Activities.WorkflowApplication>、訂閱任何想要的開發週期事件、啟動工作流程，然後等候它完成。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-135">To run a workflow using <xref:System.Activities.WorkflowApplication> you create the <xref:System.Activities.WorkflowApplication>, subscribe to any desired lifecycle events, start the workflow, and then wait for it to finish.</span></span> <span data-ttu-id="c9d5c-136">在此範例中，會建立由 <xref:System.Activities.Statements.WriteLine> 活動組成的工作流程定義，並使用特定的工作流程定義建立 <xref:System.Activities.WorkflowApplication>。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-136">In this example, a workflow definition that consists of a <xref:System.Activities.Statements.WriteLine> activity is created and a <xref:System.Activities.WorkflowApplication> is created using the specified workflow definition.</span></span> <span data-ttu-id="c9d5c-137"><xref:System.Activities.WorkflowApplication.Completed%2A> 會進行處理，如此一來，當工作流程完成時即會通知主機應用程式，會呼叫 <xref:System.Activities.WorkflowApplication.Run%2A> 來開始工作流程，然後主機應用程式會等候工作流程完成。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-137"><xref:System.Activities.WorkflowApplication.Completed%2A> is handled so the host is notified when the workflow completes, the workflow is started with a call to <xref:System.Activities.WorkflowApplication.Run%2A>, and then the host waits for the workflow to complete.</span></span> <span data-ttu-id="c9d5c-138">當工作流程完成時，會設定 <xref:System.Threading.AutoResetEvent>，且主機應用程式可繼續執行，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-138">When the workflow completes, the <xref:System.Threading.AutoResetEvent> is set and the host application can resume execution, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#31](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#31)]  
  
### <a name="workflowapplication-lifecycle-events"></a><span data-ttu-id="c9d5c-139">工作流程應用程式開發週期事件</span><span class="sxs-lookup"><span data-stu-id="c9d5c-139">WorkflowApplication Lifecycle Events</span></span>  
 <span data-ttu-id="c9d5c-140">除了 <xref:System.Activities.WorkflowApplication.Completed%2A> 以外，當卸載工作流程 (<xref:System.Activities.WorkflowApplication.Unloaded%2A>)、中止 (<xref:System.Activities.WorkflowApplication.Aborted%2A>)、變成閒置 (<xref:System.Activities.WorkflowApplication.Idle%2A> 與 <xref:System.Activities.WorkflowApplication.PersistableIdle%2A>) 或發生未處理的例外狀況 (<xref:System.Activities.WorkflowApplication.OnUnhandledException%2A>) 時，也可通知主機作者。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-140">In addition to <xref:System.Activities.WorkflowApplication.Completed%2A>, host authors can be notified when a workflow is unloaded (<xref:System.Activities.WorkflowApplication.Unloaded%2A>), aborted (<xref:System.Activities.WorkflowApplication.Aborted%2A>), becomes idle (<xref:System.Activities.WorkflowApplication.Idle%2A> and <xref:System.Activities.WorkflowApplication.PersistableIdle%2A>), or an unhandled exception occurs (<xref:System.Activities.WorkflowApplication.OnUnhandledException%2A>).</span></span> <span data-ttu-id="c9d5c-141">工作流程應用程式開發人員可處理這些通知，並採取適當行動，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-141">Workflow application developers can handle these notifications and take appropriate action, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#32](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#32)]  
  
### <a name="setting-input-arguments-of-a-workflow"></a><span data-ttu-id="c9d5c-142">設定工作流程的輸入引數</span><span class="sxs-lookup"><span data-stu-id="c9d5c-142">Setting Input Arguments of a Workflow</span></span>  
 <span data-ttu-id="c9d5c-143">與使用 <xref:System.Activities.WorkflowInvoker> 傳入資料的方式相似，當開始工作流程時，可使用參數字典將資料傳入工作流程內。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-143">Data can be passed into a workflow as it is started using a dictionary of parameters, similar to the way data is passed in when using <xref:System.Activities.WorkflowInvoker>.</span></span> <span data-ttu-id="c9d5c-144">字典中的每一項都對應至指定工作流程的輸入引數。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-144">Each item in the dictionary maps to an input argument of the specified workflow.</span></span> <span data-ttu-id="c9d5c-145">在此範例中，會叫用由 <xref:System.Activities.Statements.WriteLine> 活動構成的工作流程，且會使用輸入參數的字典指定其 <xref:System.Activities.Statements.WriteLine.Text%2A> 引數。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-145">In this example, a workflow that consists of a <xref:System.Activities.Statements.WriteLine> activity is invoked and its <xref:System.Activities.Statements.WriteLine.Text%2A> argument is specified using the dictionary of input parameters.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#30](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#30)]  
  
### <a name="retrieving-output-arguments-of-a-workflow"></a><span data-ttu-id="c9d5c-146">擷取工作流程的輸出引數</span><span class="sxs-lookup"><span data-stu-id="c9d5c-146">Retrieving Output Arguments of a Workflow</span></span>  
 <span data-ttu-id="c9d5c-147">當工作流程完成時，可存取 <xref:System.Activities.WorkflowApplication.Completed%2A> 字典來擷取 <xref:System.Activities.WorkflowApplicationCompletedEventArgs.Outputs%2A?displayProperty=nameWithType> 處理常式中的任何輸出引數。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-147">When a workflow completes, any output arguments can be retrieved in the <xref:System.Activities.WorkflowApplication.Completed%2A> handler by accessing the <xref:System.Activities.WorkflowApplicationCompletedEventArgs.Outputs%2A?displayProperty=nameWithType> dictionary.</span></span> <span data-ttu-id="c9d5c-148">下列範例會使用 <xref:System.Activities.WorkflowApplication> 來裝載工作流程。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-148">The following example hosts a workflow using <xref:System.Activities.WorkflowApplication>.</span></span> <span data-ttu-id="c9d5c-149">A<xref:System.Activities.WorkflowApplication>建構執行個體是使用工作流程定義，其中包含單一`DiceRoll`活動。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-149">A <xref:System.Activities.WorkflowApplication> instance is constructed using a workflow definition consisting of a single `DiceRoll` activity.</span></span> <span data-ttu-id="c9d5c-150">`DiceRoll` 活動具有兩個輸出引數，這些引數代表擲骰作業的結果。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-150">The `DiceRoll` activity has two output arguments that represent the results of the dice roll operation.</span></span> <span data-ttu-id="c9d5c-151">工作流程完成時，便會在 <xref:System.Activities.WorkflowApplication.Completed%2A> 處理常式中擷取輸出。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-151">When the workflow completes, the outputs are retrieved in the <xref:System.Activities.WorkflowApplication.Completed%2A> handler.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#130](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#130)]  
  
 [!code-csharp[CFX_WorkflowApplicationExample#21](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#21)]  
  
> [!NOTE]
>  <span data-ttu-id="c9d5c-152"><xref:System.Activities.WorkflowApplication> 與 <xref:System.Activities.WorkflowInvoker> 會採用輸入參數的字典，並傳回 `out` 引數的字典。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-152"><xref:System.Activities.WorkflowApplication> and <xref:System.Activities.WorkflowInvoker> take a dictionary of input arguments and return a dictionary of `out` arguments.</span></span> <span data-ttu-id="c9d5c-153">這些字典參數、屬性與傳回值都屬於型別 `IDictionary<string, object>`。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-153">These dictionary parameters, properties, and return values are of type `IDictionary<string, object>`.</span></span> <span data-ttu-id="c9d5c-154">傳入的字典類別實際執行個體，可以是任何實作 `IDictionary<string, object>` 的類別。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-154">The actual instance of the dictionary class that is passed in can be any class that implements `IDictionary<string, object>`.</span></span> <span data-ttu-id="c9d5c-155">在這些範例中，會使用 `Dictionary<string, object>`。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-155">In these examples, `Dictionary<string, object>` is used.</span></span> <span data-ttu-id="c9d5c-156">如需字典的詳細資訊，請參閱<xref:System.Collections.Generic.IDictionary%602>和<xref:System.Collections.Generic.Dictionary%602>。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-156">For more information about dictionaries, see <xref:System.Collections.Generic.IDictionary%602> and <xref:System.Collections.Generic.Dictionary%602>.</span></span>  
  
### <a name="passing-data-into-a-running-workflow-using-bookmarks"></a><span data-ttu-id="c9d5c-157">使用書籤將資料傳入執行中的工作流程</span><span class="sxs-lookup"><span data-stu-id="c9d5c-157">Passing Data into a Running Workflow Using Bookmarks</span></span>  
 <span data-ttu-id="c9d5c-158">書籤是一種機制，可讓活動被動等候繼續，也可將資料傳遞至執行中的工作流程執行個體。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-158">Bookmarks are the mechanism by which an activity can passively wait to be resumed and are a mechanism for passing data into a running workflow instance.</span></span> <span data-ttu-id="c9d5c-159">如果活動正在等候資料，就可建立 <xref:System.Activities.Bookmark> 並註冊當恢復 <xref:System.Activities.Bookmark> 時要呼叫的回呼方法，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-159">If an activity is waiting for data, it can create a <xref:System.Activities.Bookmark> and register a callback method to be called when the <xref:System.Activities.Bookmark> is resumed, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#15](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#15)]  
  
 <span data-ttu-id="c9d5c-160">執行時，`ReadLine` 活動就會建立 <xref:System.Activities.Bookmark>、註冊回呼，然後等候繼續 <xref:System.Activities.Bookmark>。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-160">When executed, the `ReadLine` activity creates a <xref:System.Activities.Bookmark>, registers a callback, and then waits for the <xref:System.Activities.Bookmark> to be resumed.</span></span> <span data-ttu-id="c9d5c-161">當它繼續時，`ReadLine` 活動會將以 <xref:System.Activities.Bookmark> 傳遞的資料指派至其 <xref:System.Activities.Activity%601.Result%2A> 引數。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-161">When it is resumed, the `ReadLine` activity assigns the data that was passed with the <xref:System.Activities.Bookmark> to its <xref:System.Activities.Activity%601.Result%2A> argument.</span></span> <span data-ttu-id="c9d5c-162">在此範例中，使用 `ReadLine` 活動建立的工作流程可蒐集使用者的名稱，並於主控台視窗中顯示。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-162">In this example, a workflow is created that uses the `ReadLine` activity to gather the user’s name and display it to the console window.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#22](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#22)]  
  
 <span data-ttu-id="c9d5c-163">當執行 `ReadLine` 活動時，它會建立稱為 <xref:System.Activities.Bookmark> 的 `UserName`，然後等候書籤繼續。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-163">When the `ReadLine` activity is executed, it creates a <xref:System.Activities.Bookmark> named `UserName` and then waits for the bookmark to be resumed.</span></span> <span data-ttu-id="c9d5c-164">主機會收集想要的資料，然後繼續 <xref:System.Activities.Bookmark>。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-164">The host collects the desired data and then resumes the <xref:System.Activities.Bookmark>.</span></span> <span data-ttu-id="c9d5c-165">工作流程會繼續、顯示名稱，然後完成。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-165">The workflow resumes, displays the name, and then completes.</span></span>  
  
 <span data-ttu-id="c9d5c-166">主應用程式可以檢查工作流程，以判斷是否有任何作用中的書籤。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-166">The host application can inspect the workflow to determine if there are any active bookmarks.</span></span> <span data-ttu-id="c9d5c-167">若要進行這項處理，它可以呼叫 <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> 執行個體的 <xref:System.Activities.WorkflowApplication> 方法，或是在 <xref:System.Activities.WorkflowApplicationIdleEventArgs> 處理常式中檢查 <xref:System.Activities.WorkflowApplication.Idle%2A>。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-167">It can do this by calling the <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> method of a <xref:System.Activities.WorkflowApplication> instance, or by inspecting the <xref:System.Activities.WorkflowApplicationIdleEventArgs> in the <xref:System.Activities.WorkflowApplication.Idle%2A> handler.</span></span>  
  
 <span data-ttu-id="c9d5c-168">下列程式碼範例與上一個範例很相似，例外之處是先列舉作用中的書籤，然後再繼續書籤。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-168">The following code example is like the previous example except that the active bookmarks are enumerated before the bookmark is resumed.</span></span> <span data-ttu-id="c9d5c-169">系統會啟動工作流程，而且一旦建立 <xref:System.Activities.Bookmark> 並且工作流程處於閒置狀態之後，就會呼叫 <xref:System.Activities.WorkflowApplication.GetBookmarks%2A>。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-169">The workflow is started, and once the <xref:System.Activities.Bookmark> is created and the workflow goes idle, <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> is called.</span></span> <span data-ttu-id="c9d5c-170">當工作流程完成時，主控台就會顯示下列輸出。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-170">When the workflow is completed, the following output is displayed to the console.</span></span>  
  
 <span data-ttu-id="c9d5c-171">**您的姓名為何？**</span><span class="sxs-lookup"><span data-stu-id="c9d5c-171">**What is your name?**</span></span>  
<span data-ttu-id="c9d5c-172">**BookmarkName： 使用者名稱-OwnerDisplayName: ReadLine** </span><span class="sxs-lookup"><span data-stu-id="c9d5c-172">**BookmarkName: UserName - OwnerDisplayName: ReadLine** </span></span>  
<span data-ttu-id="c9d5c-173">**Steve** </span><span class="sxs-lookup"><span data-stu-id="c9d5c-173">**Steve** </span></span>  
<span data-ttu-id="c9d5c-174">**Hello Steve**</span><span class="sxs-lookup"><span data-stu-id="c9d5c-174">**Hello, Steve**</span></span>

[!code-csharp[CFX_WorkflowApplicationExample#14](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#14)]  
  
 <span data-ttu-id="c9d5c-175">下列程式碼範例會檢查傳遞給 <xref:System.Activities.WorkflowApplicationIdleEventArgs> 執行個體之 <xref:System.Activities.WorkflowApplication.Idle%2A> 處理常式的 <xref:System.Activities.WorkflowApplication>。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-175">The following code example inspects the <xref:System.Activities.WorkflowApplicationIdleEventArgs> passed into the <xref:System.Activities.WorkflowApplication.Idle%2A> handler of a <xref:System.Activities.WorkflowApplication> instance.</span></span> <span data-ttu-id="c9d5c-176">在此範例中，處於閒置狀態的工作流程具有一個名為 <xref:System.Activities.Bookmark> 且由名為 `EnterGuess` 之活動所擁有的 `ReadInt`。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-176">In this example the workflow going idle has one <xref:System.Activities.Bookmark> with a name of `EnterGuess`, owned by an activity named `ReadInt`.</span></span> <span data-ttu-id="c9d5c-177">此程式碼範例根據關閉最[如何： 執行工作流程](../../../docs/framework/windows-workflow-foundation/how-to-run-a-workflow.md)，這屬於[入門教學課程](../../../docs/framework/windows-workflow-foundation/getting-started-tutorial.md)。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-177">This code example is based off of [How to: Run a Workflow](../../../docs/framework/windows-workflow-foundation/how-to-run-a-workflow.md), which is part of the [Getting Started Tutorial](../../../docs/framework/windows-workflow-foundation/getting-started-tutorial.md).</span></span> <span data-ttu-id="c9d5c-178">如果該步驟中的 <xref:System.Activities.WorkflowApplication.Idle%2A> 處理常式修改為包含此範例中的程式碼，就會顯示下列輸出。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-178">If the <xref:System.Activities.WorkflowApplication.Idle%2A> handler in that step is modified to contain the code from this example, the following output is displayed.</span></span>  
  
 <span data-ttu-id="c9d5c-179">**BookmarkName: EnterGuess-OwnerDisplayName: ReadInt**</span><span class="sxs-lookup"><span data-stu-id="c9d5c-179">**BookmarkName: EnterGuess - OwnerDisplayName: ReadInt**</span></span>
 
 [!code-csharp[CFX_WorkflowApplicationExample#2](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#2)]  
  
## <a name="summary"></a><span data-ttu-id="c9d5c-180">總結</span><span class="sxs-lookup"><span data-stu-id="c9d5c-180">Summary</span></span>  
 <span data-ttu-id="c9d5c-181"><xref:System.Activities.WorkflowInvoker> 提供叫用工作流程的輕鬆方式，雖然它提供在工作流程之初傳入資料，以及從已完成之工作流程擷取資料的方法，但它並不提供可使用 <xref:System.Activities.WorkflowApplication> 的更複雜案例。</span><span class="sxs-lookup"><span data-stu-id="c9d5c-181"><xref:System.Activities.WorkflowInvoker> provides a lightweight way to invoke workflows, and although it provides methods for passing data in at the start of a workflow and extracting data from a completed workflow, it does not provide for more complex scenarios which is where <xref:System.Activities.WorkflowApplication> can be used.</span></span>
