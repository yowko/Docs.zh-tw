---
title: Winmdexp.exe (Windows 執行階段中繼資料匯出工具)
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Runtime Metadata Export Tool
- Winmdexp.exe
ms.assetid: d2ce0683-343d-403e-bb8d-209186f7a19d
ms.openlocfilehash: 52820b78f6ed7b02e80df66f90a01143b31d9b29
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/15/2020
ms.locfileid: "74447273"
---
# <a name="winmdexpexe-windows-runtime-metadata-export-tool"></a><span data-ttu-id="ced0c-102">Winmdexp.exe (Windows 執行階段中繼資料匯出工具)</span><span class="sxs-lookup"><span data-stu-id="ced0c-102">Winmdexp.exe (Windows Runtime Metadata Export Tool)</span></span>
<span data-ttu-id="ced0c-103">Windows 執行階段中繼資料匯出工具 (Winmdexp.exe) 會將 .NET Framework 模組轉換為包含 Windows 執行階段中繼資料的檔案。</span><span class="sxs-lookup"><span data-stu-id="ced0c-103">The Windows Runtime Metadata Export Tool (Winmdexp.exe) transforms a .NET Framework module into a file that contains Windows Runtime metadata.</span></span> <span data-ttu-id="ced0c-104">雖然 .NET Framework 組件和 Windows 執行階段中繼資料檔案使用相同的實體格式，但是中繼資料資料表的內容有些差異，也就是說，.NET Framework 組件不會自動作為 Windows 執行階段元件使用。</span><span class="sxs-lookup"><span data-stu-id="ced0c-104">Although .NET Framework assemblies and Windows Runtime metadata files use the same physical format, there are differences in the content of the metadata tables, which means that .NET Framework assemblies are not automatically usable as Windows Runtime Components.</span></span> <span data-ttu-id="ced0c-105">將 .NET Framework 模組轉換為 Windows 執行階段元件的程序稱為「匯出」\*\*。</span><span class="sxs-lookup"><span data-stu-id="ced0c-105">The process of turning a .NET Framework module into a Windows Runtime component is referred to as *exporting*.</span></span> <span data-ttu-id="ced0c-106">在 .NET Framework 4.5 和 .NET Framework 4.5.1 中，產生的 Windows 中繼資料 (.winmd) 檔案同時包含中繼資料和實作。</span><span class="sxs-lookup"><span data-stu-id="ced0c-106">In the .NET Framework 4.5 and .NET Framework 4.5.1, the resulting Windows metadata (.winmd) file contains both metadata and implementation.</span></span>  
  
 <span data-ttu-id="ced0c-107">當您使用 [Windows 執行階段元件]\*\*\*\* 範本時 (在 Visual Studio 2013 或 Visual Studio 2012 中位於 C# 和 Visual Basic 的 [Windows 市集]\*\*\*\* 底下)，編譯器目標是 .winmdobj 檔案，而後續建置步驟會呼叫 Winmdexp.exe 將 .winmdobj 檔案匯出到 .winmd 檔案。</span><span class="sxs-lookup"><span data-stu-id="ced0c-107">When you use the **Windows Runtime Component** template, which is located under **Windows Store** for C# and Visual Basic in Visual Studio 2013 or Visual Studio 2012, the compiler target is a .winmdobj file, and a subsequent build step calls Winmdexp.exe to export the .winmdobj file to a .winmd file.</span></span> <span data-ttu-id="ced0c-108">這是建置 Windows 執行階段元件的建議方式。</span><span class="sxs-lookup"><span data-stu-id="ced0c-108">This is the recommended way to build a Windows Runtime component.</span></span> <span data-ttu-id="ced0c-109">如果您想要更充分掌控建置流程，超越 Visual Studio 所提供的範圍，請直接使用 Winmdexp.exe。</span><span class="sxs-lookup"><span data-stu-id="ced0c-109">Use Winmdexp.exe directly when you want more control over the build process than Visual Studio provides.</span></span>  
  
 <span data-ttu-id="ced0c-110">此工具會自動與 Visual Studio 一起安裝。</span><span class="sxs-lookup"><span data-stu-id="ced0c-110">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="ced0c-111">若要執行這項工具，請使用 [Visual Studio 開發人員命令提示字元] (或 Windows 7 中的 [Visual Studio 命令提示字元])。</span><span class="sxs-lookup"><span data-stu-id="ced0c-111">To run the tool, use the Developer Command Prompt for Visual Studio (or the Visual Studio Command Prompt in Windows 7).</span></span> <span data-ttu-id="ced0c-112">如需詳細資訊，請參閱[命令提示字元](developer-command-prompt-for-vs.md)。</span><span class="sxs-lookup"><span data-stu-id="ced0c-112">For more information, see [Command Prompts](developer-command-prompt-for-vs.md).</span></span>  
  
 <span data-ttu-id="ced0c-113">在命令提示字元中，請輸入下列項目：</span><span class="sxs-lookup"><span data-stu-id="ced0c-113">At the command prompt, type the following:</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="ced0c-114">語法</span><span class="sxs-lookup"><span data-stu-id="ced0c-114">Syntax</span></span>  
  
```console  
winmdexp [options] winmdmodule  
```  
  
## <a name="parameters"></a><span data-ttu-id="ced0c-115">參數</span><span class="sxs-lookup"><span data-stu-id="ced0c-115">Parameters</span></span>  
  
|<span data-ttu-id="ced0c-116">引數或選項</span><span class="sxs-lookup"><span data-stu-id="ced0c-116">Argument or option</span></span>|<span data-ttu-id="ced0c-117">描述</span><span class="sxs-lookup"><span data-stu-id="ced0c-117">Description</span></span>|  
|------------------------|-----------------|  
|`winmdmodule`|<span data-ttu-id="ced0c-118">指定要匯出的模組 (.winmdobj)。</span><span class="sxs-lookup"><span data-stu-id="ced0c-118">Specifies the module (.winmdobj) to be exported.</span></span> <span data-ttu-id="ced0c-119">只允許一個模組。</span><span class="sxs-lookup"><span data-stu-id="ced0c-119">Only one module is allowed.</span></span> <span data-ttu-id="ced0c-120">若要建立這個模組，請使用 `/target` 編譯器選項搭配 `winmdobj` 目標。</span><span class="sxs-lookup"><span data-stu-id="ced0c-120">To create this module, use the `/target` compiler option with the `winmdobj` target.</span></span> <span data-ttu-id="ced0c-121">請參閱[目標：溫姆多比（C# 編譯器選項）](../../csharp/language-reference/compiler-options/target-winmdobj-compiler-option.md)或[目標（可視基本）](../../visual-basic/reference/command-line-compiler/target.md)。</span><span class="sxs-lookup"><span data-stu-id="ced0c-121">See [-target:winmdobj (C# Compiler Options)](../../csharp/language-reference/compiler-options/target-winmdobj-compiler-option.md) or [-target (Visual Basic)](../../visual-basic/reference/command-line-compiler/target.md).</span></span>|  
|<span data-ttu-id="ced0c-122">`/docfile:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="ced0c-122">`/docfile:` `docfile`</span></span><br /><br /> <span data-ttu-id="ced0c-123">`/d:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="ced0c-123">`/d:` `docfile`</span></span>|<span data-ttu-id="ced0c-124">指定 Winmdexp.exe 將產生的輸出 XML 文件檔。</span><span class="sxs-lookup"><span data-stu-id="ced0c-124">Specifies the output XML documentation file that Winmdexp.exe will produce.</span></span> <span data-ttu-id="ced0c-125">在 .NET Framework 4.5 中，輸出檔案基本上與輸入 XML 文件檔相同。</span><span class="sxs-lookup"><span data-stu-id="ced0c-125">In the .NET Framework 4.5, the output file is essentially the same as the input XML documentation file.</span></span>|  
|<span data-ttu-id="ced0c-126">`/moduledoc:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="ced0c-126">`/moduledoc:` `docfile`</span></span><br /><br /> <span data-ttu-id="ced0c-127">`/md:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="ced0c-127">`/md:` `docfile`</span></span>|<span data-ttu-id="ced0c-128">指定編譯器使用 `winmdmodule` 所產生的 XML 文件檔名稱。</span><span class="sxs-lookup"><span data-stu-id="ced0c-128">Specifies the name of the XML documentation file that the compiler produced with `winmdmodule`.</span></span>|  
|<span data-ttu-id="ced0c-129">`/modulepdb:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="ced0c-129">`/modulepdb:` `symbolfile`</span></span><br /><br /> <span data-ttu-id="ced0c-130">`/mp:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="ced0c-130">`/mp:` `symbolfile`</span></span>|<span data-ttu-id="ced0c-131">指定式資料庫 (PDB) 檔名稱，該檔案包含 `winmdmodule` 的符號。</span><span class="sxs-lookup"><span data-stu-id="ced0c-131">Specifies the name of the program database (PDB) file that contains symbols for `winmdmodule`.</span></span>|  
|<span data-ttu-id="ced0c-132">`/nowarn:` `warning`</span><span class="sxs-lookup"><span data-stu-id="ced0c-132">`/nowarn:` `warning`</span></span>|<span data-ttu-id="ced0c-133">隱藏指定的警告編號。</span><span class="sxs-lookup"><span data-stu-id="ced0c-133">Suppresses the specified warning number.</span></span> <span data-ttu-id="ced0c-134">對於 *warning*，僅提供錯誤碼的數字部分，不包含前置零。</span><span class="sxs-lookup"><span data-stu-id="ced0c-134">For *warning*, supply only the numeric portion of the error code, without leading zeros.</span></span>|  
|<span data-ttu-id="ced0c-135">`/out:` `file`</span><span class="sxs-lookup"><span data-stu-id="ced0c-135">`/out:` `file`</span></span><br /><br /> <span data-ttu-id="ced0c-136">`/o:` `file`</span><span class="sxs-lookup"><span data-stu-id="ced0c-136">`/o:` `file`</span></span>|<span data-ttu-id="ced0c-137">指定輸出 Windows 中繼資料 (.winmd) 檔的名稱。</span><span class="sxs-lookup"><span data-stu-id="ced0c-137">Specifies the name of the output Windows metadata (.winmd) file.</span></span>|  
|<span data-ttu-id="ced0c-138">`/pdb:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="ced0c-138">`/pdb:` `symbolfile`</span></span><br /><br /> <span data-ttu-id="ced0c-139">`/p:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="ced0c-139">`/p:` `symbolfile`</span></span>|<span data-ttu-id="ced0c-140">指定將包含所匯出 Windows 中繼資料 (.winmd) 檔之符號的輸出程式資料庫 (PDB) 檔 (PDB) 名稱。</span><span class="sxs-lookup"><span data-stu-id="ced0c-140">Specifies the name of the output program database (PDB) file that will contain the symbols for the exported Windows metadata (.winmd) file.</span></span>|  
|<span data-ttu-id="ced0c-141">`/reference:` `winmd`</span><span class="sxs-lookup"><span data-stu-id="ced0c-141">`/reference:` `winmd`</span></span><br /><br /> <span data-ttu-id="ced0c-142">`/r:` `winmd`</span><span class="sxs-lookup"><span data-stu-id="ced0c-142">`/r:` `winmd`</span></span>|<span data-ttu-id="ced0c-143">指定匯出期間參考的中繼資料檔 (.winmd 或組件)。</span><span class="sxs-lookup"><span data-stu-id="ced0c-143">Specifies a metadata file (.winmd or assembly) to reference during export.</span></span> <span data-ttu-id="ced0c-144">如果您使用位於 "\Program Files (x86)\Reference Assemblies\Microsoft\Framework\\.NETCore\v4.5" 的參考組件 (在 32 位元電腦上位於 "\Program Files\\...")，請同時包含 System.Runtime.dll 和 mscorlib.dll 的參考。</span><span class="sxs-lookup"><span data-stu-id="ced0c-144">If you use the reference assemblies in "\Program Files (x86)\Reference Assemblies\Microsoft\Framework\\.NETCore\v4.5" ("\Program Files\\..." on 32-bit computers), include references to both System.Runtime.dll and mscorlib.dll.</span></span>|  
|`/utf8output`|<span data-ttu-id="ced0c-145">指定應該採用 UTF-8 編碼的輸出訊息。</span><span class="sxs-lookup"><span data-stu-id="ced0c-145">Specifies that output messages should be in UTF-8 encoding.</span></span>|  
|`/warnaserror+`|<span data-ttu-id="ced0c-146">指定應該將所有警告視為錯誤。</span><span class="sxs-lookup"><span data-stu-id="ced0c-146">Specifies that all warnings should be treated as errors.</span></span>|  
|<span data-ttu-id="ced0c-147">**@** `responsefile`</span><span class="sxs-lookup"><span data-stu-id="ced0c-147">**@** `responsefile`</span></span>|<span data-ttu-id="ced0c-148">指定包含選項的回應檔 (.rsp) (以及選擇性的 `winmdmodule`)。</span><span class="sxs-lookup"><span data-stu-id="ced0c-148">Specifies a response (.rsp) file that contains options (and optionally `winmdmodule`).</span></span> <span data-ttu-id="ced0c-149">`responsefile` 中的每一行都應該包含單一引數或選項。</span><span class="sxs-lookup"><span data-stu-id="ced0c-149">Each line in `responsefile` should contain a single argument or option.</span></span>|  
  
## <a name="remarks"></a><span data-ttu-id="ced0c-150">備註</span><span class="sxs-lookup"><span data-stu-id="ced0c-150">Remarks</span></span>  
 <span data-ttu-id="ced0c-151">Winmdexp.exe 的設計並不是將任意 .NET Framework 組件轉換成 .winmd 檔案。</span><span class="sxs-lookup"><span data-stu-id="ced0c-151">Winmdexp.exe is not designed to convert an arbitrary .NET Framework assembly to a .winmd file.</span></span> <span data-ttu-id="ced0c-152">它需要的是使用 `/target:winmdobj` 選項編譯的模組，並且適用其他限制。</span><span class="sxs-lookup"><span data-stu-id="ced0c-152">It requires a module that is compiled with the `/target:winmdobj` option, and additional restrictions apply.</span></span> <span data-ttu-id="ced0c-153">這些限制中最重要的是，組件的 API 介面中公開的所有型別都必須是 Windows 執行階段型別。</span><span class="sxs-lookup"><span data-stu-id="ced0c-153">The most important of these restrictions is that all types that are exposed in the API surface of the assembly must be Windows Runtime types.</span></span> <span data-ttu-id="ced0c-154">有關詳細資訊，請參閱文章"在 Windows 運行時元件中聲明類型"部分，這些部分[在 C# 和視覺化基本 中創建 Windows 運行時元件](https://docs.microsoft.com/previous-versions/br230301(v=vs.110))。</span><span class="sxs-lookup"><span data-stu-id="ced0c-154">For more information, see the "Declaring types in Windows Runtime Components" section of the article [Creating Windows Runtime Components in C# and Visual Basic](https://docs.microsoft.com/previous-versions/br230301(v=vs.110)).</span></span>
  
 <span data-ttu-id="ced0c-155">當您編寫 Windows 8.x 應用商店應用或具有 C# 或 Visual Basic 的 Windows 運行時元件時，.NET 框架提供支援，使使用 Windows 運行時的程式設計更加自然。</span><span class="sxs-lookup"><span data-stu-id="ced0c-155">When you write a Windows 8.x Store app or a Windows Runtime component with C# or Visual Basic, the .NET Framework provides support to make programming with the Windows Runtime more natural.</span></span> <span data-ttu-id="ced0c-156">這會在[適用於 Windows 市集應用程式和 Windows 執行階段的 .NET Framework 支援](../../standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md)文章中討論。</span><span class="sxs-lookup"><span data-stu-id="ced0c-156">This is discussed in the article [.NET Framework Support for Windows Store Apps and Windows Runtime](../../standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md).</span></span> <span data-ttu-id="ced0c-157">在過程中，有些常用的 Windows 執行階段型別會對應至 .NET Framework 型別。</span><span class="sxs-lookup"><span data-stu-id="ced0c-157">In the process, some commonly used Windows Runtime types are mapped to .NET Framework types.</span></span> <span data-ttu-id="ced0c-158">Winmdexp.exe 會將這個過程反轉，並產生 API 介面來使用對應的 Windows 執行階段型別。</span><span class="sxs-lookup"><span data-stu-id="ced0c-158">Winmdexp.exe reverses this process and produces an API surface that uses the corresponding Windows Runtime types.</span></span> <span data-ttu-id="ced0c-159">例如，從<xref:System.Collections.Generic.IList%601>介面映射構造的類型到從 Windows 運行時<xref:Windows.Foundation.Collections.IVector%601>介面構造的類型。</span><span class="sxs-lookup"><span data-stu-id="ced0c-159">For example, types that are constructed from the <xref:System.Collections.Generic.IList%601> interface map to types that are constructed from the Windows Runtime <xref:Windows.Foundation.Collections.IVector%601> interface.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ced0c-160">另請參閱</span><span class="sxs-lookup"><span data-stu-id="ced0c-160">See also</span></span>

- [<span data-ttu-id="ced0c-161">適用於 Windows 市集應用程式和 Windows 執行階段的 .NET Framework 支援</span><span class="sxs-lookup"><span data-stu-id="ced0c-161">.NET Framework Support for Windows Store Apps and Windows Runtime</span></span>](../../standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md)
- <span data-ttu-id="ced0c-162">[在 C++ 和 Visual Basic 中建立 Windows 執行階段元件](https://docs.microsoft.com/previous-versions/br230301(v=vs.110))</span><span class="sxs-lookup"><span data-stu-id="ced0c-162">[Creating Windows Runtime Components in C# and Visual Basic](https://docs.microsoft.com/previous-versions/br230301(v=vs.110))</span></span>
- [<span data-ttu-id="ced0c-163">Winmdexp.exe 錯誤訊息</span><span class="sxs-lookup"><span data-stu-id="ced0c-163">Winmdexp.exe Error Messages</span></span>](winmdexp-exe-error-messages.md)
- <span data-ttu-id="ced0c-164">[建置、部署及組態工具 (.NET Framework)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd233108(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="ced0c-164">[Build, Deployment, and Configuration Tools (.NET Framework)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd233108(v=vs.100))</span></span>
