---
title: WPF 圖形轉譯概觀
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- graphics [WPF], rendering
- rendering graphics [WPF]
ms.assetid: 6dec9657-4d8c-4e46-8c54-40fb80008265
ms.openlocfilehash: ea219d653e6f41f9ebeceb8f33803ebb9246d8bb
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/22/2019
ms.locfileid: "69962864"
---
# <a name="wpf-graphics-rendering-overview"></a><span data-ttu-id="b52d5-102">WPF 圖形轉譯概觀</span><span class="sxs-lookup"><span data-stu-id="b52d5-102">WPF Graphics Rendering Overview</span></span>
<span data-ttu-id="b52d5-103">本主題提供 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 視覺圖層的概觀。</span><span class="sxs-lookup"><span data-stu-id="b52d5-103">This topic provides an overview of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] visual layer.</span></span> <span data-ttu-id="b52d5-104">它著重于<xref:System.Windows.Media.Visual>類別的角色, 以便在[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]模型中呈現支援。</span><span class="sxs-lookup"><span data-stu-id="b52d5-104">It focuses on the role of the <xref:System.Windows.Media.Visual> class for rendering support in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] model.</span></span>  

<a name="role_of_visual_object"></a>   
## <a name="role-of-the-visual-object"></a><span data-ttu-id="b52d5-105">視覺物件的角色</span><span class="sxs-lookup"><span data-stu-id="b52d5-105">Role of the Visual Object</span></span>  
 <span data-ttu-id="b52d5-106">類別是每個<xref:System.Windows.FrameworkElement>物件衍生的基本抽象概念。 <xref:System.Windows.Media.Visual></span><span class="sxs-lookup"><span data-stu-id="b52d5-106">The <xref:System.Windows.Media.Visual> class is the basic abstraction from which every <xref:System.Windows.FrameworkElement> object derives.</span></span> <span data-ttu-id="b52d5-107">它也作為在 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中撰寫新控制項的進入點，且在許多方面，可以視為 Win32 應用程式模型中的視窗控制代碼 (HWND)。</span><span class="sxs-lookup"><span data-stu-id="b52d5-107">It also serves as the entry point for writing new controls in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], and in many ways can be thought of as the window handle (HWND) in the Win32 application model.</span></span>  
  
 <span data-ttu-id="b52d5-108">物件是核心[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]物件, 其主要角色是提供轉譯支援。 <xref:System.Windows.Media.Visual></span><span class="sxs-lookup"><span data-stu-id="b52d5-108">The <xref:System.Windows.Media.Visual> object is a core [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] object, whose primary role is to provide rendering support.</span></span> <span data-ttu-id="b52d5-109">使用者介面控制項 (例如<xref:System.Windows.Controls.Button>和<xref:System.Windows.Controls.TextBox>) 會衍生自<xref:System.Windows.Media.Visual>類別, 並使用它來保存其轉譯資料。</span><span class="sxs-lookup"><span data-stu-id="b52d5-109">User interface controls, such as <xref:System.Windows.Controls.Button> and <xref:System.Windows.Controls.TextBox>, derive from the <xref:System.Windows.Media.Visual> class, and use it for persisting their rendering data.</span></span> <span data-ttu-id="b52d5-110"><xref:System.Windows.Media.Visual>物件提供下列支援:</span><span class="sxs-lookup"><span data-stu-id="b52d5-110">The <xref:System.Windows.Media.Visual> object provides support for:</span></span>  
  
- <span data-ttu-id="b52d5-111">輸出顯示:呈現視覺效果的保存、序列化繪製內容。</span><span class="sxs-lookup"><span data-stu-id="b52d5-111">Output display: Rendering the persisted, serialized drawing content of a visual.</span></span>  
  
- <span data-ttu-id="b52d5-112">轉變在視覺效果上執行轉換。</span><span class="sxs-lookup"><span data-stu-id="b52d5-112">Transformations: Performing transformations on a visual.</span></span>  
  
- <span data-ttu-id="b52d5-113">裁剪提供視覺效果的裁剪區域支援。</span><span class="sxs-lookup"><span data-stu-id="b52d5-113">Clipping: Providing clipping region support for a visual.</span></span>  
  
- <span data-ttu-id="b52d5-114">點擊測試:判斷座標或幾何是否包含在視覺效果的範圍內。</span><span class="sxs-lookup"><span data-stu-id="b52d5-114">Hit testing: Determining whether a coordinate or geometry is contained within the bounds of a visual.</span></span>  
  
- <span data-ttu-id="b52d5-115">周框方塊計算:判斷視覺效果的周框。</span><span class="sxs-lookup"><span data-stu-id="b52d5-115">Bounding box calculations: Determining the bounding rectangle of a visual.</span></span>  
  
 <span data-ttu-id="b52d5-116">不過, <xref:System.Windows.Media.Visual>物件不包含對非轉譯功能的支援, 例如:</span><span class="sxs-lookup"><span data-stu-id="b52d5-116">However, the <xref:System.Windows.Media.Visual> object does not include support for non-rendering features, such as:</span></span>  
  
- <span data-ttu-id="b52d5-117">事件處理</span><span class="sxs-lookup"><span data-stu-id="b52d5-117">Event handling</span></span>  
  
- <span data-ttu-id="b52d5-118">配置</span><span class="sxs-lookup"><span data-stu-id="b52d5-118">Layout</span></span>  
  
- <span data-ttu-id="b52d5-119">樣式</span><span class="sxs-lookup"><span data-stu-id="b52d5-119">Styles</span></span>  
  
- <span data-ttu-id="b52d5-120">資料繫結</span><span class="sxs-lookup"><span data-stu-id="b52d5-120">Data binding</span></span>  
  
- <span data-ttu-id="b52d5-121">全球化</span><span class="sxs-lookup"><span data-stu-id="b52d5-121">Globalization</span></span>  
  
 <span data-ttu-id="b52d5-122"><xref:System.Windows.Media.Visual>會公開為必須從中衍生子類別的公用抽象類別。</span><span class="sxs-lookup"><span data-stu-id="b52d5-122"><xref:System.Windows.Media.Visual> is exposed as a public abstract class from which child classes must be derived.</span></span> <span data-ttu-id="b52d5-123">下圖顯示 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中公開之視覺物件的階層。</span><span class="sxs-lookup"><span data-stu-id="b52d5-123">The following illustration shows the hierarchy of the visual objects that are exposed in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
 ![衍生自 Visual 物件之類別的圖表](./media/wpf-graphics-rendering-overview/classes-derived-visual-object.png)    
  
### <a name="drawingvisual-class"></a><span data-ttu-id="b52d5-125">DrawingVisual 類別</span><span class="sxs-lookup"><span data-stu-id="b52d5-125">DrawingVisual Class</span></span>  
 <span data-ttu-id="b52d5-126"><xref:System.Windows.Media.DrawingVisual>是輕量繪圖類別, 可用來呈現圖形、影像或文字。</span><span class="sxs-lookup"><span data-stu-id="b52d5-126">The <xref:System.Windows.Media.DrawingVisual> is a lightweight drawing class that is used to render shapes, images, or text.</span></span> <span data-ttu-id="b52d5-127">此類別之所以被視為輕量型，是因為它不提供版面配置或事件處理，而這會改善其執行階段效能。</span><span class="sxs-lookup"><span data-stu-id="b52d5-127">This class is considered lightweight because it does not provide layout or event handling, which improves its runtime performance.</span></span> <span data-ttu-id="b52d5-128">基於此原因，繪圖適合背景或美工圖案。</span><span class="sxs-lookup"><span data-stu-id="b52d5-128">For this reason, drawings are ideal for backgrounds and clip art.</span></span> <span data-ttu-id="b52d5-129"><xref:System.Windows.Media.DrawingVisual>可以用來建立自訂視覺物件。</span><span class="sxs-lookup"><span data-stu-id="b52d5-129">The <xref:System.Windows.Media.DrawingVisual> can be used to create a custom visual object.</span></span> <span data-ttu-id="b52d5-130">如需詳細資訊，請參閱[使用 DrawingVisual 物件](using-drawingvisual-objects.md)。</span><span class="sxs-lookup"><span data-stu-id="b52d5-130">For more information, see [Using DrawingVisual Objects](using-drawingvisual-objects.md).</span></span>  
  
### <a name="viewport3dvisual-class"></a><span data-ttu-id="b52d5-131">Viewport3DVisual 類別</span><span class="sxs-lookup"><span data-stu-id="b52d5-131">Viewport3DVisual Class</span></span>  
 <span data-ttu-id="b52d5-132">提供 2d <xref:System.Windows.Media.Visual> 和<xref:System.Windows.Media.Media3D.Visual3D>物件之間的橋樑。 <xref:System.Windows.Media.Media3D.Viewport3DVisual></span><span class="sxs-lookup"><span data-stu-id="b52d5-132">The <xref:System.Windows.Media.Media3D.Viewport3DVisual> provides a bridge between 2D <xref:System.Windows.Media.Visual> and <xref:System.Windows.Media.Media3D.Visual3D> objects.</span></span> <span data-ttu-id="b52d5-133"><xref:System.Windows.Media.Media3D.Visual3D>類別是所有3d 視覺元素的基類。</span><span class="sxs-lookup"><span data-stu-id="b52d5-133">The <xref:System.Windows.Media.Media3D.Visual3D> class is the base class for all 3D visual elements.</span></span> <span data-ttu-id="b52d5-134">需要您定義值和<xref:System.Windows.Media.Media3D.Viewport3DVisual.Viewport%2A>值。 <xref:System.Windows.Media.Media3D.Viewport3DVisual.Camera%2A> <xref:System.Windows.Media.Media3D.Viewport3DVisual></span><span class="sxs-lookup"><span data-stu-id="b52d5-134">The <xref:System.Windows.Media.Media3D.Viewport3DVisual> requires that you define a <xref:System.Windows.Media.Media3D.Viewport3DVisual.Camera%2A> value and a <xref:System.Windows.Media.Media3D.Viewport3DVisual.Viewport%2A> value.</span></span> <span data-ttu-id="b52d5-135">相機可讓您檢視場景。</span><span class="sxs-lookup"><span data-stu-id="b52d5-135">The camera allows you to view the scene.</span></span> <span data-ttu-id="b52d5-136">檢視區會建立投影到 2D 平面上的對應位置。</span><span class="sxs-lookup"><span data-stu-id="b52d5-136">The viewport establishes where the projection maps onto the 2D surface.</span></span> <span data-ttu-id="b52d5-137">如需 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中 3D 的詳細資訊，請參閱 [3D 圖形概觀](3-d-graphics-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="b52d5-137">For more information on 3D in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [3-D Graphics Overview](3-d-graphics-overview.md).</span></span>  
  
### <a name="containervisual-class"></a><span data-ttu-id="b52d5-138">ContainerVisual 類別</span><span class="sxs-lookup"><span data-stu-id="b52d5-138">ContainerVisual Class</span></span>  
 <span data-ttu-id="b52d5-139">類別會當做<xref:System.Windows.Media.Visual>物件集合的容器使用。 <xref:System.Windows.Media.ContainerVisual></span><span class="sxs-lookup"><span data-stu-id="b52d5-139">The <xref:System.Windows.Media.ContainerVisual> class is used as a container for a collection of <xref:System.Windows.Media.Visual> objects.</span></span> <span data-ttu-id="b52d5-140"><xref:System.Windows.Media.DrawingVisual>類別衍生<xref:System.Windows.Media.ContainerVisual>自類別, 讓它包含視覺物件的集合。</span><span class="sxs-lookup"><span data-stu-id="b52d5-140">The <xref:System.Windows.Media.DrawingVisual> class derives from the <xref:System.Windows.Media.ContainerVisual> class, allowing it to contain a collection of visual objects.</span></span>  
  
### <a name="drawing-content-in-visual-objects"></a><span data-ttu-id="b52d5-141">視覺物件中的繪圖內容</span><span class="sxs-lookup"><span data-stu-id="b52d5-141">Drawing Content in Visual Objects</span></span>  
 <span data-ttu-id="b52d5-142">物件<xref:System.Windows.Media.Visual>會將其轉譯資料儲存為**向量圖形指示清單**。</span><span class="sxs-lookup"><span data-stu-id="b52d5-142">A <xref:System.Windows.Media.Visual> object stores its render data as a **vector graphics instruction list**.</span></span> <span data-ttu-id="b52d5-143">指示清單中的每個項目代表一組低階圖形資料和相關聯的序列化格式的資源。</span><span class="sxs-lookup"><span data-stu-id="b52d5-143">Each item in the instruction list represents a low-level set of graphics data and associated resources in a serialized format.</span></span> <span data-ttu-id="b52d5-144">可包含繪圖內容的轉譯資料有四種不同的類型。</span><span class="sxs-lookup"><span data-stu-id="b52d5-144">There are four different types of render data that can contain drawing content.</span></span>  
  
|<span data-ttu-id="b52d5-145">繪圖內容類型</span><span class="sxs-lookup"><span data-stu-id="b52d5-145">Drawing content type</span></span>|<span data-ttu-id="b52d5-146">描述</span><span class="sxs-lookup"><span data-stu-id="b52d5-146">Description</span></span>|  
|--------------------------|-----------------|  
|<span data-ttu-id="b52d5-147">向量圖形</span><span class="sxs-lookup"><span data-stu-id="b52d5-147">Vector graphics</span></span>|<span data-ttu-id="b52d5-148">表示向量圖形資料, 以及任何相關<xref:System.Windows.Media.Brush>聯<xref:System.Windows.Media.Pen>的和資訊。</span><span class="sxs-lookup"><span data-stu-id="b52d5-148">Represents vector graphics data, and any associated <xref:System.Windows.Media.Brush> and <xref:System.Windows.Media.Pen> information.</span></span>|  
|<span data-ttu-id="b52d5-149">Image</span><span class="sxs-lookup"><span data-stu-id="b52d5-149">Image</span></span>|<span data-ttu-id="b52d5-150">表示在所<xref:System.Windows.Rect>定義的區域內的影像。</span><span class="sxs-lookup"><span data-stu-id="b52d5-150">Represents an image within a region defined by a <xref:System.Windows.Rect>.</span></span>|  
|<span data-ttu-id="b52d5-151">圖像</span><span class="sxs-lookup"><span data-stu-id="b52d5-151">Glyph</span></span>|<span data-ttu-id="b52d5-152">表示呈現<xref:System.Windows.Media.GlyphRun>的繪圖, 這是來自指定之字型資源的字元序列。</span><span class="sxs-lookup"><span data-stu-id="b52d5-152">Represents a drawing that renders a <xref:System.Windows.Media.GlyphRun>, which is a sequence of glyphs from a specified font resource.</span></span> <span data-ttu-id="b52d5-153">這是文字的表現方式。</span><span class="sxs-lookup"><span data-stu-id="b52d5-153">This is how text is represented.</span></span>|  
|<span data-ttu-id="b52d5-154">視訊</span><span class="sxs-lookup"><span data-stu-id="b52d5-154">Video</span></span>|<span data-ttu-id="b52d5-155">代表轉譯視訊的繪圖。</span><span class="sxs-lookup"><span data-stu-id="b52d5-155">Represents a drawing that renders video.</span></span>|  
  
 <span data-ttu-id="b52d5-156">可讓您以視覺內容<xref:System.Windows.Media.Visual>填入。 <xref:System.Windows.Media.DrawingContext></span><span class="sxs-lookup"><span data-stu-id="b52d5-156">The <xref:System.Windows.Media.DrawingContext> allows you to populate a <xref:System.Windows.Media.Visual> with visual content.</span></span> <span data-ttu-id="b52d5-157">當您使用<xref:System.Windows.Media.DrawingContext>物件的繪製命令時, 實際上是儲存一組轉譯資料, 稍後會供圖形系統使用, 而不是即時繪製到螢幕上。</span><span class="sxs-lookup"><span data-stu-id="b52d5-157">When you use a <xref:System.Windows.Media.DrawingContext> object's draw commands, you are actually storing a set of render data that will later be used by the graphics system; you are not drawing to the screen in real-time.</span></span>  
  
 <span data-ttu-id="b52d5-158">當您建立[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]控制項 (例如<xref:System.Windows.Controls.Button>) 時, 控制項會隱含地產生繪製本身的轉譯資料。</span><span class="sxs-lookup"><span data-stu-id="b52d5-158">When you create a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] control, such as a <xref:System.Windows.Controls.Button>, the control implicitly generates render data for drawing itself.</span></span> <span data-ttu-id="b52d5-159">例如, 設定<xref:System.Windows.Controls.ContentControl.Content%2A>的屬性<xref:System.Windows.Controls.Button>會導致控制項儲存圖像的呈現表示。</span><span class="sxs-lookup"><span data-stu-id="b52d5-159">For example, setting the <xref:System.Windows.Controls.ContentControl.Content%2A> property of the <xref:System.Windows.Controls.Button> causes the control to store a rendering representation of a glyph.</span></span>  
  
 <span data-ttu-id="b52d5-160">會<xref:System.Windows.Media.Visual>將其內容描述為包含在<xref:System.Windows.Media.Drawing>中的<xref:System.Windows.Media.DrawingGroup>一或多個物件。</span><span class="sxs-lookup"><span data-stu-id="b52d5-160">A <xref:System.Windows.Media.Visual> describes its content as one or more <xref:System.Windows.Media.Drawing> objects contained within a <xref:System.Windows.Media.DrawingGroup>.</span></span> <span data-ttu-id="b52d5-161"><xref:System.Windows.Media.DrawingGroup>也會描述不透明度遮罩、轉換、點陣圖效果, 以及套用至其內容的其他作業。</span><span class="sxs-lookup"><span data-stu-id="b52d5-161">A <xref:System.Windows.Media.DrawingGroup> also describes opacity masks, transforms, bitmap effects, and other operations that are applied to its contents.</span></span> <span data-ttu-id="b52d5-162"><xref:System.Windows.Media.DrawingGroup>轉譯內容時, 會以下列順序套用作業: <xref:System.Windows.Media.DrawingGroup.OpacityMask%2A>、 <xref:System.Windows.Media.DrawingGroup.BitmapEffect%2A> <xref:System.Windows.Media.DrawingGroup.ClipGeometry%2A> <xref:System.Windows.Media.DrawingGroup.Opacity%2A>、、、 <xref:System.Windows.Media.DrawingGroup.GuidelineSet%2A>和<xref:System.Windows.Media.DrawingGroup.Transform%2A>。</span><span class="sxs-lookup"><span data-stu-id="b52d5-162"><xref:System.Windows.Media.DrawingGroup> operations are applied in the following order when content is rendered: <xref:System.Windows.Media.DrawingGroup.OpacityMask%2A>, <xref:System.Windows.Media.DrawingGroup.Opacity%2A>, <xref:System.Windows.Media.DrawingGroup.BitmapEffect%2A>, <xref:System.Windows.Media.DrawingGroup.ClipGeometry%2A>, <xref:System.Windows.Media.DrawingGroup.GuidelineSet%2A>, and then <xref:System.Windows.Media.DrawingGroup.Transform%2A>.</span></span>  
  
 <span data-ttu-id="b52d5-163">下圖顯示在轉譯順序期間套用<xref:System.Windows.Media.DrawingGroup>作業的順序。</span><span class="sxs-lookup"><span data-stu-id="b52d5-163">The following illustration shows the order in which <xref:System.Windows.Media.DrawingGroup> operations are applied during the rendering sequence.</span></span>  
  
 <span data-ttu-id="b52d5-164">![作業的 DrawingGroup 順序](./media/graphcismm-drawinggroup-order.png "graphcismm_drawinggroup_order")</span><span class="sxs-lookup"><span data-stu-id="b52d5-164">![DrawingGroup order of operations](./media/graphcismm-drawinggroup-order.png "graphcismm_drawinggroup_order")</span></span>  
<span data-ttu-id="b52d5-165">DrawingGroup 作業的順序</span><span class="sxs-lookup"><span data-stu-id="b52d5-165">Order of DrawingGroup operations</span></span>  
  
 <span data-ttu-id="b52d5-166">如需詳細資訊，請參閱[繪製物件概觀](drawing-objects-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="b52d5-166">For more information, see [Drawing Objects Overview](drawing-objects-overview.md).</span></span>  
  
#### <a name="drawing-content-at-the-visual-layer"></a><span data-ttu-id="b52d5-167">視覺圖層的繪圖內容</span><span class="sxs-lookup"><span data-stu-id="b52d5-167">Drawing Content at the Visual Layer</span></span>  
 <span data-ttu-id="b52d5-168">您永遠不會直接<xref:System.Windows.Media.DrawingContext>具現化; 不過, 您可以從特定方法 ( <xref:System.Windows.Media.DrawingGroup.Open%2A?displayProperty=nameWithType>例如和<xref:System.Windows.Media.DrawingVisual.RenderOpen%2A?displayProperty=nameWithType>) 取得繪圖內容。</span><span class="sxs-lookup"><span data-stu-id="b52d5-168">You never directly instantiate a <xref:System.Windows.Media.DrawingContext>; you can, however, acquire a drawing context from certain methods, such as <xref:System.Windows.Media.DrawingGroup.Open%2A?displayProperty=nameWithType> and <xref:System.Windows.Media.DrawingVisual.RenderOpen%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="b52d5-169">下列範例會<xref:System.Windows.Media.DrawingContext> <xref:System.Windows.Media.DrawingVisual>從捕獲, 並使用它來繪製矩形。</span><span class="sxs-lookup"><span data-stu-id="b52d5-169">The following example retrieves a <xref:System.Windows.Media.DrawingContext> from a <xref:System.Windows.Media.DrawingVisual> and uses it to draw a rectangle.</span></span>  
  
 [!code-csharp[drawingvisualsample#101](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingVisualSample/CSharp/Window1.xaml.cs#101)]
 [!code-vb[drawingvisualsample#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DrawingVisualSample/visualbasic/window1.xaml.vb#101)]  
  
#### <a name="enumerating-drawing-content-at-the-visual-layer"></a><span data-ttu-id="b52d5-170">列舉視覺圖層的繪圖內容</span><span class="sxs-lookup"><span data-stu-id="b52d5-170">Enumerating Drawing Content at the Visual Layer</span></span>  
 <span data-ttu-id="b52d5-171">除了其他用法以外, <xref:System.Windows.Media.Drawing>物件也會提供物件模型來列舉的內容。 <xref:System.Windows.Media.Visual></span><span class="sxs-lookup"><span data-stu-id="b52d5-171">In addition to their other uses, <xref:System.Windows.Media.Drawing> objects also provide an object model for enumerating the contents of a <xref:System.Windows.Media.Visual>.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="b52d5-172">當您列舉視覺效果的內容時, 您會抓取<xref:System.Windows.Media.Drawing>物件, 而不是以向量圖形指示清單的形式呈現資料的基礎標記法。</span><span class="sxs-lookup"><span data-stu-id="b52d5-172">When you are enumerating the contents of the visual, you are retrieving <xref:System.Windows.Media.Drawing> objects, and not the underlying representation of the render data as a vector graphics instruction list.</span></span>  
  
 <span data-ttu-id="b52d5-173">下列範例會使用<xref:System.Windows.Media.VisualTreeHelper.GetDrawing%2A>方法來<xref:System.Windows.Media.DrawingGroup>取出的值<xref:System.Windows.Media.Visual> , 並加以列舉。</span><span class="sxs-lookup"><span data-stu-id="b52d5-173">The following example uses the <xref:System.Windows.Media.VisualTreeHelper.GetDrawing%2A> method to retrieve the <xref:System.Windows.Media.DrawingGroup> value of a <xref:System.Windows.Media.Visual> and enumerate it.</span></span>  
  
 [!code-csharp[DrawingMiscSnippets_snip#GraphicsMMRetrieveDrawings](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingMiscSnippets_snip/CSharp/EnumerateDrawingsExample.xaml.cs#graphicsmmretrievedrawings)]  
  
<a name="how_visual_objects_are_used_to_build_controls"></a>   
## <a name="how-visual-objects-are-used-to-build-controls"></a><span data-ttu-id="b52d5-174">視覺物件如何用來建置控制項</span><span class="sxs-lookup"><span data-stu-id="b52d5-174">How Visual Objects are Used to Build Controls</span></span>  
 <span data-ttu-id="b52d5-175">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中的許多物件是由其他視覺物件所組成，這表示它們可以包含不同的子系物件階層。</span><span class="sxs-lookup"><span data-stu-id="b52d5-175">Many of the objects in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are composed of other visual objects, meaning they can contain varying hierarchies of descendant objects.</span></span> <span data-ttu-id="b52d5-176">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中的許多使用者介面元素 (例如控制項) 是由多個視覺物件所組成，代表不同類型的轉譯元素。</span><span class="sxs-lookup"><span data-stu-id="b52d5-176">Many of the user interface elements in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], such as controls, are composed of multiple visual objects, representing different types of rendering elements.</span></span> <span data-ttu-id="b52d5-177">例如, <xref:System.Windows.Controls.Button>控制項可以包含一些其他物件, 包括<xref:Microsoft.Windows.Themes.ClassicBorderDecorator>、 <xref:System.Windows.Controls.ContentPresenter>和<xref:System.Windows.Controls.TextBlock>。</span><span class="sxs-lookup"><span data-stu-id="b52d5-177">For example, the <xref:System.Windows.Controls.Button> control can contain a number of other objects, including <xref:Microsoft.Windows.Themes.ClassicBorderDecorator>, <xref:System.Windows.Controls.ContentPresenter>, and <xref:System.Windows.Controls.TextBlock>.</span></span>  
  
 <span data-ttu-id="b52d5-178">下列程式碼顯示在<xref:System.Windows.Controls.Button>標記中定義的控制項。</span><span class="sxs-lookup"><span data-stu-id="b52d5-178">The following code shows a <xref:System.Windows.Controls.Button> control defined in markup.</span></span>  
  
 [!code-xaml[VisualsOverview#VisualsOverviewSnippet1](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml#visualsoverviewsnippet1)]  
  
 <span data-ttu-id="b52d5-179">如果您要列舉組成預設<xref:System.Windows.Controls.Button>控制項的視覺物件, 您會找到視覺物件的階層架構, 如下所示:</span><span class="sxs-lookup"><span data-stu-id="b52d5-179">If you were to enumerate the visual objects that comprise the default <xref:System.Windows.Controls.Button> control, you would find the hierarchy of visual objects illustrated below:</span></span>  
  
 ![視覺化樹狀階層架構的圖表](./media/wpf-graphics-rendering-overview/visual-object-diagram.gif) 
  
 <span data-ttu-id="b52d5-181">控制項包含專案, 而專案則包含<xref:System.Windows.Controls.ContentPresenter>元素。 <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> <xref:System.Windows.Controls.Button></span><span class="sxs-lookup"><span data-stu-id="b52d5-181">The <xref:System.Windows.Controls.Button> control contains a <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> element, which in turn, contains a <xref:System.Windows.Controls.ContentPresenter> element.</span></span> <span data-ttu-id="b52d5-182">元素負責繪製的框線和背景<xref:System.Windows.Controls.Button>。 <xref:Microsoft.Windows.Themes.ClassicBorderDecorator></span><span class="sxs-lookup"><span data-stu-id="b52d5-182">The <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> element is responsible for drawing a border and a background for the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="b52d5-183">元素負責顯示的內容<xref:System.Windows.Controls.Button>。 <xref:System.Windows.Controls.ContentPresenter></span><span class="sxs-lookup"><span data-stu-id="b52d5-183">The <xref:System.Windows.Controls.ContentPresenter> element is responsible for displaying the contents of the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="b52d5-184">在此情況下, 因為您要顯示文字, <xref:System.Windows.Controls.ContentPresenter>元素會<xref:System.Windows.Controls.TextBlock>包含元素。</span><span class="sxs-lookup"><span data-stu-id="b52d5-184">In this case, since you are displaying text, the <xref:System.Windows.Controls.ContentPresenter> element contains a <xref:System.Windows.Controls.TextBlock> element.</span></span> <span data-ttu-id="b52d5-185">控制項使用的意思是<xref:System.Windows.Controls.ContentPresenter> , 內容可能會由其他<xref:System.Windows.Controls.Image>元素 (例如或幾何) <xref:System.Windows.Media.EllipseGeometry>表示, 例如。 <xref:System.Windows.Controls.Button></span><span class="sxs-lookup"><span data-stu-id="b52d5-185">The fact that the <xref:System.Windows.Controls.Button> control uses a <xref:System.Windows.Controls.ContentPresenter> means that the content could be represented by other elements, such as an <xref:System.Windows.Controls.Image> or a geometry, such as an <xref:System.Windows.Media.EllipseGeometry>.</span></span>  
  
### <a name="control-templates"></a><span data-ttu-id="b52d5-186">控制項範本</span><span class="sxs-lookup"><span data-stu-id="b52d5-186">Control Templates</span></span>  
 <span data-ttu-id="b52d5-187">將控制項展開為控制項階層的關鍵在於<xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="b52d5-187">The key to the expansion of a control into a hierarchy of controls is the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="b52d5-188">控制項範本會指定控制項的預設視覺階層。</span><span class="sxs-lookup"><span data-stu-id="b52d5-188">A control template specifies the default visual hierarchy for a control.</span></span> <span data-ttu-id="b52d5-189">當您明確地參考控制項時，您會以隱含方式參考其視覺階層。</span><span class="sxs-lookup"><span data-stu-id="b52d5-189">When you explicitly reference a control, you implicitly reference its visual hierarchy.</span></span> <span data-ttu-id="b52d5-190">您可以覆寫控制項範本的預設值，以針對控制項建立自訂視覺外觀。</span><span class="sxs-lookup"><span data-stu-id="b52d5-190">You can override the default values for a control template to create a customized visual appearance for a control.</span></span> <span data-ttu-id="b52d5-191">例如, 您可以修改<xref:System.Windows.Controls.Button>控制項的背景色彩值, 使其使用線性漸層色彩值, 而不是純色值。</span><span class="sxs-lookup"><span data-stu-id="b52d5-191">For example, you could modify the background color value of the <xref:System.Windows.Controls.Button> control so that it uses a linear gradient color value instead of a solid color value.</span></span> <span data-ttu-id="b52d5-192">如需詳細資訊，請參閱[按鈕樣式和範本](../controls/button-styles-and-templates.md)。</span><span class="sxs-lookup"><span data-stu-id="b52d5-192">For more information, see [Button Styles and Templates](../controls/button-styles-and-templates.md).</span></span>  
  
 <span data-ttu-id="b52d5-193">使用者介面專案 (例如<xref:System.Windows.Controls.Button>控制項) 包含數個向量圖形指示清單, 描述控制項的整個呈現定義。</span><span class="sxs-lookup"><span data-stu-id="b52d5-193">A user interface element, such as a <xref:System.Windows.Controls.Button> control, contains several vector graphics instruction lists that describe the entire rendering definition of a control.</span></span> <span data-ttu-id="b52d5-194">下列程式碼顯示在<xref:System.Windows.Controls.Button>標記中定義的控制項。</span><span class="sxs-lookup"><span data-stu-id="b52d5-194">The following code shows a <xref:System.Windows.Controls.Button> control defined in markup.</span></span>  
  
 [!code-xaml[VisualsOverview#VisualsOverviewSnippet2](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml#visualsoverviewsnippet2)]  
  
 <span data-ttu-id="b52d5-195">如果您要列舉組成<xref:System.Windows.Controls.Button>控制項的視覺物件和向量圖形指示清單, 您會發現物件的階層, 如下所示:</span><span class="sxs-lookup"><span data-stu-id="b52d5-195">If you were to enumerate the visual objects and vector graphics instruction lists that comprise the <xref:System.Windows.Controls.Button> control, you would find the hierarchy of objects illustrated below:</span></span>  
  
 ![視覺化樹狀結構和轉譯資料的圖表](./media/wpf-graphics-rendering-overview/visual-tree-rendering-data.png)  
  
 <span data-ttu-id="b52d5-197">控制項包含專案, 而專案則包含<xref:System.Windows.Controls.ContentPresenter>元素。 <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> <xref:System.Windows.Controls.Button></span><span class="sxs-lookup"><span data-stu-id="b52d5-197">The <xref:System.Windows.Controls.Button> control contains a <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> element, which in turn, contains a <xref:System.Windows.Controls.ContentPresenter> element.</span></span> <span data-ttu-id="b52d5-198"><xref:Microsoft.Windows.Themes.ClassicBorderDecorator>元素負責繪製組成按鈕框線和背景的所有離散圖形元素。</span><span class="sxs-lookup"><span data-stu-id="b52d5-198">The <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> element is responsible for drawing all the discrete graphic elements that make up the border and background of a button.</span></span> <span data-ttu-id="b52d5-199">元素負責顯示的內容<xref:System.Windows.Controls.Button>。 <xref:System.Windows.Controls.ContentPresenter></span><span class="sxs-lookup"><span data-stu-id="b52d5-199">The <xref:System.Windows.Controls.ContentPresenter> element is responsible for displaying the contents of the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="b52d5-200">在此情況下, 由於您要顯示影像, <xref:System.Windows.Controls.ContentPresenter>因此元素會<xref:System.Windows.Controls.Image>包含元素。</span><span class="sxs-lookup"><span data-stu-id="b52d5-200">In this case, since you are displaying an image, the <xref:System.Windows.Controls.ContentPresenter> element contains a <xref:System.Windows.Controls.Image> element.</span></span>  
  
 <span data-ttu-id="b52d5-201">關於視覺物件的階層和向量圖形指示清單，有幾點需要注意：</span><span class="sxs-lookup"><span data-stu-id="b52d5-201">There are a number of points to note about the hierarchy of visual objects and vector graphics instruction lists:</span></span>  
  
- <span data-ttu-id="b52d5-202">階層中的順序代表繪製資訊的轉譯順序。</span><span class="sxs-lookup"><span data-stu-id="b52d5-202">The ordering in the hierarchy represents the rendering order of the drawing information.</span></span> <span data-ttu-id="b52d5-203">子元素會由左至右、由上而下從根視覺元素周遊。</span><span class="sxs-lookup"><span data-stu-id="b52d5-203">From the root visual element, child elements are traversed, left to right, top to bottom.</span></span> <span data-ttu-id="b52d5-204">如果某元素具有視覺化子元素，則會在元素的同層級元素之前周遊這些子元素。</span><span class="sxs-lookup"><span data-stu-id="b52d5-204">If an element has visual child elements, they are traversed before the element’s siblings.</span></span>  
  
- <span data-ttu-id="b52d5-205">階層中的非分葉節點元素 (例如<xref:System.Windows.Controls.ContentPresenter>) 是用來包含子專案, 而不包含指令清單。</span><span class="sxs-lookup"><span data-stu-id="b52d5-205">Non-leaf node elements in the hierarchy, such as <xref:System.Windows.Controls.ContentPresenter>, are used to contain child elements—they do not contain instruction lists.</span></span>  
  
- <span data-ttu-id="b52d5-206">如果視覺元素同時包含向量圖形指示清單與視覺子元素，父系視覺元素中的指示清單就會在任何視覺子元素物件中的繪圖之前轉譯。</span><span class="sxs-lookup"><span data-stu-id="b52d5-206">If a visual element contains both a vector graphics instruction list and visual children, the instruction list in the parent visual element is rendered before drawings in any of the visual child objects.</span></span>  
  
- <span data-ttu-id="b52d5-207">向量圖形指示清單中的項目會由左至右轉譯。</span><span class="sxs-lookup"><span data-stu-id="b52d5-207">The items in the vector graphics instruction list are rendered left to right.</span></span>  
  
<a name="visual_tree"></a>   
## <a name="visual-tree"></a><span data-ttu-id="b52d5-208">視覺化樹狀結構</span><span class="sxs-lookup"><span data-stu-id="b52d5-208">Visual Tree</span></span>  
 <span data-ttu-id="b52d5-209">視覺化樹狀結構包含應用程式使用者介面中所使用的所有視覺元素。</span><span class="sxs-lookup"><span data-stu-id="b52d5-209">The visual tree contains all visual elements used in an application's user interface.</span></span> <span data-ttu-id="b52d5-210">由於視覺元素包含持續性繪圖資訊，您可以將視覺化樹狀結構想像為場景圖形，其中包含將輸出撰寫至顯示裝置所需的所有轉譯資訊。</span><span class="sxs-lookup"><span data-stu-id="b52d5-210">Since a visual element contains persisted drawing information, you can think of the visual tree as a scene graph, containing all the rendering information needed to compose the output to the display device.</span></span> <span data-ttu-id="b52d5-211">此樹狀結構是直接由應用程式所建立 (不論是以程式碼或標記) 的所有視覺元素累積而成。</span><span class="sxs-lookup"><span data-stu-id="b52d5-211">This tree is the accumulation of all visual elements created directly by the application, whether in code or in markup.</span></span> <span data-ttu-id="b52d5-212">視覺化樹狀結構也包含由元素 (例如控制項和資料物件) 的範本展開所建立的所有視覺元素。</span><span class="sxs-lookup"><span data-stu-id="b52d5-212">The visual tree also contains all visual elements created by the template expansion of elements such as controls and data objects.</span></span>  
  
 <span data-ttu-id="b52d5-213">下列程式碼顯示在<xref:System.Windows.Controls.StackPanel>標記中定義的元素。</span><span class="sxs-lookup"><span data-stu-id="b52d5-213">The following code shows a <xref:System.Windows.Controls.StackPanel> element defined in markup.</span></span>  
  
 [!code-xaml[VisualsOverview#VisualsOverviewSnippet3](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml#visualsoverviewsnippet3)]  
  
 <span data-ttu-id="b52d5-214">如果您要列舉標記範例中組成<xref:System.Windows.Controls.StackPanel>專案的視覺物件, 您會找到視覺物件的階層架構, 如下所示:</span><span class="sxs-lookup"><span data-stu-id="b52d5-214">If you were to enumerate the visual objects that comprise the <xref:System.Windows.Controls.StackPanel> element in the markup example, you would find the hierarchy of visual objects illustrated below:</span></span>  
  
 ![視覺化樹狀階層架構的圖表](./media/wpf-graphics-rendering-overview/visual-tree-hierarchy.gif)  
  
### <a name="rendering-order"></a><span data-ttu-id="b52d5-216">轉譯順序</span><span class="sxs-lookup"><span data-stu-id="b52d5-216">Rendering Order</span></span>  
 <span data-ttu-id="b52d5-217">視覺化樹狀結構會決定 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 視覺物件和繪圖物件的轉譯順序。</span><span class="sxs-lookup"><span data-stu-id="b52d5-217">The visual tree determines the rendering order of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] visual and drawing objects.</span></span> <span data-ttu-id="b52d5-218">周遊順序會從根視覺物件開始，這是視覺化樹狀結構的最上層節點。</span><span class="sxs-lookup"><span data-stu-id="b52d5-218">The order of traversal starts with the root visual, which is the top-most node in the visual tree.</span></span> <span data-ttu-id="b52d5-219">然後，會由左至右周遊根視覺物件的子系。</span><span class="sxs-lookup"><span data-stu-id="b52d5-219">The root visual’s children are then traversed, left to right.</span></span> <span data-ttu-id="b52d5-220">如果視覺物件具有子系，則會在該視覺物件的同層級項目之前周遊其子系。</span><span class="sxs-lookup"><span data-stu-id="b52d5-220">If a visual has children, its children are traversed before the visual’s siblings.</span></span> <span data-ttu-id="b52d5-221">這表示子視覺物件的內容會在視覺物件本身的內容前面轉譯。</span><span class="sxs-lookup"><span data-stu-id="b52d5-221">This means that the content of a child visual is rendered in front of the visual's own content.</span></span>  
  
 ![視覺化樹狀結構轉譯順序的圖表](./media/wpf-graphics-rendering-overview/visual-tree-rendering-order.gif) 
  
### <a name="root-visual"></a><span data-ttu-id="b52d5-223">根視覺物件</span><span class="sxs-lookup"><span data-stu-id="b52d5-223">Root Visual</span></span>  
 <span data-ttu-id="b52d5-224">「根視覺物件」是視覺化樹狀結構階層中最上層的元素。</span><span class="sxs-lookup"><span data-stu-id="b52d5-224">The **root visual** is the top-most element in a visual tree hierarchy.</span></span> <span data-ttu-id="b52d5-225">在大部分的應用程式中, 根視覺效果的基類是<xref:System.Windows.Window>或<xref:System.Windows.Navigation.NavigationWindow>。</span><span class="sxs-lookup"><span data-stu-id="b52d5-225">In most applications, the base class of the root visual is either <xref:System.Windows.Window> or <xref:System.Windows.Navigation.NavigationWindow>.</span></span> <span data-ttu-id="b52d5-226">不過，如果您已在 Win32 應用程式中裝載視覺物件，根視覺物件是您在 Win32 視窗中裝載的最上層視覺物件。</span><span class="sxs-lookup"><span data-stu-id="b52d5-226">However, if you were hosting visual objects in a Win32 application, the root visual would be the top-most visual you were hosting in the Win32 window.</span></span> <span data-ttu-id="b52d5-227">如需詳細資訊，請參閱[教學課程：在 Win32 應用程式](tutorial-hosting-visual-objects-in-a-win32-application.md)中裝載視覺物件。</span><span class="sxs-lookup"><span data-stu-id="b52d5-227">For more information, see [Tutorial: Hosting Visual Objects in a Win32 Application](tutorial-hosting-visual-objects-in-a-win32-application.md).</span></span>  
  
### <a name="relationship-to-the-logical-tree"></a><span data-ttu-id="b52d5-228">邏輯樹狀結構的關聯性</span><span class="sxs-lookup"><span data-stu-id="b52d5-228">Relationship to the Logical Tree</span></span>  
 <span data-ttu-id="b52d5-229">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中的邏輯樹狀結構代表執行階段應用程式的元素。</span><span class="sxs-lookup"><span data-stu-id="b52d5-229">The logical tree in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] represents the elements of an application at run time.</span></span> <span data-ttu-id="b52d5-230">雖然您不會直接操作此樹狀結構，但應用程式的這個檢視適合用來了解屬性繼承和事件路由。</span><span class="sxs-lookup"><span data-stu-id="b52d5-230">Although you do not manipulate this tree directly, this view of the application is useful for understanding property inheritance and event routing.</span></span> <span data-ttu-id="b52d5-231">與視覺化樹狀結構不同的是, 邏輯樹狀結構可以代表非視覺化的資料物件<xref:System.Windows.Documents.ListItem>, 例如。</span><span class="sxs-lookup"><span data-stu-id="b52d5-231">Unlike the visual tree, the logical tree can represent non-visual data objects, such as <xref:System.Windows.Documents.ListItem>.</span></span> <span data-ttu-id="b52d5-232">在許多案例中，邏輯樹狀結構會非常密切地對應至應用程式的標記定義。</span><span class="sxs-lookup"><span data-stu-id="b52d5-232">In many cases, the logical tree maps very closely to an application's markup definitions.</span></span> <span data-ttu-id="b52d5-233">下列程式碼顯示在<xref:System.Windows.Controls.DockPanel>標記中定義的元素。</span><span class="sxs-lookup"><span data-stu-id="b52d5-233">The following code shows a <xref:System.Windows.Controls.DockPanel> element defined in markup.</span></span>  
  
 [!code-xaml[VisualsOverview#VisualsOverviewSnippet5](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml#visualsoverviewsnippet5)]  
  
 <span data-ttu-id="b52d5-234">如果您要列舉標記範例中組成<xref:System.Windows.Controls.DockPanel>元素的邏輯物件, 您會找到邏輯物件的階層, 如下所示:</span><span class="sxs-lookup"><span data-stu-id="b52d5-234">If you were to enumerate the logical objects that comprise the <xref:System.Windows.Controls.DockPanel> element in the markup example, you would find the hierarchy of logical objects illustrated below:</span></span>  
  
 <span data-ttu-id="b52d5-235">![樹狀結構圖表](./media/tree1-wcp.gif "Tree1_wcp")</span><span class="sxs-lookup"><span data-stu-id="b52d5-235">![Tree diagram](./media/tree1-wcp.gif "Tree1_wcp")</span></span>  
<span data-ttu-id="b52d5-236">邏輯樹狀結構的圖表</span><span class="sxs-lookup"><span data-stu-id="b52d5-236">Diagram of logical tree</span></span>  
  
 <span data-ttu-id="b52d5-237">視覺化樹狀結構和邏輯樹狀結構會與目前的應用程式元素集合同步處理，以反映元素的任何新增、刪除或修改。</span><span class="sxs-lookup"><span data-stu-id="b52d5-237">Both the visual tree and logical tree are synchronized with the current set of application elements, reflecting any addition, deletion, or modification of elements.</span></span> <span data-ttu-id="b52d5-238">不過，樹狀結構會呈現不同的應用程式檢視。</span><span class="sxs-lookup"><span data-stu-id="b52d5-238">However, the trees present different views of the application.</span></span> <span data-ttu-id="b52d5-239">與視覺化樹狀結構不同的是, 邏輯樹狀結構並不會<xref:System.Windows.Controls.ContentPresenter>展開控制項的元素。</span><span class="sxs-lookup"><span data-stu-id="b52d5-239">Unlike the visual tree, the logical tree does not expand a control's <xref:System.Windows.Controls.ContentPresenter> element.</span></span> <span data-ttu-id="b52d5-240">這表示針對相同的物件集合，邏輯樹狀結構和視覺化樹狀結構之間沒有直接的一對一對應。</span><span class="sxs-lookup"><span data-stu-id="b52d5-240">This means there is not a direct one-to-one correspondence between a logical tree and a visual tree for the same set of objects.</span></span> <span data-ttu-id="b52d5-241">事實上, 使用與參數相同的專案<xref:System.Windows.LogicalTreeHelper.GetChildren%2A>叫用 system.windows.logicaltreehelper> 物件的方法<xref:System.Windows.Media.VisualTreeHelper.GetChild%2A>和**VisualTreeHelper**物件的方法, 會產生不同的結果。</span><span class="sxs-lookup"><span data-stu-id="b52d5-241">In fact, invoking the **LogicalTreeHelper** object's <xref:System.Windows.LogicalTreeHelper.GetChildren%2A> method and the **VisualTreeHelper** object's <xref:System.Windows.Media.VisualTreeHelper.GetChild%2A> method using the same element as a parameter yields differing results.</span></span>  
  
 <span data-ttu-id="b52d5-242">如需有關邏輯樹狀結構的詳細資訊，請參閱 [WPF 中的樹狀結構](../advanced/trees-in-wpf.md)。</span><span class="sxs-lookup"><span data-stu-id="b52d5-242">For more information on the logical tree, see [Trees in WPF](../advanced/trees-in-wpf.md).</span></span>  
  
### <a name="viewing-the-visual-tree-with-xamlpad"></a><span data-ttu-id="b52d5-243">使用 XamlPad 檢視視覺化樹狀結構</span><span class="sxs-lookup"><span data-stu-id="b52d5-243">Viewing the Visual Tree with XamlPad</span></span>  
 <span data-ttu-id="b52d5-244">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 工具 XamlPad 提供了選項，可讓您檢視及探索對應至目前定義之 [!INCLUDE[TLA#tla_titlexaml](../../../../includes/tlasharptla-titlexaml-md.md)] 內容的視覺化樹狀結構。</span><span class="sxs-lookup"><span data-stu-id="b52d5-244">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tool, XamlPad, provides an option for viewing and exploring the visual tree that corresponds to the currently defined [!INCLUDE[TLA#tla_titlexaml](../../../../includes/tlasharptla-titlexaml-md.md)] content.</span></span> <span data-ttu-id="b52d5-245">按一下功能表列上的 [顯示視覺化樹狀結構] 按鈕以顯示視覺化樹狀結構。</span><span class="sxs-lookup"><span data-stu-id="b52d5-245">Click the **Show Visual Tree** button on the menu bar to display the visual tree.</span></span> <span data-ttu-id="b52d5-246">下圖說明在 XamlPad 的 [視覺化樹狀結構總管] 面板中，[!INCLUDE[TLA#tla_titlexaml](../../../../includes/tlasharptla-titlexaml-md.md)] 內容展開為視覺化樹狀結構節點：</span><span class="sxs-lookup"><span data-stu-id="b52d5-246">The following illustrates the expansion of [!INCLUDE[TLA#tla_titlexaml](../../../../includes/tlasharptla-titlexaml-md.md)] content into visual tree nodes in the **Visual Tree Explorer** panel of XamlPad:</span></span>  
  
 ![XamlPad 中的視覺化樹狀結構總管面板](./media/wpf-graphics-rendering-overview/visual-tree-explorer.png)  

 <span data-ttu-id="b52d5-248">請注意<xref:System.Windows.Controls.TextBox>,、和<xref:System.Windows.Controls.Button>控制項各自會在 XamlPad 的 [**視覺化樹狀檢視器**] 面板中顯示個別的視覺物件階層。 <xref:System.Windows.Controls.Label></span><span class="sxs-lookup"><span data-stu-id="b52d5-248">Notice how the <xref:System.Windows.Controls.Label>, <xref:System.Windows.Controls.TextBox>, and <xref:System.Windows.Controls.Button> controls each display a separate visual object hierarchy in the **Visual Tree Explorer** panel of XamlPad.</span></span> <span data-ttu-id="b52d5-249">這是因為[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]控制項<xref:System.Windows.Controls.ControlTemplate>具有, 其中包含該控制項的視覺化樹狀結構。</span><span class="sxs-lookup"><span data-stu-id="b52d5-249">This is because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls have a <xref:System.Windows.Controls.ControlTemplate> that contains the visual tree of that control.</span></span> <span data-ttu-id="b52d5-250">當您明確地參考控制項時，您會以隱含方式參考其視覺階層。</span><span class="sxs-lookup"><span data-stu-id="b52d5-250">When you explicitly reference a control, you implicitly reference its visual hierarchy.</span></span>  
  
### <a name="profiling-visual-performance"></a><span data-ttu-id="b52d5-251">分析視覺效能</span><span class="sxs-lookup"><span data-stu-id="b52d5-251">Profiling Visual Performance</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="b52d5-252">提供一套效能分析工具，可讓您分析應用程式的執行階段行為，並判斷您可以套用的效能最佳化類型。</span><span class="sxs-lookup"><span data-stu-id="b52d5-252">provides a suite of performance profiling tools that allow you to analyze the run-time behavior of your application and determine the types of performance optimizations you can apply.</span></span> <span data-ttu-id="b52d5-253">Visual Profiler 工具透過直接對應至應用程式的視覺化樹狀結構，提供豐富的效能資料的圖形化檢視。</span><span class="sxs-lookup"><span data-stu-id="b52d5-253">The Visual Profiler tool provides a rich, graphical view of performance data by mapping directly to the application's visual tree.</span></span> <span data-ttu-id="b52d5-254">在這個螢幕擷取畫面中，Visual Profiler 的 [CPU 使用量] 區段可提供您物件使用 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 服務的精確分析，例如轉譯和版面配置。</span><span class="sxs-lookup"><span data-stu-id="b52d5-254">In this screenshot, the **CPU Usage** section of the Visual Profiler gives you a precise breakdown of an object's use of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] services, such as rendering and layout.</span></span>  
  
 <span data-ttu-id="b52d5-255">![Visual Profiler 顯示輸出](./media/wpfperf-visualprofiler-04.png "WPFPerf_VisualProfiler_04")</span><span class="sxs-lookup"><span data-stu-id="b52d5-255">![Visual Profiler display output](./media/wpfperf-visualprofiler-04.png "WPFPerf_VisualProfiler_04")</span></span>  
<span data-ttu-id="b52d5-256">Visual Profiler 顯示輸出</span><span class="sxs-lookup"><span data-stu-id="b52d5-256">Visual Profiler display output</span></span>  
  
<a name="visual_rendering_behavior"></a>   
## <a name="visual-rendering-behavior"></a><span data-ttu-id="b52d5-257">Visual 轉譯行為</span><span class="sxs-lookup"><span data-stu-id="b52d5-257">Visual Rendering Behavior</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="b52d5-258">導入幾個會影響視覺物件轉譯行為的功能：保留模式圖形、向量圖形和裝置獨立圖形。</span><span class="sxs-lookup"><span data-stu-id="b52d5-258">introduces several features that affect the rendering behavior of visual objects: retained mode graphics, vector graphics, and device independent graphics.</span></span>  
  
### <a name="retained-mode-graphics"></a><span data-ttu-id="b52d5-259">保留模式圖形</span><span class="sxs-lookup"><span data-stu-id="b52d5-259">Retained Mode Graphics</span></span>  
 <span data-ttu-id="b52d5-260">了解視覺物件角色的其中一個關鍵就是要了解「直接模式」和「保留模式」圖形系統之間的差異。</span><span class="sxs-lookup"><span data-stu-id="b52d5-260">One of the keys to understanding the role of the Visual object is to understand the difference between **immediate mode** and **retained mode** graphics systems.</span></span> <span data-ttu-id="b52d5-261">以 GDI 或 GDI+ 為基礎的標準 Win32 應用程式使用直接模式圖形系統。</span><span class="sxs-lookup"><span data-stu-id="b52d5-261">A standard Win32 application based on GDI or GDI+ uses an immediate mode graphics system.</span></span> <span data-ttu-id="b52d5-262">這表示應用程式負責重新繪製因為像是重新調整視窗大小或者物件正在變更其視覺外觀等動作而無效的用戶端區域部分。</span><span class="sxs-lookup"><span data-stu-id="b52d5-262">This means that the application is responsible for repainting the portion of the client area that is invalidated, due to an action such as a window being resized, or an object changing its visual appearance.</span></span>  
  
 ![Win32 轉譯序列的圖表](./media/wpf-graphics-rendering-overview/win32-rendering-squence.png)  
  
 <span data-ttu-id="b52d5-264">相反地，[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 使用保留模式系統。</span><span class="sxs-lookup"><span data-stu-id="b52d5-264">In contrast, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uses a retained mode system.</span></span> <span data-ttu-id="b52d5-265">這表示具有視覺外觀的應用程式物件會定義一組序列化繪圖資料。</span><span class="sxs-lookup"><span data-stu-id="b52d5-265">This means application objects that have a visual appearance define a set of serialized drawing data.</span></span> <span data-ttu-id="b52d5-266">一旦定義繪圖資料，系統此後就會負責回應轉譯應用程式物件的所有重新繪製要求。</span><span class="sxs-lookup"><span data-stu-id="b52d5-266">Once the drawing data is defined, the system is responsible thereafter for responding to all repaint requests for rendering the application objects.</span></span> <span data-ttu-id="b52d5-267">即使在執行階段，您也可以修改或建立應用程式物件，並仍需依賴系統以回應繪製要求。</span><span class="sxs-lookup"><span data-stu-id="b52d5-267">Even at run time, you can modify or create application objects, and still rely on the system for responding to paint requests.</span></span> <span data-ttu-id="b52d5-268">保留模式圖形系統的能力在於繪製資訊一律由應用程式以序列化狀態持續保存，但是轉譯的責任屬於系統。</span><span class="sxs-lookup"><span data-stu-id="b52d5-268">The power in a retained mode graphics system is that drawing information is always persisted in a serialized state by the application, but rendering responsibility left to the system.</span></span> <span data-ttu-id="b52d5-269">下圖顯示應用程式如何依賴 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 來回應繪製要求。</span><span class="sxs-lookup"><span data-stu-id="b52d5-269">The following diagram shows how the application relies on [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] for responding to paint requests.</span></span>  
  
 ![WPF 轉譯序列的圖表](./media/wpf-graphics-rendering-overview/wpf-rendering-sequence.png)  

#### <a name="intelligent-redrawing"></a><span data-ttu-id="b52d5-271">智慧型重新繪製</span><span class="sxs-lookup"><span data-stu-id="b52d5-271">Intelligent Redrawing</span></span>  
 <span data-ttu-id="b52d5-272">使用保留模式圖形的一個最大的優點就是 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 可以有效地最佳化應用程式中需要重新繪製的項目。</span><span class="sxs-lookup"><span data-stu-id="b52d5-272">One of the biggest benefits in using retained mode graphics is that [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can efficiently optimize what needs to be redrawn in the application.</span></span> <span data-ttu-id="b52d5-273">即使您有一個具有不同層級不透明度的複雜場景，通常也不需要撰寫特殊用途程式碼來最佳化重新繪製作業。</span><span class="sxs-lookup"><span data-stu-id="b52d5-273">Even if you have a complex scene with varying levels of opacity, you generally do not need to write special-purpose code to optimize redrawing.</span></span> <span data-ttu-id="b52d5-274">與 Win32 程式設計比較，在 Win32 程式設計中您可能會花費大量精力，透過將更新區域中重新繪製的次數降至最低，來最佳化您的應用程式上。</span><span class="sxs-lookup"><span data-stu-id="b52d5-274">Compare this with Win32 programming in which you can spend a great deal of effort in optimizing your application by minimizing the amount of redrawing in the update region.</span></span> <span data-ttu-id="b52d5-275">如需在 Win32 應用程式中最佳化重新繪製所牽涉之複雜性類型的範例，請參閱[在更新區域中重新繪製](/windows/desktop/gdi/redrawing-in-the-update-region)。</span><span class="sxs-lookup"><span data-stu-id="b52d5-275">See [Redrawing in the Update Region](/windows/desktop/gdi/redrawing-in-the-update-region) for an example of the type of complexity involved in optimizing redrawing in Win32 applications.</span></span>  
  
### <a name="vector-graphics"></a><span data-ttu-id="b52d5-276">向量圖形</span><span class="sxs-lookup"><span data-stu-id="b52d5-276">Vector Graphics</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="b52d5-277">使用「向量圖形」作為其轉譯資料格式。</span><span class="sxs-lookup"><span data-stu-id="b52d5-277">uses **vector graphics** as its rendering data format.</span></span> <span data-ttu-id="b52d5-278">向量圖形 (包含可縮放向量圖形 (SVG)、Windows 中繼檔案 (.wmf) 和 TrueType 字型) 會儲存轉譯資料並將它以說明如何使用圖形基元重新建立影像的指示清單來傳輸。</span><span class="sxs-lookup"><span data-stu-id="b52d5-278">Vector graphics—which include Scalable Vector Graphics (SVG), Windows metafiles (.wmf), and TrueType fonts—store rendering data and transmit it as a list of instructions that describe how to recreate an image using graphics primitives.</span></span> <span data-ttu-id="b52d5-279">例如，TrueType 字型是邊框字型，可描述一組線條、曲線和命令，而非像素陣列。</span><span class="sxs-lookup"><span data-stu-id="b52d5-279">For example, TrueType fonts are outline fonts that describe a set of lines, curves, and commands, rather than an array of pixels.</span></span> <span data-ttu-id="b52d5-280">向量圖形的其中一個主要優點就是能夠縮放為任何大小和解析度。</span><span class="sxs-lookup"><span data-stu-id="b52d5-280">One of the key benefits of vector graphics is the ability to scale to any size and resolution.</span></span>  
  
 <span data-ttu-id="b52d5-281">與向量圖形不同，點陣圖圖形將轉譯資料儲存為影像的逐像素 (pixel-by-pixel) 表示法，針對特定解析度預先轉譯。</span><span class="sxs-lookup"><span data-stu-id="b52d5-281">Unlike vector graphics, bitmap graphics store rendering data as a pixel-by-pixel representation of an image, pre-rendered for a specific resolution.</span></span> <span data-ttu-id="b52d5-282">點陣和向量圖形格式之間的其中一個主要差異是原始來源影像的逼真度。</span><span class="sxs-lookup"><span data-stu-id="b52d5-282">One of the key differences between bitmap and vector graphic formats is fidelity to the original source image.</span></span> <span data-ttu-id="b52d5-283">例如，當來源影像的的大小經過修改，點陣圖圖形系統會伸展影像，而向量圖形系統則是縮放影像，因此保留影像逼真度。</span><span class="sxs-lookup"><span data-stu-id="b52d5-283">For example, when the size of a source image is modified, bitmap graphics systems stretch the image, whereas vector graphics systems scale the image, preserving the image fidelity.</span></span>  
  
 <span data-ttu-id="b52d5-284">下圖顯示已將大小調整為 300% 的來源影像。</span><span class="sxs-lookup"><span data-stu-id="b52d5-284">The following illustration shows a source image that has been resized by 300%.</span></span> <span data-ttu-id="b52d5-285">請注意，當來源影像是以點陣圖圖形影像伸展而非以向量圖形影像縮放時，會出現扭曲。</span><span class="sxs-lookup"><span data-stu-id="b52d5-285">Notice the distortions that appear when the source image is stretched as a bitmap graphics image rather than scaled as a vector graphics image.</span></span>  
  
 ![點陣圖形和向量圖形之間的差異](./media/wpf-graphics-rendering-overview/raster-vector-differences.png)  
  
 <span data-ttu-id="b52d5-287">下列標記會顯示兩<xref:System.Windows.Shapes.Path>個已定義的元素。</span><span class="sxs-lookup"><span data-stu-id="b52d5-287">The following markup shows two <xref:System.Windows.Shapes.Path> elements defined.</span></span> <span data-ttu-id="b52d5-288">第二個元素會<xref:System.Windows.Media.ScaleTransform>使用, 將第一個元素的繪圖指示調整為 300%。</span><span class="sxs-lookup"><span data-stu-id="b52d5-288">The second element uses a <xref:System.Windows.Media.ScaleTransform> to resize the drawing instructions of the first element by 300%.</span></span> <span data-ttu-id="b52d5-289">請注意, <xref:System.Windows.Shapes.Path>元素中的繪圖指示會保持不變。</span><span class="sxs-lookup"><span data-stu-id="b52d5-289">Notice that the drawing instructions in the <xref:System.Windows.Shapes.Path> elements remain unchanged.</span></span>  
  
 [!code-xaml[VectorGraphicsSnippets#VectorGraphicsSnippet1](~/samples/snippets/csharp/VS_Snippets_Wpf/VectorGraphicsSnippets/CS/PageOne.xaml#vectorgraphicssnippet1)]  
  
### <a name="about-resolution-and-device-independent-graphics"></a><span data-ttu-id="b52d5-290">有關解析度和裝置獨立圖形</span><span class="sxs-lookup"><span data-stu-id="b52d5-290">About Resolution and Device-Independent Graphics</span></span>  
 <span data-ttu-id="b52d5-291">決定螢幕上文字和圖形大小的系統因素有兩個：解析度和 DPI。</span><span class="sxs-lookup"><span data-stu-id="b52d5-291">There are two system factors that determine the size of text and graphics on your screen: resolution and DPI.</span></span> <span data-ttu-id="b52d5-292">解析度描述螢幕上顯示的像素數目。</span><span class="sxs-lookup"><span data-stu-id="b52d5-292">Resolution describes the number of pixels that appear on the screen.</span></span> <span data-ttu-id="b52d5-293">解析度越高，像素越小，使得圖形和文字看起來比較小。</span><span class="sxs-lookup"><span data-stu-id="b52d5-293">As the resolution gets higher, pixels get smaller, causing graphics and text to appear smaller.</span></span> <span data-ttu-id="b52d5-294">顯示在設定為 1024 x 768 的監視器上的圖形，當解析度變更為 1600 x 1200 時，看起來會更小。</span><span class="sxs-lookup"><span data-stu-id="b52d5-294">A graphic displayed on a monitor set to 1024 x 768 will appear much smaller when the resolution is changed to 1600 x 1200.</span></span>  
  
 <span data-ttu-id="b52d5-295">另一個系統設定 DPI 則描述以像素為單位的畫面英吋大小。</span><span class="sxs-lookup"><span data-stu-id="b52d5-295">The other system setting, DPI, describes the size of a screen inch in pixels.</span></span> <span data-ttu-id="b52d5-296">大部分的 Windows 系統都有96的 DPI, 這表示螢幕的解析度是96圖元。</span><span class="sxs-lookup"><span data-stu-id="b52d5-296">Most Windows systems have a DPI of 96, which means a screen inch is 96 pixels.</span></span> <span data-ttu-id="b52d5-297">提高 DPI 設定會讓畫面英吋更大；降低 DPI 則讓畫面英吋更小。</span><span class="sxs-lookup"><span data-stu-id="b52d5-297">Increasing the DPI setting makes the screen inch larger; decreasing the DPI makes the screen inch smaller.</span></span> <span data-ttu-id="b52d5-298">這表示畫面英吋與實際英吋不相同，在大部分的系統上，通常都不相同。</span><span class="sxs-lookup"><span data-stu-id="b52d5-298">This means that a screen inch isn't the same size as a real-world inch; on most systems, it's probably not.</span></span> <span data-ttu-id="b52d5-299">當您提高 DPI，DPI 感知的圖形和文字會變得更大，因為您已經提高畫面英吋的大小。</span><span class="sxs-lookup"><span data-stu-id="b52d5-299">As you increase the DPI, DPI-aware graphics and text become larger because you've increased the size of the screen inch.</span></span> <span data-ttu-id="b52d5-300">提高 DPI 可讓文字更方便閱讀，特別是在高解析度時。</span><span class="sxs-lookup"><span data-stu-id="b52d5-300">Increasing the DPI can make text easier to read, especially at high resolutions.</span></span>  
  
 <span data-ttu-id="b52d5-301">並非所有應用程式都是 DPI 感知：某些應用程式使用硬體像素作為主要度量單位；變更系統 DPI 不會影響這些應用程式。</span><span class="sxs-lookup"><span data-stu-id="b52d5-301">Not all applications are DPI-aware: some use hardware pixels as the primary unit of measurement; changing the system DPI has no effect on these applications.</span></span> <span data-ttu-id="b52d5-302">許多其他的應用程式會使用 DPI 感知單位來描述字型大小，但是使用像素來描述所有其他項目。</span><span class="sxs-lookup"><span data-stu-id="b52d5-302">Many other applications use DPI-aware units to describe font sizes, but use pixels to describe everything else.</span></span> <span data-ttu-id="b52d5-303">DPI 太小或太大可能造成這些應用程式的版面配置問題，因為應用程式的文字是隨著系統的 DPI 設定縮放，但應用程式的 UI 則否。</span><span class="sxs-lookup"><span data-stu-id="b52d5-303">Making the DPI too small or too large can cause layout problems for these applications, because the applications' text scales with the system's DPI setting, but the applications' UI does not.</span></span> <span data-ttu-id="b52d5-304">針對使用 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 開發的應用程式，此問題已解決。</span><span class="sxs-lookup"><span data-stu-id="b52d5-304">This problem has been eliminated for applications developed using [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="b52d5-305">支援自動縮放，方法是使用裝置獨立像素作為其主要度量單位，而非硬體像素；圖形和文字會適當地縮放，應用程式開發人員不需要執行任何額外工作。</span><span class="sxs-lookup"><span data-stu-id="b52d5-305">supports automatic scaling by using the device independent pixel as its primary unit of measurement, instead of hardware pixels; graphics and text scale properly without any extra work from the application developer.</span></span> <span data-ttu-id="b52d5-306">下圖顯示以不同 DPI 設定顯示 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 文字和圖形之方式的範例。</span><span class="sxs-lookup"><span data-stu-id="b52d5-306">The following illustration shows an example of how [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] text and graphics are appear at different DPI settings.</span></span>  
  
 <span data-ttu-id="b52d5-307">![不同 DPI 設定的圖形和文字](./media/graphicsmm-dpi-setting-examples.png "graphicsmm_DPI_setting_examples")</span><span class="sxs-lookup"><span data-stu-id="b52d5-307">![Graphics and text at different DPI settings](./media/graphicsmm-dpi-setting-examples.png "graphicsmm_dpi_setting_examples")</span></span>  
<span data-ttu-id="b52d5-308">不同 DPI 設定時的圖形和文字</span><span class="sxs-lookup"><span data-stu-id="b52d5-308">Graphics and text at different DPI settings</span></span>  
  
<a name="visualtreehelper_class"></a>   
## <a name="visualtreehelper-class"></a><span data-ttu-id="b52d5-309">VisualTreeHelper 類別</span><span class="sxs-lookup"><span data-stu-id="b52d5-309">VisualTreeHelper Class</span></span>  
 <span data-ttu-id="b52d5-310"><xref:System.Windows.Media.VisualTreeHelper>類別是靜態 helper 類別, 可提供在視覺物件層級進行程式設計的低層級功能, 這在非常特定的案例中很有用, 例如開發高效能的自訂控制項。</span><span class="sxs-lookup"><span data-stu-id="b52d5-310">The <xref:System.Windows.Media.VisualTreeHelper> class is a static helper class that provides low-level functionality for programming at the visual object level, which is useful in very specific scenarios, such as developing high-performance custom controls.</span></span> <span data-ttu-id="b52d5-311">在大部分情況下, 較高層級[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]的架構物件 ( <xref:System.Windows.Controls.Canvas>例如和<xref:System.Windows.Controls.TextBlock>) 提供更大的彈性和易用性。</span><span class="sxs-lookup"><span data-stu-id="b52d5-311">In most case, the higher-level [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] framework objects, such as <xref:System.Windows.Controls.Canvas> and <xref:System.Windows.Controls.TextBlock>, offer greater flexibility and ease of use.</span></span>  
  
### <a name="hit-testing"></a><span data-ttu-id="b52d5-312">點擊測試</span><span class="sxs-lookup"><span data-stu-id="b52d5-312">Hit Testing</span></span>  
 <span data-ttu-id="b52d5-313">當<xref:System.Windows.Media.VisualTreeHelper>預設的點擊測試支援不符合您的需求時, 類別會提供針對視覺物件進行點擊測試的方法。</span><span class="sxs-lookup"><span data-stu-id="b52d5-313">The <xref:System.Windows.Media.VisualTreeHelper> class provides methods for hit testing on visual objects when the default hit test support does not meet your needs.</span></span> <span data-ttu-id="b52d5-314">您可以使用<xref:System.Windows.Media.VisualTreeHelper>類別<xref:System.Windows.Media.VisualTreeHelper.HitTest%2A>中的方法, 來判斷幾何或點座標值是否在指定物件的界限內, 例如控制項或圖形元素。</span><span class="sxs-lookup"><span data-stu-id="b52d5-314">You can use the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> methods in the <xref:System.Windows.Media.VisualTreeHelper> class to determine whether a geometry or point coordinate value is within the boundary of a given object, such as a control or graphic element.</span></span> <span data-ttu-id="b52d5-315">例如，您可以使用點擊測試來判斷物件的週框矩形內的滑鼠點擊是否落於圓形的幾何內。您也可以選擇覆寫預設點擊測試實作，以執行您的自訂點擊測試計算。</span><span class="sxs-lookup"><span data-stu-id="b52d5-315">For example, you could use hit testing to determine whether a mouse click within the bounding rectangle of an object falls within the geometry of a circle You can also choose to override the default implementation of hit testing to perform your own custom hit test calculations.</span></span>  
  
 <span data-ttu-id="b52d5-316">如需點擊測試的詳細資訊，請參閱[視覺分層中的點擊測試](hit-testing-in-the-visual-layer.md)。</span><span class="sxs-lookup"><span data-stu-id="b52d5-316">For more information on hit testing, see [Hit Testing in the Visual Layer](hit-testing-in-the-visual-layer.md).</span></span>  
  
### <a name="enumerating-the-visual-tree"></a><span data-ttu-id="b52d5-317">列舉視覺化樹狀結構</span><span class="sxs-lookup"><span data-stu-id="b52d5-317">Enumerating the Visual Tree</span></span>  
 <span data-ttu-id="b52d5-318"><xref:System.Windows.Media.VisualTreeHelper>類別會提供用來列舉視覺化樹狀結構成員的功能。</span><span class="sxs-lookup"><span data-stu-id="b52d5-318">The <xref:System.Windows.Media.VisualTreeHelper> class provides functionality for enumerating the members of a visual tree.</span></span> <span data-ttu-id="b52d5-319">若要取出父系, 請呼叫<xref:System.Windows.Media.VisualTreeHelper.GetParent%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="b52d5-319">To retrieve a parent, call the <xref:System.Windows.Media.VisualTreeHelper.GetParent%2A> method.</span></span> <span data-ttu-id="b52d5-320">若要取出視覺物件的子系或直接下階, 請呼叫<xref:System.Windows.Media.VisualTreeHelper.GetChild%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="b52d5-320">To retrieve a child, or direct descendant, of a visual object, call the <xref:System.Windows.Media.VisualTreeHelper.GetChild%2A> method.</span></span> <span data-ttu-id="b52d5-321">這個方法會傳回位於<xref:System.Windows.Media.Visual>指定索引處之父系的子系。</span><span class="sxs-lookup"><span data-stu-id="b52d5-321">This method returns a child <xref:System.Windows.Media.Visual> of the parent at the specified index.</span></span>  
  
 <span data-ttu-id="b52d5-322">下列範例示範如何列舉視覺物件的所有子系，如果您對將視覺物件階層的所有轉譯資訊序列化感興趣，這也會是您想要使用的技術。</span><span class="sxs-lookup"><span data-stu-id="b52d5-322">The following example shows how to enumerate all the descendants of a visual object, which is a technique you might want to use if you were interested in serializing all the rendering information of a visual object hierarchy.</span></span>  
  
 [!code-csharp[VisualsOverview#101](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml.cs#101)]
 [!code-vb[VisualsOverview#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/VisualsOverview/visualbasic/window1.xaml.vb#101)]  
  
 <span data-ttu-id="b52d5-323">在大部分案例中，邏輯樹狀結構是 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 應用程式中更有用的元素表示法。</span><span class="sxs-lookup"><span data-stu-id="b52d5-323">In most cases, the logical tree is a more useful representation of the elements in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application.</span></span> <span data-ttu-id="b52d5-324">雖然您不會直接修改邏輯樹狀結構，但應用程式的這個檢視適合用來了解屬性繼承和事件路由。</span><span class="sxs-lookup"><span data-stu-id="b52d5-324">Although you do not modify the logical tree directly, this view of the application is useful for understanding property inheritance and event routing.</span></span> <span data-ttu-id="b52d5-325">與視覺化樹狀結構不同的是, 邏輯樹狀結構可以代表非視覺化的資料物件<xref:System.Windows.Documents.ListItem>, 例如。</span><span class="sxs-lookup"><span data-stu-id="b52d5-325">Unlike the visual tree, the logical tree can represent non-visual data objects, such as <xref:System.Windows.Documents.ListItem>.</span></span> <span data-ttu-id="b52d5-326">如需有關邏輯樹狀結構的詳細資訊，請參閱 [WPF 中的樹狀結構](../advanced/trees-in-wpf.md)。</span><span class="sxs-lookup"><span data-stu-id="b52d5-326">For more information on the logical tree, see [Trees in WPF](../advanced/trees-in-wpf.md).</span></span>  
  
 <span data-ttu-id="b52d5-327"><xref:System.Windows.Media.VisualTreeHelper>類別會提供方法來傳回視覺物件的周框。</span><span class="sxs-lookup"><span data-stu-id="b52d5-327">The <xref:System.Windows.Media.VisualTreeHelper> class provides methods for returning the bounding rectangle of visual objects.</span></span> <span data-ttu-id="b52d5-328">您可以藉由呼叫<xref:System.Windows.Media.VisualTreeHelper.GetContentBounds%2A>來傳回視覺物件的周框。</span><span class="sxs-lookup"><span data-stu-id="b52d5-328">You can return the bounding rectangle of a visual object by calling <xref:System.Windows.Media.VisualTreeHelper.GetContentBounds%2A>.</span></span> <span data-ttu-id="b52d5-329">您可以藉由呼叫<xref:System.Windows.Media.VisualTreeHelper.GetDescendantBounds%2A>, 傳回視覺物件所有下階的周框, 包括視覺物件本身。</span><span class="sxs-lookup"><span data-stu-id="b52d5-329">You can return the bounding rectangle of all the descendants of a visual object, including the visual object itself, by calling <xref:System.Windows.Media.VisualTreeHelper.GetDescendantBounds%2A>.</span></span> <span data-ttu-id="b52d5-330">下列程式碼示範如何計算視覺物件及其所有子系的週框矩形。</span><span class="sxs-lookup"><span data-stu-id="b52d5-330">The following code shows how you would calculate the bounding rectangle of a visual object and all its descendants.</span></span>  
  
 [!code-csharp[VisualsOverview#102](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml.cs#102)]
 [!code-vb[VisualsOverview#102](~/samples/snippets/visualbasic/VS_Snippets_Wpf/VisualsOverview/visualbasic/window1.xaml.vb#102)]  
  
## <a name="see-also"></a><span data-ttu-id="b52d5-331">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b52d5-331">See also</span></span>

- <xref:System.Windows.Media.Visual>
- <xref:System.Windows.Media.VisualTreeHelper>
- <xref:System.Windows.Media.DrawingVisual>
- [<span data-ttu-id="b52d5-332">2D 圖形和影像處理</span><span class="sxs-lookup"><span data-stu-id="b52d5-332">2D Graphics and Imaging</span></span>](../advanced/optimizing-performance-2d-graphics-and-imaging.md)
- [<span data-ttu-id="b52d5-333">視覺分層中的點擊測試</span><span class="sxs-lookup"><span data-stu-id="b52d5-333">Hit Testing in the Visual Layer</span></span>](hit-testing-in-the-visual-layer.md)
- [<span data-ttu-id="b52d5-334">使用 DrawingVisual 物件</span><span class="sxs-lookup"><span data-stu-id="b52d5-334">Using DrawingVisual Objects</span></span>](using-drawingvisual-objects.md)
- [<span data-ttu-id="b52d5-335">教學課程：在 Win32 應用程式中裝載視覺物件</span><span class="sxs-lookup"><span data-stu-id="b52d5-335">Tutorial: Hosting Visual Objects in a Win32 Application</span></span>](tutorial-hosting-visual-objects-in-a-win32-application.md)
- [<span data-ttu-id="b52d5-336">最佳化 WPF 應用程式效能</span><span class="sxs-lookup"><span data-stu-id="b52d5-336">Optimizing WPF Application Performance</span></span>](../advanced/optimizing-wpf-application-performance.md)
