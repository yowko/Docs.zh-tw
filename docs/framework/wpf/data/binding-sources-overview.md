---
title: 繫結來源概觀
ms.date: 03/30/2017
helpviewer_keywords:
- binding data [WPF], binding sources
- data binding [WPF], binding source
- binding sources [WPF]
ms.assetid: 2df2cd11-6aac-4bdf-ab7b-ea5f464cd5ca
ms.openlocfilehash: 857175c65c62d8abad07a93baf72aa3709e5cb6b
ms.sourcegitcommit: 0c48191d6d641ce88d7510e319cf38c0e35697d0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/05/2019
ms.locfileid: "57375632"
---
# <a name="binding-sources-overview"></a><span data-ttu-id="f4421-102">繫結來源概觀</span><span class="sxs-lookup"><span data-stu-id="f4421-102">Binding Sources Overview</span></span>
<span data-ttu-id="f4421-103">在資料繫結中，繫結來源物件是指您取得資料的來源物件。</span><span class="sxs-lookup"><span data-stu-id="f4421-103">In data binding, the binding source object refers to the object you obtain data from.</span></span> <span data-ttu-id="f4421-104">本主題討論可以當做繫結來源的物件類型。</span><span class="sxs-lookup"><span data-stu-id="f4421-104">This topic discusses the types of objects you can use as the binding source.</span></span>  
  
  
  
<a name="binding_sources"></a>   
## <a name="binding-source-types"></a><span data-ttu-id="f4421-105">繫結來源類型</span><span class="sxs-lookup"><span data-stu-id="f4421-105">Binding Source Types</span></span>  
 [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] <span data-ttu-id="f4421-106">資料繫結支援下列繫結來源類型：</span><span class="sxs-lookup"><span data-stu-id="f4421-106">data binding supports the following binding source types:</span></span>  
  
|<span data-ttu-id="f4421-107">繫結來源</span><span class="sxs-lookup"><span data-stu-id="f4421-107">Binding Source</span></span>|<span data-ttu-id="f4421-108">描述</span><span class="sxs-lookup"><span data-stu-id="f4421-108">Description</span></span>|  
|--------------------|-----------------|  
|[!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] <span data-ttu-id="f4421-109">物件</span><span class="sxs-lookup"><span data-stu-id="f4421-109">objects</span></span>|<span data-ttu-id="f4421-110">您可以繫結至任何[!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] 物件的公用屬性、子屬性和索引子。</span><span class="sxs-lookup"><span data-stu-id="f4421-110">You can bind to public properties, sub-properties, as well as indexers, of any [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] object.</span></span> <span data-ttu-id="f4421-111">繫結引擎會使用 [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] 反映取得這些屬性的值。</span><span class="sxs-lookup"><span data-stu-id="f4421-111">The binding engine uses [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] reflection to get the values of the properties.</span></span> <span data-ttu-id="f4421-112">或者，物件實作<xref:System.ComponentModel.ICustomTypeDescriptor>或具有已註冊<xref:System.ComponentModel.TypeDescriptionProvider>也適用於繫結引擎。</span><span class="sxs-lookup"><span data-stu-id="f4421-112">Alternatively, objects that implement <xref:System.ComponentModel.ICustomTypeDescriptor> or have a registered <xref:System.ComponentModel.TypeDescriptionProvider> also work with the binding engine.</span></span><br /><br /> <span data-ttu-id="f4421-113">如需如何實作可做為繫結來源之類別的詳細資訊，請參閱本主題稍後的[為繫結來源實作類別](#classes)。</span><span class="sxs-lookup"><span data-stu-id="f4421-113">For more information about how to implement a class that can serve as a binding source, see [Implementing a Class for the Binding Source](#classes) later in this topic.</span></span>|  
|<span data-ttu-id="f4421-114">動態物件</span><span class="sxs-lookup"><span data-stu-id="f4421-114">dynamic objects</span></span>|<span data-ttu-id="f4421-115">您可以繫結至可用的屬性與索引子的物件，實作<xref:System.Dynamic.IDynamicMetaObjectProvider>介面。</span><span class="sxs-lookup"><span data-stu-id="f4421-115">You can bind to available properties and indexers of an object that implements the <xref:System.Dynamic.IDynamicMetaObjectProvider> interface.</span></span> <span data-ttu-id="f4421-116">如果您可以在程式碼中存取某個成員，就可以繫結至該成員。</span><span class="sxs-lookup"><span data-stu-id="f4421-116">If you can access the member in code, you can bind to it.</span></span> <span data-ttu-id="f4421-117">例如，若動態物件可讓您在程式碼中透過 `someObjet.AProperty` 存取某個成員，您就可以將繫結路徑設定為 `AProperty`，以繫結至該成員。</span><span class="sxs-lookup"><span data-stu-id="f4421-117">For example, if a dynamic object enables you to access a member in code via `someObjet.AProperty`, you can bind to it by setting the binding path to `AProperty`.</span></span>|  
|[!INCLUDE[TLA#tla_adonet](../../../../includes/tlasharptla-adonet-md.md)] <span data-ttu-id="f4421-118">物件</span><span class="sxs-lookup"><span data-stu-id="f4421-118">objects</span></span>|<span data-ttu-id="f4421-119">您可以繫結至[!INCLUDE[TLA2#tla_adonet](../../../../includes/tla2sharptla-adonet-md.md)]物件，例如<xref:System.Data.DataTable>。</span><span class="sxs-lookup"><span data-stu-id="f4421-119">You can bind to [!INCLUDE[TLA2#tla_adonet](../../../../includes/tla2sharptla-adonet-md.md)] objects, such as <xref:System.Data.DataTable>.</span></span> <span data-ttu-id="f4421-120">[!INCLUDE[TLA2#tla_adonet](../../../../includes/tla2sharptla-adonet-md.md)] <xref:System.Data.DataView>實作<xref:System.ComponentModel.IBindingList>介面，可提供繫結引擎所接聽的變更通知。</span><span class="sxs-lookup"><span data-stu-id="f4421-120">The [!INCLUDE[TLA2#tla_adonet](../../../../includes/tla2sharptla-adonet-md.md)] <xref:System.Data.DataView> implements the <xref:System.ComponentModel.IBindingList> interface, which provides change notifications that the binding engine listens for.</span></span>|  
|[!INCLUDE[TLA#tla_xml](../../../../includes/tlasharptla-xml-md.md)] <span data-ttu-id="f4421-121">物件</span><span class="sxs-lookup"><span data-stu-id="f4421-121">objects</span></span>|<span data-ttu-id="f4421-122">您可以將繫結至並執行`XPath`上查詢<xref:System.Xml.XmlNode>， <xref:System.Xml.XmlDocument>，或<xref:System.Xml.XmlElement>。</span><span class="sxs-lookup"><span data-stu-id="f4421-122">You can bind to and run `XPath` queries on an <xref:System.Xml.XmlNode>, <xref:System.Xml.XmlDocument>, or <xref:System.Xml.XmlElement>.</span></span> <span data-ttu-id="f4421-123">便利的方式來存取[!INCLUDE[TLA2#tla_xml](../../../../includes/tla2sharptla-xml-md.md)]是在標記中的繫結來源的資料是使用<xref:System.Windows.Data.XmlDataProvider>物件。</span><span class="sxs-lookup"><span data-stu-id="f4421-123">A convenient way to access [!INCLUDE[TLA2#tla_xml](../../../../includes/tla2sharptla-xml-md.md)] data that is the binding source in markup is to use an <xref:System.Windows.Data.XmlDataProvider> object.</span></span> <span data-ttu-id="f4421-124">如需詳細資訊，請參閱[使用 XMLDataProvider 和 XPath 查詢繫結至 XML 資料](how-to-bind-to-xml-data-using-an-xmldataprovider-and-xpath-queries.md)。</span><span class="sxs-lookup"><span data-stu-id="f4421-124">For more information, see [Bind to XML Data Using an XMLDataProvider and XPath Queries](how-to-bind-to-xml-data-using-an-xmldataprovider-and-xpath-queries.md).</span></span><br /><br /> <span data-ttu-id="f4421-125">您也可以以繫結<xref:System.Xml.Linq.XElement>或<xref:System.Xml.Linq.XDocument>，或繫結至這些類型的物件上執行使用 LINQ to XML 查詢的結果。</span><span class="sxs-lookup"><span data-stu-id="f4421-125">You can also bind to an <xref:System.Xml.Linq.XElement> or <xref:System.Xml.Linq.XDocument>, or bind to the results of queries run on objects of these types by using LINQ to XML.</span></span> <span data-ttu-id="f4421-126">使用 LINQ to XML 來存取 XML 資料做為標記中的繫結來源的便利方式是使用<xref:System.Windows.Data.ObjectDataProvider>物件。</span><span class="sxs-lookup"><span data-stu-id="f4421-126">A convenient way to use LINQ to XML to access XML data that is the binding source in markup is to use an <xref:System.Windows.Data.ObjectDataProvider> object.</span></span> <span data-ttu-id="f4421-127">如需詳細資訊，請參閱[繫結至 XML 查詢結果的 XDocument、XElement 或 LINQ](how-to-bind-to-xdocument-xelement-or-linq-for-xml-query-results.md)。</span><span class="sxs-lookup"><span data-stu-id="f4421-127">For more information, see [Bind to XDocument, XElement, or LINQ for XML Query Results](how-to-bind-to-xdocument-xelement-or-linq-for-xml-query-results.md).</span></span>|  
|<span data-ttu-id="f4421-128"><xref:System.Windows.DependencyObject> 物件</span><span class="sxs-lookup"><span data-stu-id="f4421-128"><xref:System.Windows.DependencyObject> objects</span></span>|<span data-ttu-id="f4421-129">您可以繫結至任何相依性屬性<xref:System.Windows.DependencyObject>。</span><span class="sxs-lookup"><span data-stu-id="f4421-129">You can bind to dependency properties of any <xref:System.Windows.DependencyObject>.</span></span> <span data-ttu-id="f4421-130">如需範例，請參閱[繫結兩個控制項的屬性](how-to-bind-the-properties-of-two-controls.md)。</span><span class="sxs-lookup"><span data-stu-id="f4421-130">For an example, see [Bind the Properties of Two Controls](how-to-bind-the-properties-of-two-controls.md).</span></span>|  
  
<a name="classes"></a>   
## <a name="implementing-a-class-for-the-binding-source"></a><span data-ttu-id="f4421-131">為繫結來源實作類別</span><span class="sxs-lookup"><span data-stu-id="f4421-131">Implementing a Class for the Binding Source</span></span>  
 <span data-ttu-id="f4421-132">您可以建立自己的繫結來源。</span><span class="sxs-lookup"><span data-stu-id="f4421-132">You can create your own binding sources.</span></span> <span data-ttu-id="f4421-133">本節討論在實作類別以做為繫結來源時必須知道的事。</span><span class="sxs-lookup"><span data-stu-id="f4421-133">This section discusses the things you need to know if you are implementing a class to serve as a binding source.</span></span>  
  
### <a name="providing-change-notifications"></a><span data-ttu-id="f4421-134">提供變更通知</span><span class="sxs-lookup"><span data-stu-id="f4421-134">Providing Change Notifications</span></span>  
 <span data-ttu-id="f4421-135">如果您使用其中一個<xref:System.Windows.Data.BindingMode.OneWay>或是<xref:System.Windows.Data.BindingMode.TwoWay>繫結 (因為您想要您[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]繫結來源屬性動態變更時更新)，您必須實作適當的屬性變更通知機制。</span><span class="sxs-lookup"><span data-stu-id="f4421-135">If you are using either <xref:System.Windows.Data.BindingMode.OneWay> or <xref:System.Windows.Data.BindingMode.TwoWay> binding (because you want your [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to update when the binding source properties change dynamically), you must implement a suitable property changed notification mechanism.</span></span> <span data-ttu-id="f4421-136">建議的機制是[!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)]或 動態類別實作<xref:System.ComponentModel.INotifyPropertyChanged>介面。</span><span class="sxs-lookup"><span data-stu-id="f4421-136">The recommended mechanism is for the [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] or dynamic class to implement the <xref:System.ComponentModel.INotifyPropertyChanged> interface.</span></span> <span data-ttu-id="f4421-137">如需詳細資訊，請參閱[實作屬性變更通知](how-to-implement-property-change-notification.md)。</span><span class="sxs-lookup"><span data-stu-id="f4421-137">For more information, see [Implement Property Change Notification](how-to-implement-property-change-notification.md).</span></span>  
  
 <span data-ttu-id="f4421-138">如果您建立[!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)]未實作的物件<xref:System.ComponentModel.INotifyPropertyChanged>，則您必須安排自己的通知系統，以確定維持目前的繫結中的資料。</span><span class="sxs-lookup"><span data-stu-id="f4421-138">If you create a [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] object that does not implement <xref:System.ComponentModel.INotifyPropertyChanged>, then you must arrange for your own notification system to make sure that the data used in a binding stays current.</span></span> <span data-ttu-id="f4421-139">您可以針對想要通知變更的每個屬性支援 `PropertyChanged` 模式，以提供變更通知。</span><span class="sxs-lookup"><span data-stu-id="f4421-139">You can provide change notifications by supporting the `PropertyChanged` pattern for each property that you want change notifications for.</span></span> <span data-ttu-id="f4421-140">若要支援這個模式，請定義每個屬性的 *PropertyName*Changed 事件，其中 *PropertyName* 是屬性的名稱。</span><span class="sxs-lookup"><span data-stu-id="f4421-140">To support this pattern, you define a *PropertyName*Changed event for each property, where *PropertyName* is the name of the property.</span></span> <span data-ttu-id="f4421-141">您可在每次屬性變更時，引發這個事件。</span><span class="sxs-lookup"><span data-stu-id="f4421-141">You raise the event every time the property changes.</span></span>  
  
 <span data-ttu-id="f4421-142">如果繫結來源實作其中一種通知機制，系統就會自動更新目標。</span><span class="sxs-lookup"><span data-stu-id="f4421-142">If your binding source implements one of these notification mechanisms, target updates happen automatically.</span></span> <span data-ttu-id="f4421-143">如果因故繫結來源不會提供適當的屬性變更通知，您可以選擇使用<xref:System.Windows.Data.BindingExpression.UpdateTarget%2A>方法來明確更新目標屬性。</span><span class="sxs-lookup"><span data-stu-id="f4421-143">If for any reason your binding source does not provide the proper property changed notifications, you have the option to use the <xref:System.Windows.Data.BindingExpression.UpdateTarget%2A> method to update the target property explicitly.</span></span>  
  
### <a name="other-characteristics"></a><span data-ttu-id="f4421-144">其他特性</span><span class="sxs-lookup"><span data-stu-id="f4421-144">Other Characteristics</span></span>  
 <span data-ttu-id="f4421-145">下列清單提供必須注意的其他重點：</span><span class="sxs-lookup"><span data-stu-id="f4421-145">The following list provides other important points to note:</span></span>  
  
-   <span data-ttu-id="f4421-146">如果要在 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] 中建立物件，此類別必須擁有預設建構函式。</span><span class="sxs-lookup"><span data-stu-id="f4421-146">If you want to create the object in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], the class must have a default constructor.</span></span> <span data-ttu-id="f4421-147">在某些[!INCLUDE[TLA2#tla_net](../../../../includes/tla2sharptla-net-md.md)]語言，例如C#，可能會為您建立的預設建構函式。</span><span class="sxs-lookup"><span data-stu-id="f4421-147">In some [!INCLUDE[TLA2#tla_net](../../../../includes/tla2sharptla-net-md.md)] languages, such as C#, the default constructor might be created for you.</span></span>  
  
-   <span data-ttu-id="f4421-148">要當做繫結之繫結來源屬性的屬性必須是類別的公用屬性。</span><span class="sxs-lookup"><span data-stu-id="f4421-148">The properties you use as binding source properties for a binding must be public properties of your class.</span></span> <span data-ttu-id="f4421-149">明確定義的介面屬性不能做為繫結之用，而沒有基底實作的受保護、私用、內部或虛擬屬性同樣也不能做為繫結之用。</span><span class="sxs-lookup"><span data-stu-id="f4421-149">Explicitly defined interface properties cannot be accessed for binding purposes, nor can protected, private, internal, or virtual properties that have no base implementation.</span></span>  
  
-   <span data-ttu-id="f4421-150">您不能繫結至公用欄位。</span><span class="sxs-lookup"><span data-stu-id="f4421-150">You cannot bind to public fields.</span></span>  
  
-   <span data-ttu-id="f4421-151">在類別中宣告的屬性，其型別就是傳遞至繫結的型別。</span><span class="sxs-lookup"><span data-stu-id="f4421-151">The type of the property declared in your class is the type that is passed to the binding.</span></span> <span data-ttu-id="f4421-152">不過，繫結最終使用的型別需視繫結目標屬性 (而非繫結來源屬性) 的型別而定。</span><span class="sxs-lookup"><span data-stu-id="f4421-152">However, the type ultimately used by the binding depends on the type of the binding target property, not of the binding source property.</span></span> <span data-ttu-id="f4421-153">如果型別不同，您可能需要撰寫轉換器來處理自訂屬性一開始傳遞到繫結的方式。</span><span class="sxs-lookup"><span data-stu-id="f4421-153">If there is a difference in type, you might want to write a converter to handle how your custom property is initially passed to the binding.</span></span> <span data-ttu-id="f4421-154">如需詳細資訊，請參閱<xref:System.Windows.Data.IValueConverter>。</span><span class="sxs-lookup"><span data-stu-id="f4421-154">For more information, see <xref:System.Windows.Data.IValueConverter>.</span></span>  
  
<a name="objects"></a>   
## <a name="using-entire-objects-as-a-binding-source"></a><span data-ttu-id="f4421-155">使用整個物件做為繫結來源</span><span class="sxs-lookup"><span data-stu-id="f4421-155">Using Entire Objects as a Binding Source</span></span>  
 <span data-ttu-id="f4421-156">您可以使用整個物件做為繫結來源。</span><span class="sxs-lookup"><span data-stu-id="f4421-156">You can use an entire object as a binding source.</span></span> <span data-ttu-id="f4421-157">您可以使用，以指定繫結來源<xref:System.Windows.Data.Binding.Source%2A>或<xref:System.Windows.FrameworkElement.DataContext%2A>屬性，然後提供空白繫結宣告： `{Binding}`。</span><span class="sxs-lookup"><span data-stu-id="f4421-157">You can specify a binding source by using the <xref:System.Windows.Data.Binding.Source%2A> or the <xref:System.Windows.FrameworkElement.DataContext%2A> property, and then provide a blank binding declaration: `{Binding}`.</span></span> <span data-ttu-id="f4421-158">可以使用這種方法的案例包括繫結到屬於字串型別的物件、繫結到內含您感興趣之多個屬性的物件，或是繫結到集合物件。</span><span class="sxs-lookup"><span data-stu-id="f4421-158">Scenarios in which this is useful include binding to objects that are of type string, binding to objects with multiple properties you are interested in, or binding to collection objects.</span></span> <span data-ttu-id="f4421-159">如需繫結到整個集合物件的範例，請參閱[使用含階層式資料的主從式模式](how-to-use-the-master-detail-pattern-with-hierarchical-data.md)。</span><span class="sxs-lookup"><span data-stu-id="f4421-159">For an example of binding to an entire collection object, see [Use the Master-Detail Pattern with Hierarchical Data](how-to-use-the-master-detail-pattern-with-hierarchical-data.md).</span></span>  
  
 <span data-ttu-id="f4421-160">請注意，您可能必須套用自訂邏輯，如此資料對於繫結目標屬性來說才有意義。</span><span class="sxs-lookup"><span data-stu-id="f4421-160">Note that you may need to apply custom logic so that the data is meaningful to your bound target property.</span></span> <span data-ttu-id="f4421-161">自訂的邏輯可能採用自訂轉換器的形式 （如果預設型別轉換不存在） 或<xref:System.Windows.DataTemplate>。</span><span class="sxs-lookup"><span data-stu-id="f4421-161">The custom logic may be in the form of a custom converter (if default type conversion does not exist) or a <xref:System.Windows.DataTemplate>.</span></span> <span data-ttu-id="f4421-162">如需轉換器的詳細資訊，請參閱[資料繫結概觀](data-binding-overview.md)的＜資料轉換＞一節。</span><span class="sxs-lookup"><span data-stu-id="f4421-162">For more information about converters, see the Data Conversion section of [Data Binding Overview](data-binding-overview.md).</span></span> <span data-ttu-id="f4421-163">如需資料範本的詳細資訊，請參閱[資料範本化概觀](data-templating-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="f4421-163">For more information about data templates, see [Data Templating Overview](data-templating-overview.md).</span></span>  
  
<a name="collections"></a>   
## <a name="using-collection-objects-as-a-binding-source"></a><span data-ttu-id="f4421-164">使用集合物件做為繫結來源</span><span class="sxs-lookup"><span data-stu-id="f4421-164">Using Collection Objects as a Binding Source</span></span>  
 <span data-ttu-id="f4421-165">您想當做繫結來源的物件通常會是自訂物件的集合。</span><span class="sxs-lookup"><span data-stu-id="f4421-165">Often, the object you want to use as the binding source is a collection of custom objects.</span></span> <span data-ttu-id="f4421-166">每個物件都會當做重複繫結的其中一個執行個體的來源。</span><span class="sxs-lookup"><span data-stu-id="f4421-166">Each object serves as the source for one instance of a repeated binding.</span></span> <span data-ttu-id="f4421-167">例如，您可能有一個由 `CustomerOrder` 物件組成的 `CustomerOrders` 集合，而您的應用程式會逐一查看這個集合來判斷訂單數量，以及各筆訂單所包含的資料。</span><span class="sxs-lookup"><span data-stu-id="f4421-167">For example, you might have a `CustomerOrders` collection that consists of `CustomerOrder` objects, where your application iterates over the collection to determine how many orders exist and the data contained in each.</span></span>  
  
 <span data-ttu-id="f4421-168">您可以列舉實作任何集合<xref:System.Collections.IEnumerable>介面。</span><span class="sxs-lookup"><span data-stu-id="f4421-168">You can enumerate over any collection that implements the <xref:System.Collections.IEnumerable> interface.</span></span> <span data-ttu-id="f4421-169">不過，若要設定動態繫結，以便插入或刪除集合中的更新[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]自動執行，則集合必須實作<xref:System.Collections.Specialized.INotifyCollectionChanged>介面。</span><span class="sxs-lookup"><span data-stu-id="f4421-169">However, to set up dynamic bindings so that insertions or deletions in the collection update the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] automatically, the collection must implement the <xref:System.Collections.Specialized.INotifyCollectionChanged> interface.</span></span> <span data-ttu-id="f4421-170">這個介面會公開每次基礎集合變更時必須引發的事件。</span><span class="sxs-lookup"><span data-stu-id="f4421-170">This interface exposes an event that must be raised whenever the underlying collection changes.</span></span>  
  
 <span data-ttu-id="f4421-171"><xref:System.Collections.ObjectModel.ObservableCollection%601>類別會公開 （expose） 的資料集合的內建實作<xref:System.Collections.Specialized.INotifyCollectionChanged>介面。</span><span class="sxs-lookup"><span data-stu-id="f4421-171">The <xref:System.Collections.ObjectModel.ObservableCollection%601> class is a built-in implementation of a data collection that exposes the <xref:System.Collections.Specialized.INotifyCollectionChanged> interface.</span></span> <span data-ttu-id="f4421-172">集合中的個別資料物件都必須滿足前幾個章節中描述的需求。</span><span class="sxs-lookup"><span data-stu-id="f4421-172">The individual data objects within the collection must satisfy the requirements described in the preceding sections.</span></span> <span data-ttu-id="f4421-173">如需範例，請參閱[建立和繫結至 ObservableCollection](how-to-create-and-bind-to-an-observablecollection.md)。</span><span class="sxs-lookup"><span data-stu-id="f4421-173">For an example, see [Create and Bind to an ObservableCollection](how-to-create-and-bind-to-an-observablecollection.md).</span></span> <span data-ttu-id="f4421-174">在之前實作您自己的集合，請考慮使用<xref:System.Collections.ObjectModel.ObservableCollection%601>或其中一個現有的集合類別，例如<xref:System.Collections.Generic.List%601>， <xref:System.Collections.ObjectModel.Collection%601>，和<xref:System.ComponentModel.BindingList%601>，還有其他更多。</span><span class="sxs-lookup"><span data-stu-id="f4421-174">Before implementing your own collection, consider using <xref:System.Collections.ObjectModel.ObservableCollection%601> or one of the existing collection classes, such as <xref:System.Collections.Generic.List%601>, <xref:System.Collections.ObjectModel.Collection%601>, and <xref:System.ComponentModel.BindingList%601>, among many others.</span></span>  
  
 <span data-ttu-id="f4421-175">WPF 絕不會直接繫結至集合。</span><span class="sxs-lookup"><span data-stu-id="f4421-175">WPF never binds directly to a collection.</span></span> <span data-ttu-id="f4421-176">如果您指定集合做為繫結來源，WPF 實際上會繫結至集合的預設檢視。</span><span class="sxs-lookup"><span data-stu-id="f4421-176">If you specify a collection as a binding source, WPF actually binds to the collection's default view.</span></span> <span data-ttu-id="f4421-177">如需預設檢視的詳細資訊，請參閱[資料繫結概觀](data-binding-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="f4421-177">For information about default views, see [Data Binding Overview](data-binding-overview.md).</span></span>  
  
 <span data-ttu-id="f4421-178">如果您擁有進階的案例，而且您想要實作您自己的集合，請考慮使用<xref:System.Collections.IList>介面。</span><span class="sxs-lookup"><span data-stu-id="f4421-178">If you have an advanced scenario and you want to implement your own collection, consider using the <xref:System.Collections.IList> interface.</span></span> <span data-ttu-id="f4421-179"><xref:System.Collections.IList> 提供非泛型集合之物件的可個別存取的索引，以改善效能。</span><span class="sxs-lookup"><span data-stu-id="f4421-179"><xref:System.Collections.IList> provides a non-generic collection of objects that can be individually accessed by index, which can improve performance.</span></span>  
  
<a name="permissions"></a>   
## <a name="permission-requirements-in-data-binding"></a><span data-ttu-id="f4421-180">資料繫結的使用權限需求</span><span class="sxs-lookup"><span data-stu-id="f4421-180">Permission Requirements in Data Binding</span></span>  
 <span data-ttu-id="f4421-181">進行資料繫結時，您必須考慮應用程式的信任層級。</span><span class="sxs-lookup"><span data-stu-id="f4421-181">When data binding, you must consider the trust level of the application.</span></span> <span data-ttu-id="f4421-182">下表摘要說明在以完全信任或部分信任執行的應用程式中，可以當做繫結目標的屬性型別：</span><span class="sxs-lookup"><span data-stu-id="f4421-182">The following table summarizes what property types can be bound to in an application that is executing in either full trust or partial trust:</span></span>  
  
|<span data-ttu-id="f4421-183">屬性類型</span><span class="sxs-lookup"><span data-stu-id="f4421-183">Property type</span></span><br /><br /> <span data-ttu-id="f4421-184">(所有存取修飾詞)</span><span class="sxs-lookup"><span data-stu-id="f4421-184">(all access modifiers)</span></span>|<span data-ttu-id="f4421-185">動態物件屬性</span><span class="sxs-lookup"><span data-stu-id="f4421-185">Dynamic object property</span></span>|<span data-ttu-id="f4421-186">動態物件屬性</span><span class="sxs-lookup"><span data-stu-id="f4421-186">Dynamic object property</span></span>|<span data-ttu-id="f4421-187">CLR 屬性</span><span class="sxs-lookup"><span data-stu-id="f4421-187">CLR property</span></span>|<span data-ttu-id="f4421-188">CLR 屬性</span><span class="sxs-lookup"><span data-stu-id="f4421-188">CLR property</span></span>|<span data-ttu-id="f4421-189">相依性屬性</span><span class="sxs-lookup"><span data-stu-id="f4421-189">Dependency property</span></span>|<span data-ttu-id="f4421-190">相依性屬性</span><span class="sxs-lookup"><span data-stu-id="f4421-190">Dependency property</span></span>|  
|------------------------------------------------|-----------------------------|-----------------------------|------------------|------------------|-------------------------|-------------------------|  
|<span data-ttu-id="f4421-191">**信任層級**</span><span class="sxs-lookup"><span data-stu-id="f4421-191">**Trust level**</span></span>|<span data-ttu-id="f4421-192">**完全信任**</span><span class="sxs-lookup"><span data-stu-id="f4421-192">**Full trust**</span></span>|<span data-ttu-id="f4421-193">**部分信任**</span><span class="sxs-lookup"><span data-stu-id="f4421-193">**Partial trust**</span></span>|<span data-ttu-id="f4421-194">**完全信任**</span><span class="sxs-lookup"><span data-stu-id="f4421-194">**Full trust**</span></span>|<span data-ttu-id="f4421-195">**部分信任**</span><span class="sxs-lookup"><span data-stu-id="f4421-195">**Partial trust**</span></span>|<span data-ttu-id="f4421-196">**完全信任**</span><span class="sxs-lookup"><span data-stu-id="f4421-196">**Full trust**</span></span>|<span data-ttu-id="f4421-197">**部分信任**</span><span class="sxs-lookup"><span data-stu-id="f4421-197">**Partial trust**</span></span>|  
|<span data-ttu-id="f4421-198">公用類別</span><span class="sxs-lookup"><span data-stu-id="f4421-198">Public class</span></span>|<span data-ttu-id="f4421-199">是</span><span class="sxs-lookup"><span data-stu-id="f4421-199">Yes</span></span>|<span data-ttu-id="f4421-200">是</span><span class="sxs-lookup"><span data-stu-id="f4421-200">Yes</span></span>|<span data-ttu-id="f4421-201">是</span><span class="sxs-lookup"><span data-stu-id="f4421-201">Yes</span></span>|<span data-ttu-id="f4421-202">是</span><span class="sxs-lookup"><span data-stu-id="f4421-202">Yes</span></span>|<span data-ttu-id="f4421-203">是</span><span class="sxs-lookup"><span data-stu-id="f4421-203">Yes</span></span>|<span data-ttu-id="f4421-204">是</span><span class="sxs-lookup"><span data-stu-id="f4421-204">Yes</span></span>|  
|<span data-ttu-id="f4421-205">非公用類別</span><span class="sxs-lookup"><span data-stu-id="f4421-205">Non-public class</span></span>|<span data-ttu-id="f4421-206">是</span><span class="sxs-lookup"><span data-stu-id="f4421-206">Yes</span></span>|<span data-ttu-id="f4421-207">否</span><span class="sxs-lookup"><span data-stu-id="f4421-207">No</span></span>|<span data-ttu-id="f4421-208">[是]</span><span class="sxs-lookup"><span data-stu-id="f4421-208">Yes</span></span>|<span data-ttu-id="f4421-209">否</span><span class="sxs-lookup"><span data-stu-id="f4421-209">No</span></span>|<span data-ttu-id="f4421-210">是</span><span class="sxs-lookup"><span data-stu-id="f4421-210">Yes</span></span>|<span data-ttu-id="f4421-211">是</span><span class="sxs-lookup"><span data-stu-id="f4421-211">Yes</span></span>|  
  
 <span data-ttu-id="f4421-212">這個表格說明資料繫結中使用權限需求的下列相關重點：</span><span class="sxs-lookup"><span data-stu-id="f4421-212">This table describes the following important points about permission requirements in data binding:</span></span>  
  
-   <span data-ttu-id="f4421-213">對於 [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] 屬性，只要繫結引擎能夠使用反映來存取繫結來源屬性，資料繫結就有作用。</span><span class="sxs-lookup"><span data-stu-id="f4421-213">For [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] properties, data binding works as long as the binding engine is able to access the binding source property using reflection.</span></span> <span data-ttu-id="f4421-214">否則，繫結引擎將會發出找不到屬性的警告，並使用後援值或預設值 (如果有的話)。</span><span class="sxs-lookup"><span data-stu-id="f4421-214">Otherwise, the binding engine issues a warning that the property cannot be found and uses the fallback value or the default value, if it is available.</span></span>  
  
-   <span data-ttu-id="f4421-215">您可以繫結至在編譯階段或執行階段定義之動態物件上的屬性。</span><span class="sxs-lookup"><span data-stu-id="f4421-215">You can bind to properties on dynamic objects that are defined at compile time or run time.</span></span>  
  
-   <span data-ttu-id="f4421-216">您永遠都可以繫結至相依性屬性。</span><span class="sxs-lookup"><span data-stu-id="f4421-216">You can always bind to dependency properties.</span></span>  
  
 <span data-ttu-id="f4421-217">[!INCLUDE[TLA2#tla_xml](../../../../includes/tla2sharptla-xml-md.md)] 繫結也有類似的使用權限需求。</span><span class="sxs-lookup"><span data-stu-id="f4421-217">The permission requirement for [!INCLUDE[TLA2#tla_xml](../../../../includes/tla2sharptla-xml-md.md)] binding is similar.</span></span> <span data-ttu-id="f4421-218">在部分信任沙箱，<xref:System.Windows.Data.XmlDataProvider>它並沒有指定的資料存取權限時失敗。</span><span class="sxs-lookup"><span data-stu-id="f4421-218">In a partial-trust sandbox, <xref:System.Windows.Data.XmlDataProvider> fails when it does not have permissions to access the specified data.</span></span>  
  
 <span data-ttu-id="f4421-219">具有匿名型別的物件為內部物件。</span><span class="sxs-lookup"><span data-stu-id="f4421-219">Objects with an anonymous type are internal.</span></span> <span data-ttu-id="f4421-220">只有在完全信任狀況下執行時，您才能繫結至匿名型別的屬性。</span><span class="sxs-lookup"><span data-stu-id="f4421-220">You can bind to properties of anonymous types only when running in full trust.</span></span> <span data-ttu-id="f4421-221">如需匿名型別的詳細資訊，請參閱[匿名型別 (C# 程式設計手冊)](~/docs/csharp/programming-guide/classes-and-structs/anonymous-types.md) 或[匿名型別 (Visual Basic)](~/docs/visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md) (Visual Basic)。</span><span class="sxs-lookup"><span data-stu-id="f4421-221">For more information about anonymous types, see [Anonymous Types (C# Programming Guide)](~/docs/csharp/programming-guide/classes-and-structs/anonymous-types.md) or [Anonymous Types (Visual Basic)](~/docs/visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md) (Visual Basic).</span></span>  
  
 <span data-ttu-id="f4421-222">如需部分信任安全性的詳細資訊，請參閱 [WPF 部分信任安全性](../wpf-partial-trust-security.md)。</span><span class="sxs-lookup"><span data-stu-id="f4421-222">For more information about partial-trust security, see [WPF Partial Trust Security](../wpf-partial-trust-security.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f4421-223">另請參閱</span><span class="sxs-lookup"><span data-stu-id="f4421-223">See also</span></span>
- <xref:System.Windows.Data.ObjectDataProvider>
- <xref:System.Windows.Data.XmlDataProvider>
- [<span data-ttu-id="f4421-224">指定繫結來源</span><span class="sxs-lookup"><span data-stu-id="f4421-224">Specify the Binding Source</span></span>](how-to-specify-the-binding-source.md)
- [<span data-ttu-id="f4421-225">資料繫結概觀</span><span class="sxs-lookup"><span data-stu-id="f4421-225">Data Binding Overview</span></span>](data-binding-overview.md)
- [<span data-ttu-id="f4421-226">HOW-TO 主題</span><span class="sxs-lookup"><span data-stu-id="f4421-226">How-to Topics</span></span>](data-binding-how-to-topics.md)
- [<span data-ttu-id="f4421-227">WPF 資料繫結與 LINQ to XML 概觀</span><span class="sxs-lookup"><span data-stu-id="f4421-227">WPF Data Binding with LINQ to XML Overview</span></span>](/visualstudio/designers/wpf-data-binding-with-linq-to-xml-overview)
- [<span data-ttu-id="f4421-228">資料繫結</span><span class="sxs-lookup"><span data-stu-id="f4421-228">Data Binding</span></span>](../advanced/optimizing-performance-data-binding.md)
